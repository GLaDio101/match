/*! Built with IMPACT - impactjs.com */

(function(window){"use strict";Number.prototype.map=function(istart,istop,ostart,ostop){return ostart+(ostop-ostart)*((this-istart)/(istop-istart));};Number.prototype.limit=function(min,max){return Math.min(max,Math.max(min,this));};Number.prototype.round=function(precision){precision=Math.pow(10,precision||0);return Math.round(this*precision)/precision;};Number.prototype.floor=function(){return Math.floor(this);};Number.prototype.ceil=function(){return Math.ceil(this);};Number.prototype.toInt=function(){return(this|0);};Number.prototype.toRad=function(){return(this/180)*Math.PI;};Number.prototype.toDeg=function(){return(this*180)/Math.PI;};Object.defineProperty(Array.prototype,'erase',{value:function(item){for(var i=this.length;i--;){if(this[i]===item){this.splice(i,1);}}
return this;}});Object.defineProperty(Array.prototype,'random',{value:function(item){return this[Math.floor(Math.random()*this.length)];}});Function.prototype.bind=Function.prototype.bind||function(oThis){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}
var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply((this instanceof fNOP&&oThis?this:oThis),aArgs.concat(Array.prototype.slice.call(arguments)));};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound;};window.ig={game:null,debug:null,version:'1.24',global:window,modules:{},resources:[],ready:false,baked:false,nocache:'',ua:{},prefix:(window.ImpactPrefix||''),lib:'lib/',_current:null,_loadQueue:[],_waitForOnload:0,$:function(selector){return selector.charAt(0)=='#'?document.getElementById(selector.substr(1)):document.getElementsByTagName(selector);},$new:function(name){return document.createElement(name);},copy:function(object){if(!object||typeof(object)!='object'||object instanceof HTMLElement||object instanceof ig.Class){return object;}
else if(object instanceof Array){var c=[];for(var i=0,l=object.length;i<l;i++){c[i]=ig.copy(object[i]);}
return c;}
else{var c={};for(var i in object){c[i]=ig.copy(object[i]);}
return c;}},merge:function(original,extended){for(var key in extended){var ext=extended[key];if(typeof(ext)!='object'||ext instanceof HTMLElement||ext instanceof ig.Class||ext===null){original[key]=ext;}
else{if(!original[key]||typeof(original[key])!='object'){original[key]=(ext instanceof Array)?[]:{};}
ig.merge(original[key],ext);}}
return original;},ksort:function(obj){if(!obj||typeof(obj)!='object'){return[];}
var keys=[],values=[];for(var i in obj){keys.push(i);}
keys.sort();for(var i=0;i<keys.length;i++){values.push(obj[keys[i]]);}
return values;},setVendorAttribute:function(el,attr,val){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);el[attr]=el['ms'+uc]=el['moz'+uc]=el['webkit'+uc]=el['o'+uc]=val;},getVendorAttribute:function(el,attr){var uc=attr.charAt(0).toUpperCase()+attr.substr(1);return el[attr]||el['ms'+uc]||el['moz'+uc]||el['webkit'+uc]||el['o'+uc];},normalizeVendorAttribute:function(el,attr){var prefixedVal=ig.getVendorAttribute(el,attr);if(!el[attr]&&prefixedVal){el[attr]=prefixedVal;}},getImagePixels:function(image,x,y,width,height){var canvas=ig.$new('canvas');canvas.width=image.width;canvas.height=image.height;var ctx=canvas.getContext('2d');ig.System.SCALE.CRISP(canvas,ctx);var ratio=ig.getVendorAttribute(ctx,'backingStorePixelRatio')||1;ig.normalizeVendorAttribute(ctx,'getImageDataHD');var realWidth=image.width/ratio,realHeight=image.height/ratio;canvas.width=Math.ceil(realWidth);canvas.height=Math.ceil(realHeight);ctx.drawImage(image,0,0,realWidth,realHeight);return(ratio===1)?ctx.getImageData(x,y,width,height):ctx.getImageDataHD(x,y,width,height);},module:function(name){if(ig._current){throw("Module '"+ig._current.name+"' defines nothing");}
if(ig.modules[name]&&ig.modules[name].body){throw("Module '"+name+"' is already defined");}
ig._current={name:name,requires:[],loaded:false,body:null};ig.modules[name]=ig._current;ig._loadQueue.push(ig._current);return ig;},requires:function(){ig._current.requires=Array.prototype.slice.call(arguments);return ig;},defines:function(body){ig._current.body=body;ig._current=null;ig._initDOMReady();},addResource:function(resource){ig.resources.push(resource);},setNocache:function(set){ig.nocache='?'+set;},log:function(){},assert:function(condition,msg){},show:function(name,number){},mark:function(msg,color){},_loadScript:function(name,requiredFrom){ig.modules[name]={name:name,requires:[],loaded:false,body:null};ig._waitForOnload++;var path=ig.prefix+ig.lib+name.replace(/\./g,'/')+'.js'+ig.nocache;var script=ig.$new('script');script.type='text/javascript';script.src=path;script.onload=function(){ig._waitForOnload--;ig._execModules();};script.onerror=function(){throw('Failed to load module '+name+' at '+path+' '+'required from '+requiredFrom);};ig.$('head')[0].appendChild(script);},_execModules:function(){var modulesLoaded=false;for(var i=0;i<ig._loadQueue.length;i++){var m=ig._loadQueue[i];var dependenciesLoaded=true;for(var j=0;j<m.requires.length;j++){var name=m.requires[j];if(!ig.modules[name]){dependenciesLoaded=false;ig._loadScript(name,m.name);}
else if(!ig.modules[name].loaded){dependenciesLoaded=false;}}
if(dependenciesLoaded&&m.body){ig._loadQueue.splice(i,1);m.loaded=true;m.body();modulesLoaded=true;i--;}}
if(modulesLoaded){ig._execModules();}
else if(!ig.baked&&ig._waitForOnload==0&&ig._loadQueue.length!=0){var unresolved=[];for(var i=0;i<ig._loadQueue.length;i++){var unloaded=[];var requires=ig._loadQueue[i].requires;for(var j=0;j<requires.length;j++){var m=ig.modules[requires[j]];if(!m||!m.loaded){unloaded.push(requires[j]);}}
unresolved.push(ig._loadQueue[i].name+' (requires: '+unloaded.join(', ')+')');}
throw("Unresolved (or circular?) dependencies. "+"Most likely there's a name/path mismatch for one of the listed modules "+"or a previous syntax error prevents a module from loading:\n"+
unresolved.join('\n'));}},_DOMReady:function(){if(!ig.modules['dom.ready'].loaded){if(!document.body){return setTimeout(ig._DOMReady,13);}
ig.modules['dom.ready'].loaded=true;ig._waitForOnload--;ig._execModules();}
return 0;},_boot:function(){ig.setNocache(utilNoCacheValue);ig.ua.pixelRatio=window.devicePixelRatio||1;ig.ua.viewport={width:window.innerWidth,height:window.innerHeight};ig.ua.screen={width:window.screen.availWidth*ig.ua.pixelRatio,height:window.screen.availHeight*ig.ua.pixelRatio};ig.ua.iPhone=/iPhone|iPod/i.test(navigator.userAgent);ig.ua.iPhone4=(ig.ua.iPhone&&ig.ua.pixelRatio==2);ig.ua.iPad=/iPad/i.test(navigator.userAgent);ig.ua.android=/android/i.test(navigator.userAgent);ig.ua.winPhone=/Windows Phone/i.test(navigator.userAgent);ig.ua.iOS=ig.ua.iPhone||ig.ua.iPad;ig.ua.mobile=ig.ua.iOS||ig.ua.android||ig.ua.winPhone||/mobile/i.test(navigator.userAgent);ig.ua.touchDevice=(('ontouchstart'in window)||(window.navigator.msMaxTouchPoints));},_initDOMReady:function(){if(ig.modules['dom.ready']){ig._execModules();return;}
ig._boot();ig.modules['dom.ready']={requires:[],loaded:false,body:null};ig._waitForOnload++;if(document.readyState==='complete'){ig._DOMReady();}
else{document.addEventListener('DOMContentLoaded',ig._DOMReady,false);window.addEventListener('load',ig._DOMReady,false);}}};ig.normalizeVendorAttribute(window,'requestAnimationFrame');if(window.requestAnimationFrame){var next=1,anims={};window.ig.setAnimation=function(callback,element){var current=next++;anims[current]=true;var animate=function(){if(!anims[current]){return;}
window.requestAnimationFrame(animate,element);callback();};window.requestAnimationFrame(animate,element);return current;};window.ig.clearAnimation=function(id){delete anims[id];};}
else{window.ig.setAnimation=function(callback,element){return window.setInterval(callback,1000/60);};window.ig.clearAnimation=function(id){window.clearInterval(id);};}
var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\bparent\b/:/.*/;var lastClassId=0;window.ig.Class=function(){};var inject=function(prop){var proto=this.prototype;var parent={};for(var name in prop){if(typeof(prop[name])=="function"&&typeof(proto[name])=="function"&&fnTest.test(prop[name])){parent[name]=proto[name];proto[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{proto[name]=prop[name];}}};window.ig.Class.extend=function(prop){var parent=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){if(typeof(prop[name])=="function"&&typeof(parent[name])=="function"&&fnTest.test(prop[name])){prototype[name]=(function(name,fn){return function(){var tmp=this.parent;this.parent=parent[name];var ret=fn.apply(this,arguments);this.parent=tmp;return ret;};})(name,prop[name]);}
else{prototype[name]=prop[name];}}
function Class(){if(!initializing){if(this.staticInstantiate){var obj=this.staticInstantiate.apply(this,arguments);if(obj){return obj;}}
for(var p in this){if(typeof(this[p])=='object'){this[p]=ig.copy(this[p]);}}
if(this.init){this.init.apply(this,arguments);}}
return this;}
Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=window.ig.Class.extend;Class.inject=inject;Class.classId=prototype.classId=++lastClassId;return Class;};if(window.ImpactMixin){ig.merge(ig,window.ImpactMixin);}})(window);

// lib/impact/image.js
ig.baked=true;ig.module('impact.image').defines(function(){"use strict";ig.Image=ig.Class.extend({data:null,width:0,height:0,loaded:false,failed:false,loadCallback:null,path:'',staticInstantiate:function(path){return ig.Image.cache[path]||null;},init:function(path){this.path=path;this.load();},load:function(loadCallback){if(this.loaded){if(loadCallback){loadCallback(this.path,true);}
return;}
else if(!this.loaded&&ig.ready){this.loadCallback=loadCallback||null;this.data=new Image();this.data.onload=this.onload.bind(this);this.data.onerror=this.onerror.bind(this);this.data.src=ig.prefix+this.path+ig.nocache;}
else{ig.addResource(this);}
ig.Image.cache[this.path]=this;},reload:function(){this.loaded=false;this.data=new Image();this.data.onload=this.onload.bind(this);this.data.src=this.path+'?'+Date.now();},onload:function(event){this.width=this.data.width;this.height=this.data.height;this.loaded=true;if(ig.system.scale!=1){this.resize(ig.system.scale);}
if(this.loadCallback){this.loadCallback(this.path,true);}},onerror:function(event){this.failed=true;if(this.loadCallback){this.loadCallback(this.path,false);}},resize:function(scale){var origPixels=ig.getImagePixels(this.data,0,0,this.width,this.height);var widthScaled=this.width*scale;var heightScaled=this.height*scale;var scaled=ig.$new('canvas');scaled.width=widthScaled;scaled.height=heightScaled;var scaledCtx=scaled.getContext('2d');var scaledPixels=scaledCtx.getImageData(0,0,widthScaled,heightScaled);for(var y=0;y<heightScaled;y++){for(var x=0;x<widthScaled;x++){var index=(Math.floor(y/scale)*this.width+Math.floor(x/scale))*4;var indexScaled=(y*widthScaled+x)*4;scaledPixels.data[indexScaled]=origPixels.data[index];scaledPixels.data[indexScaled+1]=origPixels.data[index+1];scaledPixels.data[indexScaled+2]=origPixels.data[index+2];scaledPixels.data[indexScaled+3]=origPixels.data[index+3];}}
scaledCtx.putImageData(scaledPixels,0,0);this.data=new Image();this.data.src=scaled.toDataURL();},draw:function(targetX,targetY,sourceX,sourceY,width,height){if(!this.loaded){return;}
var scale=ig.system.scale;sourceX=sourceX?sourceX*scale:0;sourceY=sourceY?sourceY*scale:0;width=(width?width:this.width)*scale;height=(height?height:this.height)*scale;ig.system.context.drawImage(this.data,sourceX,sourceY,width,height,ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY),width,height);ig.Image.drawCount++;},drawTile:function(targetX,targetY,tile,tileWidth,tileHeight,flipX,flipY){tileHeight=tileHeight?tileHeight:tileWidth;if(!this.loaded||tileWidth>this.width||tileHeight>this.height){return;}
var scale=ig.system.scale;var tileWidthScaled=Math.floor(tileWidth*scale);var tileHeightScaled=Math.floor(tileHeight*scale);var scaleX=flipX?-1:1;var scaleY=flipY?-1:1;if(flipX||flipY){ig.system.context.save();ig.system.context.scale(scaleX,scaleY);}
ig.system.context.drawImage(this.data,(Math.floor(tile*tileWidth)%this.width)*scale,(Math.floor(tile*tileWidth/this.width)*tileHeight)*scale,tileWidthScaled,tileHeightScaled,ig.system.getDrawPos(targetX)*scaleX-(flipX?tileWidthScaled:0),ig.system.getDrawPos(targetY)*scaleY-(flipY?tileHeightScaled:0),tileWidthScaled,tileHeightScaled);if(flipX||flipY){ig.system.context.restore();}
ig.Image.drawCount++;}});ig.Image.drawCount=0;ig.Image.cache={};ig.Image.reloadCache=function(){for(var path in ig.Image.cache){ig.Image.cache[path].reload();}};});

// lib/impact/font.js
ig.baked=true;ig.module('impact.font').requires('impact.image').defines(function(){"use strict";ig.Font=ig.Image.extend({widthMap:[],indices:[],firstChar:32,alpha:1,letterSpacing:1,lineSpacing:0,onload:function(ev){this._loadMetrics(this.data);this.parent(ev);},widthForString:function(text){if(text.indexOf('\n')!==-1){var lines=text.split('\n');var width=0;for(var i=0;i<lines.length;i++){width=Math.max(width,this._widthForLine(lines[i]));}
return width;}
else{return this._widthForLine(text);}},_widthForLine:function(text){var width=0;for(var i=0;i<text.length;i++){width+=this.widthMap[text.charCodeAt(i)-this.firstChar]+this.letterSpacing;}
return width;},heightForString:function(text){return text.split('\n').length*(this.height+this.lineSpacing);},draw:function(text,x,y,align){if(typeof(text)!='string'){text=text.toString();}
if(text.indexOf('\n')!==-1){var lines=text.split('\n');var lineHeight=this.height+this.lineSpacing;for(var i=0;i<lines.length;i++){this.draw(lines[i],x,y+i*lineHeight,align);}
return;}
if(align==ig.Font.ALIGN.RIGHT||align==ig.Font.ALIGN.CENTER){var width=this._widthForLine(text);x-=align==ig.Font.ALIGN.CENTER?width/2:width;}
if(this.alpha!==1){ig.system.context.globalAlpha=this.alpha;}
for(var i=0;i<text.length;i++){var c=text.charCodeAt(i);x+=this._drawChar(c-this.firstChar,x,y);}
if(this.alpha!==1){ig.system.context.globalAlpha=1;}
ig.Image.drawCount+=text.length;},_drawChar:function(c,targetX,targetY){if(!this.loaded||c<0||c>=this.indices.length){return 0;}
var scale=ig.system.scale;var charX=this.indices[c]*scale;var charY=0;var charWidth=this.widthMap[c]*scale;var charHeight=(this.height-2)*scale;ig.system.context.drawImage(this.data,charX,charY,charWidth,charHeight,ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY),charWidth,charHeight);return this.widthMap[c]+this.letterSpacing;},_loadMetrics:function(image){this.height=image.height-1;this.widthMap=[];this.indices=[];var px=ig.getImagePixels(image,0,image.height-1,image.width,1);var currentChar=0;var currentWidth=0;for(var x=0;x<image.width;x++){var index=x*4+3;if(px.data[index]>127){currentWidth++;}
else if(px.data[index]<128&&currentWidth){this.widthMap.push(currentWidth);this.indices.push(x-currentWidth);currentChar++;currentWidth=0;}}
this.widthMap.push(currentWidth);this.indices.push(x-currentWidth);}});ig.Font.ALIGN={LEFT:0,RIGHT:1,CENTER:2};});

// lib/impact/sound.js
ig.baked=true;ig.module('impact.sound').defines(function(){"use strict";ig.SoundManager=ig.Class.extend({clips:{},volume:1,format:null,init:function(){if(!ig.Sound.enabled||!window.Audio){ig.Sound.enabled=false;return;}
var probe=new Audio();for(var i=0;i<ig.Sound.use.length;i++){var format=ig.Sound.use[i];if(probe.canPlayType(format.mime)){this.format=format;break;}}
if(!this.format){ig.Sound.enabled=false;}
if(ig.Sound.enabled&&ig.Sound.useWebAudio){this.audioContext=new AudioContext();this.boundWebAudioUnlock=this.unlockWebAudio.bind(this);document.addEventListener('touchstart',this.boundWebAudioUnlock,false);}},unlockWebAudio:function(){document.removeEventListener('touchstart',this.boundWebAudioUnlock,false);var buffer=this.audioContext.createBuffer(1,1,22050);var source=this.audioContext.createBufferSource();source.buffer=buffer;source.connect(this.audioContext.destination);source.start(0);},load:function(path,multiChannel,loadCallback){if(multiChannel&&ig.Sound.useWebAudio){return this.loadWebAudio(path,multiChannel,loadCallback);}
else{return this.loadHTML5Audio(path,multiChannel,loadCallback);}},loadWebAudio:function(path,multiChannel,loadCallback){var realPath=ig.prefix+path.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[path]){return this.clips[path];}
var audioSource=new ig.Sound.WebAudioSource()
this.clips[path]=audioSource;var request=new XMLHttpRequest();request.open('GET',realPath,true);request.responseType='arraybuffer';var that=this;request.onload=function(ev){that.audioContext.decodeAudioData(request.response,function(buffer){audioSource.buffer=buffer;if(loadCallback){loadCallback(path,true,ev);}},function(ev){if(loadCallback){loadCallback(path,false,ev);}});};request.onerror=function(ev){if(loadCallback){loadCallback(path,false,ev);}};request.send();return audioSource;},loadHTML5Audio:function(path,multiChannel,loadCallback){var realPath=ig.prefix+path.replace(/[^\.]+$/,this.format.ext)+ig.nocache;if(this.clips[path]){if(this.clips[path]instanceof ig.Sound.WebAudioSource){return this.clips[path];}
if(multiChannel&&this.clips[path].length<ig.Sound.channels){for(var i=this.clips[path].length;i<ig.Sound.channels;i++){var a=new Audio(realPath);a.load();this.clips[path].push(a);}}
return this.clips[path][0];}
var clip=new Audio(realPath);if(loadCallback){if(ig.ua.mobile){setTimeout(function(){loadCallback(path,true,null);},0);}
else{clip.addEventListener('canplaythrough',function cb(ev){clip.removeEventListener('canplaythrough',cb,false);loadCallback(path,true,ev);},false);clip.addEventListener('error',function(ev){loadCallback(path,false,ev);},false);}}
clip.preload='auto';clip.load();this.clips[path]=[clip];if(multiChannel){for(var i=1;i<ig.Sound.channels;i++){var a=new Audio(realPath);a.load();this.clips[path].push(a);}}
return clip;},get:function(path){var channels=this.clips[path];if(channels&&channels instanceof ig.Sound.WebAudioSource){return channels;}
for(var i=0,clip;clip=channels[i++];){if(clip.paused||clip.ended){if(clip.ended){clip.currentTime=0;}
return clip;}}
channels[0].pause();channels[0].currentTime=0;return channels[0];}});ig.Music=ig.Class.extend({tracks:[],namedTracks:{},currentTrack:null,currentIndex:0,random:false,_volume:1,_loop:false,_fadeInterval:0,_fadeTimer:null,_endedCallbackBound:null,init:function(){this._endedCallbackBound=this._endedCallback.bind(this);Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)});Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});},add:function(music,name){if(!ig.Sound.enabled){return;}
var path=music instanceof ig.Sound?music.path:music;var track=ig.soundManager.load(path,false);if(track instanceof ig.Sound.WebAudioSource){ig.system.stopRunLoop();throw("Sound '"+path+"' loaded as Multichannel but used for Music. "+"Set the multiChannel param to false when loading, e.g.: new ig.Sound(path, false)");}
track.loop=this._loop;track.volume=this._volume;track.addEventListener('ended',this._endedCallbackBound,false);this.tracks.push(track);if(name){this.namedTracks[name]=track;}
if(!this.currentTrack){this.currentTrack=track;}},next:function(){if(!this.tracks.length){return;}
this.stop();this.currentIndex=this.random?Math.floor(Math.random()*this.tracks.length):(this.currentIndex+1)%this.tracks.length;this.currentTrack=this.tracks[this.currentIndex];this.play();},pause:function(){if(!this.currentTrack){return;}
this.currentTrack.pause();},stop:function(){if(!this.currentTrack){return;}
this.currentTrack.pause();this.currentTrack.currentTime=0;},play:function(name){if(name&&this.namedTracks[name]){var newTrack=this.namedTracks[name];if(newTrack!=this.currentTrack){this.stop();this.currentTrack=newTrack;}}
else if(!this.currentTrack){return;}
this.currentTrack.play();},getLooping:function(){return this._loop;},setLooping:function(l){this._loop=l;for(var i in this.tracks){this.tracks[i].loop=l;}},getVolume:function(){return this._volume;},setVolume:function(v){this._volume=v.limit(0,1);for(var i in this.tracks){this.tracks[i].volume=this._volume;}},fadeOut:function(time){if(!this.currentTrack){return;}
clearInterval(this._fadeInterval);this.fadeTimer=new ig.Timer(time);this._fadeInterval=setInterval(this._fadeStep.bind(this),50);},_fadeStep:function(){var v=this.fadeTimer.delta().map(-this.fadeTimer.target,0,1,0).limit(0,1)*this._volume;if(v<=0.01){this.stop();this.currentTrack.volume=this._volume;clearInterval(this._fadeInterval);}
else{this.currentTrack.volume=v;}},_endedCallback:function(){if(this._loop){this.play();}
else{this.next();}}});ig.Sound=ig.Class.extend({path:'',volume:1,currentClip:null,multiChannel:true,_loop:false,init:function(path,multiChannel){this.path=path;this.multiChannel=(multiChannel!==false);Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});this.load();},getLooping:function(){return this._loop;},setLooping:function(loop){this._loop=loop;if(this.currentClip){this.currentClip.loop=loop;}},load:function(loadCallback){if(!ig.Sound.enabled){if(loadCallback){loadCallback(this.path,true);}
return;}
if(ig.ready){ig.soundManager.load(this.path,this.multiChannel,loadCallback);}
else{ig.addResource(this);}},play:function(){if(!ig.Sound.enabled){return;}
this.currentClip=ig.soundManager.get(this.path);this.currentClip.loop=this._loop;this.currentClip.volume=ig.soundManager.volume*this.volume;this.currentClip.play();},stop:function(){if(this.currentClip){this.currentClip.pause();this.currentClip.currentTime=0;}}});ig.Sound.WebAudioSource=ig.Class.extend({sources:[],gain:null,buffer:null,_loop:false,init:function(){this.gain=ig.soundManager.audioContext.createGain();this.gain.connect(ig.soundManager.audioContext.destination);Object.defineProperty(this,"loop",{get:this.getLooping.bind(this),set:this.setLooping.bind(this)});Object.defineProperty(this,"volume",{get:this.getVolume.bind(this),set:this.setVolume.bind(this)});},play:function(){if(!this.buffer){return;}
var source=ig.soundManager.audioContext.createBufferSource();source.buffer=this.buffer;source.connect(this.gain);source.loop=this._loop;var that=this;this.sources.push(source);source.onended=function(){that.sources.erase(source);}
source.start(0);},pause:function(){for(var i=0;i<this.sources.length;i++){try{this.sources[i].stop();}catch(err){}}},getLooping:function(){return this._loop;},setLooping:function(loop){this._loop=loop;for(var i=0;i<this.sources.length;i++){this.sources[i].loop=loop;}},getVolume:function(){return this.gain.gain.value;},setVolume:function(volume){this.gain.gain.value=volume;}});ig.Sound.FORMAT={MP3:{ext:'mp3',mime:'audio/mpeg'},M4A:{ext:'m4a',mime:'audio/mp4; codecs=mp4a'},OGG:{ext:'ogg',mime:'audio/ogg; codecs=vorbis'},WEBM:{ext:'webm',mime:'audio/webm; codecs=vorbis'},CAF:{ext:'caf',mime:'audio/x-caf'}};ig.Sound.use=[ig.Sound.FORMAT.OGG,ig.Sound.FORMAT.MP3];ig.Sound.channels=4;ig.Sound.enabled=true;ig.normalizeVendorAttribute(window,'AudioContext');ig.Sound.useWebAudio=!!window.AudioContext&&!window.nwf;});

// lib/impact/loader.js
ig.baked=true;ig.module('impact.loader').requires('impact.image','impact.font','impact.sound').defines(function(){"use strict";ig.Loader=ig.Class.extend({resources:[],gameClass:null,status:0,done:false,_unloaded:[],_drawStatus:0,_intervalId:0,_loadCallbackBound:null,init:function(gameClass,resources){this.gameClass=gameClass;this.resources=resources;this._loadCallbackBound=this._loadCallback.bind(this);for(var i=0;i<this.resources.length;i++){this._unloaded.push(this.resources[i].path);}},load:function(){ig.system.clear('#000');if(!this.resources.length){this.end();return;}
for(var i=0;i<this.resources.length;i++){this.loadResource(this.resources[i]);}
this._intervalId=setInterval(this.draw.bind(this),16);},loadResource:function(res){res.load(this._loadCallbackBound);},end:function(){if(this.done){return;}
this.done=true;clearInterval(this._intervalId);ig.system.setGame(this.gameClass);},draw:function(){this._drawStatus+=(this.status-this._drawStatus)/5;var s=ig.system.scale;var w=ig.system.width*0.6;var h=ig.system.height*0.1;var x=ig.system.width*0.5-w/2;var y=ig.system.height*0.5-h/2;ig.system.context.fillStyle='#000';ig.system.context.fillRect(0,0,480,320);ig.system.context.fillStyle='#fff';ig.system.context.fillRect(x*s,y*s,w*s,h*s);ig.system.context.fillStyle='#000';ig.system.context.fillRect(x*s+s,y*s+s,w*s-s-s,h*s-s-s);ig.system.context.fillStyle='#fff';ig.system.context.fillRect(x*s,y*s,w*s*this._drawStatus,h*s);},_loadCallback:function(path,status){if(status){this._unloaded.erase(path);}
else{throw('Failed to load resource: '+path);}
this.status=1-(this._unloaded.length/this.resources.length);if(this._unloaded.length==0){setTimeout(this.end.bind(this),250);}}});});

// lib/impact/timer.js
ig.baked=true;ig.module('impact.timer').defines(function(){"use strict";ig.Timer=ig.Class.extend({target:0,base:0,last:0,pausedAt:0,init:function(seconds){this.base=ig.Timer.time;this.last=ig.Timer.time;this.target=seconds||0;},set:function(seconds){this.target=seconds||0;this.base=ig.Timer.time;this.pausedAt=0;},reset:function(){this.base=ig.Timer.time;this.pausedAt=0;},tick:function(){var delta=ig.Timer.time-this.last;this.last=ig.Timer.time;return(this.pausedAt?0:delta);},delta:function(){return(this.pausedAt||ig.Timer.time)-this.base-this.target;},pause:function(){if(!this.pausedAt){this.pausedAt=ig.Timer.time;}},unpause:function(){if(this.pausedAt){this.base+=ig.Timer.time-this.pausedAt;this.pausedAt=0;}}});ig.Timer._last=0;ig.Timer.time=Number.MIN_VALUE;ig.Timer.timeScale=1;ig.Timer.maxStep=0.05;ig.Timer.step=function(){var current=Date.now();var delta=(current-ig.Timer._last)/1000;ig.Timer.time+=Math.min(delta,ig.Timer.maxStep)*ig.Timer.timeScale;ig.Timer._last=current;};});

// lib/impact/system.js
ig.baked=true;ig.module('impact.system').requires('impact.timer','impact.image').defines(function(){"use strict";ig.System=ig.Class.extend({fps:30,width:320,height:240,realWidth:320,realHeight:240,scale:1,tick:0,animationId:0,newGameClass:null,running:false,delegate:null,clock:null,canvas:null,context:null,init:function(canvasId,fps,width,height,scale){this.fps=fps;this.clock=new ig.Timer();this.canvas=ig.$(canvasId);this.resize(width,height,scale);this.context=this.canvas.getContext('2d');this.getDrawPos=ig.System.drawMode;if(this.scale!=1){ig.System.scaleMode=ig.System.SCALE.CRISP;}
ig.System.scaleMode(this.canvas,this.context);},resize:function(width,height,scale){this.width=width;this.height=height;this.scale=scale||this.scale;this.realWidth=this.width*this.scale;this.realHeight=this.height*this.scale;this.canvas.width=this.realWidth;this.canvas.height=this.realHeight;},setGame:function(gameClass){if(this.running){this.newGameClass=gameClass;}
else{this.setGameNow(gameClass);}},setGameNow:function(gameClass){ig.game=new(gameClass)();ig.system.setDelegate(ig.game);},setDelegate:function(object){if(typeof(object.run)=='function'){this.delegate=object;this.startRunLoop();}else{throw('System.setDelegate: No run() function in object');}},stopRunLoop:function(){ig.clearAnimation(this.animationId);this.running=false;},startRunLoop:function(){this.stopRunLoop();this.animationId=ig.setAnimation(this.run.bind(this),this.canvas);this.running=true;},clear:function(color){this.context.fillStyle=color;this.context.fillRect(0,0,this.realWidth,this.realHeight);},run:function(){ig.Timer.step();this.tick=this.clock.tick();this.delegate.run();ig.input.clearPressed();if(this.newGameClass){this.setGameNow(this.newGameClass);this.newGameClass=null;}},getDrawPos:null});ig.System.DRAW={AUTHENTIC:function(p){return Math.round(p)*this.scale;},SMOOTH:function(p){return Math.round(p*this.scale);},SUBPIXEL:function(p){return p*this.scale;}};ig.System.drawMode=ig.System.DRAW.SMOOTH;ig.System.SCALE={CRISP:function(canvas,context){ig.setVendorAttribute(context,'imageSmoothingEnabled',false);canvas.style.imageRendering='-moz-crisp-edges';canvas.style.imageRendering='-o-crisp-edges';canvas.style.imageRendering='-webkit-optimize-contrast';canvas.style.imageRendering='crisp-edges';canvas.style.msInterpolationMode='nearest-neighbor';},SMOOTH:function(canvas,context){ig.setVendorAttribute(context,'imageSmoothingEnabled',true);canvas.style.imageRendering='';canvas.style.msInterpolationMode='';}};ig.System.scaleMode=ig.System.SCALE.SMOOTH;});

// lib/impact/input.js
ig.baked=true;ig.module('impact.input').defines(function(){"use strict";ig.KEY={'MOUSE1':-1,'MOUSE2':-3,'MWHEEL_UP':-4,'MWHEEL_DOWN':-5,'BACKSPACE':8,'TAB':9,'ENTER':13,'PAUSE':19,'CAPS':20,'ESC':27,'SPACE':32,'PAGE_UP':33,'PAGE_DOWN':34,'END':35,'HOME':36,'LEFT_ARROW':37,'UP_ARROW':38,'RIGHT_ARROW':39,'DOWN_ARROW':40,'INSERT':45,'DELETE':46,'_0':48,'_1':49,'_2':50,'_3':51,'_4':52,'_5':53,'_6':54,'_7':55,'_8':56,'_9':57,'A':65,'B':66,'C':67,'D':68,'E':69,'F':70,'G':71,'H':72,'I':73,'J':74,'K':75,'L':76,'M':77,'N':78,'O':79,'P':80,'Q':81,'R':82,'S':83,'T':84,'U':85,'V':86,'W':87,'X':88,'Y':89,'Z':90,'NUMPAD_0':96,'NUMPAD_1':97,'NUMPAD_2':98,'NUMPAD_3':99,'NUMPAD_4':100,'NUMPAD_5':101,'NUMPAD_6':102,'NUMPAD_7':103,'NUMPAD_8':104,'NUMPAD_9':105,'MULTIPLY':106,'ADD':107,'SUBSTRACT':109,'DECIMAL':110,'DIVIDE':111,'F1':112,'F2':113,'F3':114,'F4':115,'F5':116,'F6':117,'F7':118,'F8':119,'F9':120,'F10':121,'F11':122,'F12':123,'SHIFT':16,'CTRL':17,'ALT':18,'PLUS':187,'COMMA':188,'MINUS':189,'PERIOD':190};ig.Input=ig.Class.extend({bindings:{},actions:{},presses:{},locks:{},delayedKeyup:{},isUsingMouse:false,isUsingKeyboard:false,isUsingAccelerometer:false,mouse:{x:0,y:0},accel:{x:0,y:0,z:0},initMouse:function(){if(this.isUsingMouse){return;}
this.isUsingMouse=true;var mouseWheelBound=this.mousewheel.bind(this);ig.system.canvas.addEventListener('mousewheel',mouseWheelBound,false);ig.system.canvas.addEventListener('DOMMouseScroll',mouseWheelBound,false);ig.system.canvas.addEventListener('contextmenu',this.contextmenu.bind(this),false);ig.system.canvas.addEventListener('mousedown',this.keydown.bind(this),false);ig.system.canvas.addEventListener('mouseup',this.keyup.bind(this),false);ig.system.canvas.addEventListener('mousemove',this.mousemove.bind(this),false);if(ig.ua.touchDevice){ig.system.canvas.addEventListener('touchstart',this.keydown.bind(this),false);ig.system.canvas.addEventListener('touchend',this.keyup.bind(this),false);ig.system.canvas.addEventListener('touchcancel',this.keyup.bind(this),false);ig.system.canvas.addEventListener('touchmove',this.mousemove.bind(this),false);ig.system.canvas.addEventListener('MSPointerDown',this.keydown.bind(this),false);ig.system.canvas.addEventListener('MSPointerUp',this.keyup.bind(this),false);ig.system.canvas.addEventListener('MSPointerMove',this.mousemove.bind(this),false);ig.system.canvas.style.msTouchAction='none';}},initKeyboard:function(){if(this.isUsingKeyboard){return;}
this.isUsingKeyboard=true;window.addEventListener('keydown',this.keydown.bind(this),false);window.addEventListener('keyup',this.keyup.bind(this),false);},initAccelerometer:function(){if(this.isUsingAccelerometer){return;}
this.isUsingAccelerometer=true;window.addEventListener('devicemotion',this.devicemotion.bind(this),false);},mousewheel:function(event){if($("#canvas").length==0){return;}
var delta=event.wheelDelta?event.wheelDelta:(event.detail*-1);var code=delta>0?ig.KEY.MWHEEL_UP:ig.KEY.MWHEEL_DOWN;var action=this.bindings[code];if(action){this.actions[action]=true;this.presses[action]=true;this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();}},mousemove:function(event){if($("#canvas").length==0){return;}
var internalWidth=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;var scale=ig.system.scale*(internalWidth/ig.system.realWidth);var pos={left:0,top:0};if(ig.system.canvas.getBoundingClientRect){pos=ig.system.canvas.getBoundingClientRect();}
var ev=event.touches?event.touches[0]:event;this.mouse.x=(ev.clientX-pos.left)/scale;this.mouse.y=(ev.clientY-pos.top)/scale;},contextmenu:function(event){if($("#canvas").length==0){return;}
if(this.bindings[ig.KEY.MOUSE2]){event.stopPropagation();event.preventDefault();}},keydown:function(event){if($("#canvas").length==0){return;}
var tag=event.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=event.type=='keydown'?event.keyCode:(event.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);if(code<0&&!ig.ua.mobile){window.focus();}
if(event.type=='touchstart'||event.type=='mousedown'){this.mousemove(event);}
var action=this.bindings[code];if(action){this.actions[action]=true;if(!this.locks[action]){this.presses[action]=true;this.locks[action]=true;}
event.preventDefault();}},keyup:function(event){if($("#canvas").length==0){return;}
var tag=event.target.tagName;if(tag=='INPUT'||tag=='TEXTAREA'){return;}
var code=event.type=='keyup'?event.keyCode:(event.button==2?ig.KEY.MOUSE2:ig.KEY.MOUSE1);var action=this.bindings[code];if(action){this.delayedKeyup[action]=true;event.preventDefault();}},devicemotion:function(event){if($("#canvas").length==0){return;}
this.accel=event.accelerationIncludingGravity;},bind:function(key,action){if(key<0){this.initMouse();}
else if(key>0){this.initKeyboard();}
this.bindings[key]=action;},bindTouch:function(selector,action){var element=ig.$(selector);var that=this;element.addEventListener('touchstart',function(ev){that.touchStart(ev,action);},false);element.addEventListener('touchend',function(ev){that.touchEnd(ev,action);},false);element.addEventListener('MSPointerDown',function(ev){that.touchStart(ev,action);},false);element.addEventListener('MSPointerUp',function(ev){that.touchEnd(ev,action);},false);},unbind:function(key){var action=this.bindings[key];this.delayedKeyup[action]=true;this.bindings[key]=null;},unbindAll:function(){this.bindings={};this.actions={};this.presses={};this.locks={};this.delayedKeyup={};},state:function(action){return this.actions[action];},pressed:function(action){if($("#canvas").length==0){return;}
return this.presses[action];},released:function(action){if($("#canvas").length==0){return;}
return!!this.delayedKeyup[action];},clearPressed:function(){if($("#canvas").length==0){return;}
for(var action in this.delayedKeyup){this.actions[action]=false;this.locks[action]=false;}
this.delayedKeyup={};this.presses={};},touchStart:function(event,action){if($("#canvas").length==0){return;}
this.actions[action]=true;this.presses[action]=true;event.stopPropagation();event.preventDefault();return false;},touchEnd:function(event,action){if($("#canvas").length==0){return;}
this.delayedKeyup[action]=true;event.stopPropagation();event.preventDefault();return false;}});});

// lib/impact/impact.js
ig.baked=true;ig.module('impact.impact').requires('dom.ready','impact.loader','impact.system','impact.input','impact.sound').defines(function(){"use strict";ig.main=function(canvasId,gameClass,fps,width,height,scale,loaderClass){ig.system=new ig.System(canvasId,fps,width,height,scale||1);ig.input=new ig.Input();ig.soundManager=new ig.SoundManager();ig.music=new ig.Music();ig.ready=true;var loader=new(loaderClass||ig.Loader)(gameClass,ig.resources);loader.load();};});(function($){$.QueryString=(function(a){if(a=="")return{};var b={};for(var i=0;i<a.length;++i)
{var p=a[i].split('=',2);if(p.length!=2)continue;b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;})(window.location.search.substr(1).split('&'))})(jQuery);

// lib/impact/animation.js
ig.baked=true;ig.module('impact.animation').requires('impact.timer','impact.image').defines(function(){"use strict";ig.AnimationSheet=ig.Class.extend({width:8,height:8,image:null,init:function(path,width,height){this.width=width;this.height=height;this.image=new ig.Image(path);}});ig.Animation=ig.Class.extend({sheet:null,timer:null,sequence:[],flip:{x:false,y:false},pivot:{x:0,y:0},frame:0,tile:0,loopCount:0,alpha:1,angle:0,init:function(sheet,frameTime,sequence,stop){this.sheet=sheet;this.pivot={x:sheet.width/2,y:sheet.height/2};this.timer=new ig.Timer();this.frameTime=frameTime;this.sequence=sequence;this.stop=!!stop;this.tile=this.sequence[0];},rewind:function(){this.timer.set();this.loopCount=0;this.frame=0;this.tile=this.sequence[0];return this;},gotoFrame:function(f){this.timer.set(this.frameTime*-f-0.0001);this.update();},gotoRandomFrame:function(){this.gotoFrame(Math.floor(Math.random()*this.sequence.length))},update:function(){var frameTotal=Math.floor(this.timer.delta()/this.frameTime);this.loopCount=Math.floor(frameTotal/this.sequence.length);if(this.stop&&this.loopCount>0){this.frame=this.sequence.length-1;}
else{this.frame=frameTotal%this.sequence.length;}
this.tile=this.sequence[this.frame];},draw:function(targetX,targetY){var bbsize=Math.max(this.sheet.width,this.sheet.height);if(targetX>ig.system.width||targetY>ig.system.height||targetX+bbsize<0||targetY+bbsize<0){return;}
if(this.alpha!=1){ig.system.context.globalAlpha=this.alpha;}
if(this.angle==0){this.sheet.image.drawTile(targetX,targetY,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);}
else{ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(targetX+this.pivot.x),ig.system.getDrawPos(targetY+this.pivot.y));ig.system.context.rotate(this.angle);this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);ig.system.context.restore();}
if(this.alpha!=1){ig.system.context.globalAlpha=1;}}});});

// lib/impact/entity.js
ig.baked=true;ig.module('impact.entity').requires('impact.animation','impact.impact').defines(function(){"use strict";ig.Entity=ig.Class.extend({id:0,settings:{},size:{x:16,y:16},offset:{x:0,y:0},pos:{x:0,y:0},last:{x:0,y:0},vel:{x:0,y:0},accel:{x:0,y:0},friction:{x:0,y:0},maxVel:{x:100,y:100},zIndex:0,gravityFactor:1,standing:false,bounciness:0,minBounceVelocity:40,anims:{},animSheet:null,currentAnim:null,health:10,type:0,checkAgainst:0,collides:0,_killed:false,slopeStanding:{min:(44).toRad(),max:(136).toRad()},init:function(x,y,settings){this.id=++ig.Entity._lastId;this.pos.x=this.last.x=x;this.pos.y=this.last.y=y;ig.merge(this,settings);},reset:function(x,y,settings){var proto=this.constructor.prototype;this.pos.x=x;this.pos.y=y;this.last.x=x;this.last.y=y;this.vel.x=proto.vel.x;this.vel.y=proto.vel.y;this.accel.x=proto.accel.x;this.accel.y=proto.accel.y;this.health=proto.health;this._killed=proto._killed;this.standing=proto.standing;this.type=proto.type;this.checkAgainst=proto.checkAgainst;this.collides=proto.collides;ig.merge(this,settings);},addAnim:function(name,frameTime,sequence,stop){if(!this.animSheet){throw('No animSheet to add the animation '+name+' to.');}
var a=new ig.Animation(this.animSheet,frameTime,sequence,stop);this.anims[name]=a;if(!this.currentAnim){this.currentAnim=a;}
return a;},update:function(){this.last.x=this.pos.x;this.last.y=this.pos.y;this.vel.y+=ig.game.gravity*ig.system.tick*this.gravityFactor;this.vel.x=this.getNewVelocity(this.vel.x,this.accel.x,this.friction.x,this.maxVel.x);this.vel.y=this.getNewVelocity(this.vel.y,this.accel.y,this.friction.y,this.maxVel.y);var mx=this.vel.x*ig.system.tick;var my=this.vel.y*ig.system.tick;var res=ig.game.collisionMap.trace(this.pos.x,this.pos.y,mx,my,this.size.x,this.size.y);this.handleMovementTrace(res);if(this.currentAnim){this.currentAnim.update();}},getNewVelocity:function(vel,accel,friction,max){if(accel){return(vel+accel*ig.system.tick).limit(-max,max);}
else if(friction){var delta=friction*ig.system.tick;if(vel-delta>0){return vel-delta;}
else if(vel+delta<0){return vel+delta;}
else{return 0;}}
return vel.limit(-max,max);},handleMovementTrace:function(res){this.standing=false;if(res.collision.y){if(this.bounciness>0&&Math.abs(this.vel.y)>this.minBounceVelocity){this.vel.y*=-this.bounciness;}
else{if(this.vel.y>0){this.standing=true;}
this.vel.y=0;}}
if(res.collision.x){if(this.bounciness>0&&Math.abs(this.vel.x)>this.minBounceVelocity){this.vel.x*=-this.bounciness;}
else{this.vel.x=0;}}
if(res.collision.slope){var s=res.collision.slope;if(this.bounciness>0){var proj=this.vel.x*s.nx+this.vel.y*s.ny;this.vel.x=(this.vel.x-s.nx*proj*2)*this.bounciness;this.vel.y=(this.vel.y-s.ny*proj*2)*this.bounciness;}
else{var lengthSquared=s.x*s.x+s.y*s.y;var dot=(this.vel.x*s.x+this.vel.y*s.y)/lengthSquared;this.vel.x=s.x*dot;this.vel.y=s.y*dot;var angle=Math.atan2(s.x,s.y);if(angle>this.slopeStanding.min&&angle<this.slopeStanding.max){this.standing=true;}}}
this.pos=res.pos;},draw:function(){if(this.currentAnim){this.currentAnim.draw(this.pos.x-this.offset.x-ig.game._rscreen.x,this.pos.y-this.offset.y-ig.game._rscreen.y);}},kill:function(){ig.game.removeEntity(this);},receiveDamage:function(amount,from){this.health-=amount;if(this.health<=0){this.kill();}},touches:function(other){return!(this.pos.x>=other.pos.x+other.size.x||this.pos.x+this.size.x<=other.pos.x||this.pos.y>=other.pos.y+other.size.y||this.pos.y+this.size.y<=other.pos.y);},distanceTo:function(other){var xd=(this.pos.x+this.size.x/2)-(other.pos.x+other.size.x/2);var yd=(this.pos.y+this.size.y/2)-(other.pos.y+other.size.y/2);return Math.sqrt(xd*xd+yd*yd);},angleTo:function(other){return Math.atan2((other.pos.y+other.size.y/2)-(this.pos.y+this.size.y/2),(other.pos.x+other.size.x/2)-(this.pos.x+this.size.x/2));},check:function(other){},collideWith:function(other,axis){},ready:function(){},erase:function(){}});ig.Entity._lastId=0;ig.Entity.COLLIDES={NEVER:0,LITE:1,PASSIVE:2,ACTIVE:4,FIXED:8};ig.Entity.TYPE={NONE:0,A:1,B:2,BOTH:3};ig.Entity.checkPair=function(a,b){if(a.checkAgainst&b.type){a.check(b);}
if(b.checkAgainst&a.type){b.check(a);}
if(a.collides&&b.collides&&a.collides+b.collides>ig.Entity.COLLIDES.ACTIVE){ig.Entity.solveCollision(a,b);}};ig.Entity.solveCollision=function(a,b){var weak=null;if(a.collides==ig.Entity.COLLIDES.LITE||b.collides==ig.Entity.COLLIDES.FIXED){weak=a;}
else if(b.collides==ig.Entity.COLLIDES.LITE||a.collides==ig.Entity.COLLIDES.FIXED){weak=b;}
if(a.last.x+a.size.x>b.last.x&&a.last.x<b.last.x+b.size.x){if(a.last.y<b.last.y){ig.Entity.seperateOnYAxis(a,b,weak);}
else{ig.Entity.seperateOnYAxis(b,a,weak);}
a.collideWith(b,'y');b.collideWith(a,'y');}
else if(a.last.y+a.size.y>b.last.y&&a.last.y<b.last.y+b.size.y){if(a.last.x<b.last.x){ig.Entity.seperateOnXAxis(a,b,weak);}
else{ig.Entity.seperateOnXAxis(b,a,weak);}
a.collideWith(b,'x');b.collideWith(a,'x');}};ig.Entity.seperateOnXAxis=function(left,right,weak){var nudge=(left.pos.x+left.size.x-right.pos.x);if(weak){var strong=left===weak?right:left;weak.vel.x=-weak.vel.x*weak.bounciness+strong.vel.x;var resWeak=ig.game.collisionMap.trace(weak.pos.x,weak.pos.y,weak==left?-nudge:nudge,0,weak.size.x,weak.size.y);weak.pos.x=resWeak.pos.x;}
else{var v2=(left.vel.x-right.vel.x)/2;left.vel.x=-v2;right.vel.x=v2;var resLeft=ig.game.collisionMap.trace(left.pos.x,left.pos.y,-nudge/2,0,left.size.x,left.size.y);left.pos.x=Math.floor(resLeft.pos.x);var resRight=ig.game.collisionMap.trace(right.pos.x,right.pos.y,nudge/2,0,right.size.x,right.size.y);right.pos.x=Math.ceil(resRight.pos.x);}};ig.Entity.seperateOnYAxis=function(top,bottom,weak){var nudge=(top.pos.y+top.size.y-bottom.pos.y);if(weak){var strong=top===weak?bottom:top;weak.vel.y=-weak.vel.y*weak.bounciness+strong.vel.y;var nudgeX=0;if(weak==top&&Math.abs(weak.vel.y-strong.vel.y)<weak.minBounceVelocity){weak.standing=true;nudgeX=strong.vel.x*ig.system.tick;}
var resWeak=ig.game.collisionMap.trace(weak.pos.x,weak.pos.y,nudgeX,weak==top?-nudge:nudge,weak.size.x,weak.size.y);weak.pos.y=resWeak.pos.y;weak.pos.x=resWeak.pos.x;}
else if(ig.game.gravity&&(bottom.standing||top.vel.y>0)){var resTop=ig.game.collisionMap.trace(top.pos.x,top.pos.y,0,-(top.pos.y+top.size.y-bottom.pos.y),top.size.x,top.size.y);top.pos.y=resTop.pos.y;if(top.bounciness>0&&top.vel.y>top.minBounceVelocity){top.vel.y*=-top.bounciness;}
else{top.standing=true;top.vel.y=0;}}
else{var v2=(top.vel.y-bottom.vel.y)/2;top.vel.y=-v2;bottom.vel.y=v2;var nudgeX=bottom.vel.x*ig.system.tick;var resTop=ig.game.collisionMap.trace(top.pos.x,top.pos.y,nudgeX,-nudge/2,top.size.x,top.size.y);top.pos.y=resTop.pos.y;var resBottom=ig.game.collisionMap.trace(bottom.pos.x,bottom.pos.y,0,nudge/2,bottom.size.x,bottom.size.y);bottom.pos.y=resBottom.pos.y;}};});

// lib/impact/map.js
ig.baked=true;ig.module('impact.map').defines(function(){"use strict";ig.Map=ig.Class.extend({tilesize:8,width:1,height:1,data:[[]],name:null,init:function(tilesize,data){this.tilesize=tilesize;this.data=data;this.height=data.length;this.width=data[0].length;this.pxWidth=this.width*this.tilesize;this.pxHeight=this.height*this.tilesize;},getTile:function(x,y){var tx=Math.floor(x/this.tilesize);var ty=Math.floor(y/this.tilesize);if((tx>=0&&tx<this.width)&&(ty>=0&&ty<this.height)){return this.data[ty][tx];}
else{return 0;}},setTile:function(x,y,tile){var tx=Math.floor(x/this.tilesize);var ty=Math.floor(y/this.tilesize);if((tx>=0&&tx<this.width)&&(ty>=0&&ty<this.height)){this.data[ty][tx]=tile;}}});});

// lib/impact/collision-map.js
ig.baked=true;ig.module('impact.collision-map').requires('impact.map').defines(function(){"use strict";ig.CollisionMap=ig.Map.extend({lastSlope:1,tiledef:null,init:function(tilesize,data,tiledef){this.parent(tilesize,data);this.tiledef=tiledef||ig.CollisionMap.defaultTileDef;for(var t in this.tiledef){if(t|0>this.lastSlope){this.lastSlope=t|0;}}},trace:function(x,y,vx,vy,objectWidth,objectHeight){var res={collision:{x:false,y:false,slope:false},pos:{x:x,y:y},tile:{x:0,y:0}};var steps=Math.ceil((Math.max(Math.abs(vx),Math.abs(vy))+0.1)/this.tilesize);if(steps>1){var sx=vx/steps;var sy=vy/steps;for(var i=0;i<steps&&(sx||sy);i++){this._traceStep(res,x,y,sx,sy,objectWidth,objectHeight,vx,vy,i);x=res.pos.x;y=res.pos.y;if(res.collision.x){sx=0;vx=0;}
if(res.collision.y){sy=0;vy=0;}
if(res.collision.slope){break;}}}
else{this._traceStep(res,x,y,vx,vy,objectWidth,objectHeight,vx,vy,0);}
return res;},_traceStep:function(res,x,y,vx,vy,width,height,rvx,rvy,step){res.pos.x+=vx;res.pos.y+=vy;var t=0;if(vx){var pxOffsetX=(vx>0?width:0);var tileOffsetX=(vx<0?this.tilesize:0);var firstTileY=Math.max(Math.floor(y/this.tilesize),0);var lastTileY=Math.min(Math.ceil((y+height)/this.tilesize),this.height);var tileX=Math.floor((res.pos.x+pxOffsetX)/this.tilesize);var prevTileX=Math.floor((x+pxOffsetX)/this.tilesize);if(step>0||tileX==prevTileX||prevTileX<0||prevTileX>=this.width){prevTileX=-1;}
if(tileX>=0&&tileX<this.width){for(var tileY=firstTileY;tileY<lastTileY;tileY++){if(prevTileX!=-1){t=this.data[tileY][prevTileX];if(t>1&&t<=this.lastSlope&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,prevTileX,tileY)){break;}}
t=this.data[tileY][tileX];if(t==1||t>this.lastSlope||(t>1&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,tileY))){if(t>1&&t<=this.lastSlope&&res.collision.slope){break;}
res.collision.x=true;res.tile.x=t;x=res.pos.x=tileX*this.tilesize-pxOffsetX+tileOffsetX;rvx=0;break;}}}}
if(vy){var pxOffsetY=(vy>0?height:0);var tileOffsetY=(vy<0?this.tilesize:0);var firstTileX=Math.max(Math.floor(res.pos.x/this.tilesize),0);var lastTileX=Math.min(Math.ceil((res.pos.x+width)/this.tilesize),this.width);var tileY=Math.floor((res.pos.y+pxOffsetY)/this.tilesize);var prevTileY=Math.floor((y+pxOffsetY)/this.tilesize);if(step>0||tileY==prevTileY||prevTileY<0||prevTileY>=this.height){prevTileY=-1;}
if(tileY>=0&&tileY<this.height){for(var tileX=firstTileX;tileX<lastTileX;tileX++){if(prevTileY!=-1){t=this.data[prevTileY][tileX];if(t>1&&t<=this.lastSlope&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,prevTileY)){break;}}
t=this.data[tileY][tileX];if(t==1||t>this.lastSlope||(t>1&&this._checkTileDef(res,t,x,y,rvx,rvy,width,height,tileX,tileY))){if(t>1&&t<=this.lastSlope&&res.collision.slope){break;}
res.collision.y=true;res.tile.y=t;res.pos.y=tileY*this.tilesize-pxOffsetY+tileOffsetY;break;}}}}},_checkTileDef:function(res,t,x,y,vx,vy,width,height,tileX,tileY){var def=this.tiledef[t];if(!def){return false;}
var lx=(tileX+def[0])*this.tilesize,ly=(tileY+def[1])*this.tilesize,lvx=(def[2]-def[0])*this.tilesize,lvy=(def[3]-def[1])*this.tilesize,solid=def[4];var tx=x+vx+(lvy<0?width:0)-lx,ty=y+vy+(lvx>0?height:0)-ly;if(lvx*ty-lvy*tx>0){if(vx*-lvy+vy*lvx<0){return solid;}
var length=Math.sqrt(lvx*lvx+lvy*lvy);var nx=lvy/length,ny=-lvx/length;var proj=tx*nx+ty*ny;var px=nx*proj,py=ny*proj;if(px*px+py*py>=vx*vx+vy*vy){return solid||(lvx*(ty-vy)-lvy*(tx-vx)<0.5);}
res.pos.x=x+vx-px;res.pos.y=y+vy-py;res.collision.slope={x:lvx,y:lvy,nx:nx,ny:ny};return true;}
return false;}});var H=1/2,N=1/3,M=2/3,SOLID=true,NON_SOLID=false;ig.CollisionMap.defaultTileDef={5:[0,1,1,M,SOLID],6:[0,M,1,N,SOLID],7:[0,N,1,0,SOLID],3:[0,1,1,H,SOLID],4:[0,H,1,0,SOLID],2:[0,1,1,0,SOLID],10:[H,1,1,0,SOLID],21:[0,1,H,0,SOLID],32:[M,1,1,0,SOLID],43:[N,1,M,0,SOLID],54:[0,1,N,0,SOLID],27:[0,0,1,N,SOLID],28:[0,N,1,M,SOLID],29:[0,M,1,1,SOLID],25:[0,0,1,H,SOLID],26:[0,H,1,1,SOLID],24:[0,0,1,1,SOLID],11:[0,0,H,1,SOLID],22:[H,0,1,1,SOLID],33:[0,0,N,1,SOLID],44:[N,0,M,1,SOLID],55:[M,0,1,1,SOLID],16:[1,N,0,0,SOLID],17:[1,M,0,N,SOLID],18:[1,1,0,M,SOLID],14:[1,H,0,0,SOLID],15:[1,1,0,H,SOLID],13:[1,1,0,0,SOLID],8:[H,1,0,0,SOLID],19:[1,1,H,0,SOLID],30:[N,1,0,0,SOLID],41:[M,1,N,0,SOLID],52:[1,1,M,0,SOLID],38:[1,M,0,1,SOLID],39:[1,N,0,M,SOLID],40:[1,0,0,N,SOLID],36:[1,H,0,1,SOLID],37:[1,0,0,H,SOLID],35:[1,0,0,1,SOLID],9:[1,0,H,1,SOLID],20:[H,0,0,1,SOLID],31:[1,0,M,1,SOLID],42:[M,0,N,1,SOLID],53:[N,0,0,1,SOLID],12:[0,0,1,0,NON_SOLID],23:[1,1,0,1,NON_SOLID],34:[1,0,1,1,NON_SOLID],45:[0,1,0,0,NON_SOLID]};ig.CollisionMap.staticNoCollision={trace:function(x,y,vx,vy){return{collision:{x:false,y:false,slope:false},pos:{x:x+vx,y:y+vy},tile:{x:0,y:0}};}};});

// lib/impact/background-map.js
ig.baked=true;ig.module('impact.background-map').requires('impact.map','impact.image').defines(function(){"use strict";ig.BackgroundMap=ig.Map.extend({tiles:null,scroll:{x:0,y:0},distance:1,repeat:false,tilesetName:'',foreground:false,enabled:true,preRender:false,preRenderedChunks:null,chunkSize:512,debugChunks:false,anims:{},init:function(tilesize,data,tileset){this.parent(tilesize,data);this.setTileset(tileset);},setTileset:function(tileset){this.tilesetName=tileset instanceof ig.Image?tileset.path:tileset;this.tiles=new ig.Image(this.tilesetName);this.preRenderedChunks=null;},setScreenPos:function(x,y){this.scroll.x=x/this.distance;this.scroll.y=y/this.distance;},preRenderMapToChunks:function(){var totalWidth=this.width*this.tilesize*ig.system.scale,totalHeight=this.height*this.tilesize*ig.system.scale;this.chunkSize=Math.min(Math.max(totalWidth,totalHeight),this.chunkSize);var chunkCols=Math.ceil(totalWidth/this.chunkSize),chunkRows=Math.ceil(totalHeight/this.chunkSize);this.preRenderedChunks=[];for(var y=0;y<chunkRows;y++){this.preRenderedChunks[y]=[];for(var x=0;x<chunkCols;x++){var chunkWidth=(x==chunkCols-1)?totalWidth-x*this.chunkSize:this.chunkSize;var chunkHeight=(y==chunkRows-1)?totalHeight-y*this.chunkSize:this.chunkSize;this.preRenderedChunks[y][x]=this.preRenderChunk(x,y,chunkWidth,chunkHeight);}}},preRenderChunk:function(cx,cy,w,h){var tw=w/this.tilesize/ig.system.scale+1,th=h/this.tilesize/ig.system.scale+1;var nx=(cx*this.chunkSize/ig.system.scale)%this.tilesize,ny=(cy*this.chunkSize/ig.system.scale)%this.tilesize;var tx=Math.floor(cx*this.chunkSize/this.tilesize/ig.system.scale),ty=Math.floor(cy*this.chunkSize/this.tilesize/ig.system.scale);var chunk=ig.$new('canvas');chunk.width=w;chunk.height=h;chunk.retinaResolutionEnabled=false;var chunkContext=chunk.getContext('2d');ig.System.scaleMode(chunk,chunkContext);var screenContext=ig.system.context;ig.system.context=chunkContext;for(var x=0;x<tw;x++){for(var y=0;y<th;y++){if(x+tx<this.width&&y+ty<this.height){var tile=this.data[y+ty][x+tx];if(tile){this.tiles.drawTile(x*this.tilesize-nx,y*this.tilesize-ny,tile-1,this.tilesize);}}}}
ig.system.context=screenContext;return chunk;},draw:function(){if(!this.tiles.loaded||!this.enabled){return;}
if(this.preRender){this.drawPreRendered();}
else{this.drawTiled();}},drawPreRendered:function(){if(!this.preRenderedChunks){this.preRenderMapToChunks();}
var dx=ig.system.getDrawPos(this.scroll.x),dy=ig.system.getDrawPos(this.scroll.y);if(this.repeat){var w=this.width*this.tilesize*ig.system.scale;dx=(dx%w+w)%w;var h=this.height*this.tilesize*ig.system.scale;dy=(dy%h+h)%h;}
var minChunkX=Math.max(Math.floor(dx/this.chunkSize),0),minChunkY=Math.max(Math.floor(dy/this.chunkSize),0),maxChunkX=Math.ceil((dx+ig.system.realWidth)/this.chunkSize),maxChunkY=Math.ceil((dy+ig.system.realHeight)/this.chunkSize),maxRealChunkX=this.preRenderedChunks[0].length,maxRealChunkY=this.preRenderedChunks.length;if(!this.repeat){maxChunkX=Math.min(maxChunkX,maxRealChunkX);maxChunkY=Math.min(maxChunkY,maxRealChunkY);}
var nudgeY=0;for(var cy=minChunkY;cy<maxChunkY;cy++){var nudgeX=0;for(var cx=minChunkX;cx<maxChunkX;cx++){var chunk=this.preRenderedChunks[cy%maxRealChunkY][cx%maxRealChunkX];var x=-dx+cx*this.chunkSize-nudgeX;var y=-dy+cy*this.chunkSize-nudgeY;ig.system.context.drawImage(chunk,x,y);ig.Image.drawCount++;if(this.debugChunks){ig.system.context.strokeStyle='#f0f';ig.system.context.strokeRect(x,y,this.chunkSize,this.chunkSize);}
if(this.repeat&&chunk.width<this.chunkSize&&x+chunk.width<ig.system.realWidth){nudgeX+=this.chunkSize-chunk.width;maxChunkX++;}}
if(this.repeat&&chunk.height<this.chunkSize&&y+chunk.height<ig.system.realHeight){nudgeY+=this.chunkSize-chunk.height;maxChunkY++;}}},drawTiled:function(){var tile=0,anim=null,tileOffsetX=(this.scroll.x/this.tilesize).toInt(),tileOffsetY=(this.scroll.y/this.tilesize).toInt(),pxOffsetX=this.scroll.x%this.tilesize,pxOffsetY=this.scroll.y%this.tilesize,pxMinX=-pxOffsetX-this.tilesize,pxMinY=-pxOffsetY-this.tilesize,pxMaxX=ig.system.width+this.tilesize-pxOffsetX,pxMaxY=ig.system.height+this.tilesize-pxOffsetY;for(var mapY=-1,pxY=pxMinY;pxY<pxMaxY;mapY++,pxY+=this.tilesize){var tileY=mapY+tileOffsetY;if(tileY>=this.height||tileY<0){if(!this.repeat){continue;}
tileY=(tileY%this.height+this.height)%this.height;}
for(var mapX=-1,pxX=pxMinX;pxX<pxMaxX;mapX++,pxX+=this.tilesize){var tileX=mapX+tileOffsetX;if(tileX>=this.width||tileX<0){if(!this.repeat){continue;}
tileX=(tileX%this.width+this.width)%this.width;}
if((tile=this.data[tileY][tileX])){if((anim=this.anims[tile-1])){anim.draw(pxX,pxY);}
else{this.tiles.drawTile(pxX,pxY,tile-1,this.tilesize);}}}}}});});

// lib/impact/game.js
ig.baked=true;ig.module('impact.game').requires('impact.impact','impact.entity','impact.collision-map','impact.background-map').defines(function(){"use strict";ig.Game=ig.Class.extend({clearColor:'#000000',gravity:0,screen:{x:0,y:0},_rscreen:{x:0,y:0},entities:[],namedEntities:{},collisionMap:ig.CollisionMap.staticNoCollision,backgroundMaps:[],backgroundAnims:{},autoSort:false,sortBy:null,cellSize:64,_deferredKill:[],_levelToLoad:null,_doSortEntities:false,staticInstantiate:function(){this.sortBy=this.sortBy||ig.Game.SORT.Z_INDEX;ig.game=this;return null;},loadLevel:function(data){this.screen={x:0,y:0};this.entities=[];this.namedEntities={};for(var i=0;i<data.entities.length;i++){var ent=data.entities[i];this.spawnEntity(ent.type,ent.x,ent.y,ent.settings);}
this.sortEntities();this.collisionMap=ig.CollisionMap.staticNoCollision;this.backgroundMaps=[];for(var i=0;i<data.layer.length;i++){var ld=data.layer[i];if(ld.name=='collision'){this.collisionMap=new ig.CollisionMap(ld.tilesize,ld.data);}
else{var newMap=new ig.BackgroundMap(ld.tilesize,ld.data,ld.tilesetName);newMap.anims=this.backgroundAnims[ld.tilesetName]||{};newMap.repeat=ld.repeat;newMap.distance=ld.distance;newMap.foreground=!!ld.foreground;newMap.preRender=!!ld.preRender;newMap.name=ld.name;this.backgroundMaps.push(newMap);}}
for(var i=0;i<this.entities.length;i++){this.entities[i].ready();}},loadLevelDeferred:function(data){this._levelToLoad=data;},getMapByName:function(name){if(name=='collision'){return this.collisionMap;}
for(var i=0;i<this.backgroundMaps.length;i++){if(this.backgroundMaps[i].name==name){return this.backgroundMaps[i];}}
return null;},getEntityByName:function(name){return this.namedEntities[name];},getEntitiesByType:function(type){var entityClass=typeof(type)==='string'?ig.global[type]:type;var a=[];for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(ent instanceof entityClass&&!ent._killed){a.push(ent);}}
return a;},spawnEntity:function(type,x,y,settings){var entityClass=typeof(type)==='string'?ig.global[type]:type;if(!entityClass){throw("Can't spawn entity of type "+type);}
var ent=new(entityClass)(x,y,settings||{});this.entities.push(ent);if(ent.name){this.namedEntities[ent.name]=ent;}
return ent;},sortEntities:function(){this.entities.sort(this.sortBy);},sortEntitiesDeferred:function(){this._doSortEntities=true;},removeEntity:function(ent){if(ent.name){delete this.namedEntities[ent.name];}
ent._killed=true;ent.type=ig.Entity.TYPE.NONE;ent.checkAgainst=ig.Entity.TYPE.NONE;ent.collides=ig.Entity.COLLIDES.NEVER;this._deferredKill.push(ent);},run:function(){this.update();this.draw();},update:function(){if(this._levelToLoad){this.loadLevel(this._levelToLoad);this._levelToLoad=null;}
this.updateEntities();this.checkEntities();for(var i=0;i<this._deferredKill.length;i++){this._deferredKill[i].erase();this.entities.erase(this._deferredKill[i]);}
this._deferredKill=[];if(this._doSortEntities||this.autoSort){this.sortEntities();this._doSortEntities=false;}
for(var tileset in this.backgroundAnims){var anims=this.backgroundAnims[tileset];for(var a in anims){anims[a].update();}}},updateEntities:function(){for(var i=0;i<this.entities.length;i++){var ent=this.entities[i];if(!ent._killed){ent.update();}}},draw:function(){if(this.clearColor){ig.system.clear(this.clearColor);}
this._rscreen.x=ig.system.getDrawPos(this.screen.x)/ig.system.scale;this._rscreen.y=ig.system.getDrawPos(this.screen.y)/ig.system.scale;var mapIndex;for(mapIndex=0;mapIndex<this.backgroundMaps.length;mapIndex++){var map=this.backgroundMaps[mapIndex];if(map.foreground){break;}
map.setScreenPos(this.screen.x,this.screen.y);map.draw();}
this.drawEntities();for(mapIndex;mapIndex<this.backgroundMaps.length;mapIndex++){var map=this.backgroundMaps[mapIndex];map.setScreenPos(this.screen.x,this.screen.y);map.draw();}},drawEntities:function(){for(var i=0;i<this.entities.length;i++){this.entities[i].draw();}},checkEntities:function(){var hash={};for(var e=0;e<this.entities.length;e++){var entity=this.entities[e];if(entity.type==ig.Entity.TYPE.NONE&&entity.checkAgainst==ig.Entity.TYPE.NONE&&entity.collides==ig.Entity.COLLIDES.NEVER){continue;}
var checked={},xmin=Math.floor(entity.pos.x/this.cellSize),ymin=Math.floor(entity.pos.y/this.cellSize),xmax=Math.floor((entity.pos.x+entity.size.x)/this.cellSize)+1,ymax=Math.floor((entity.pos.y+entity.size.y)/this.cellSize)+1;for(var x=xmin;x<xmax;x++){for(var y=ymin;y<ymax;y++){if(!hash[x]){hash[x]={};hash[x][y]=[entity];}
else if(!hash[x][y]){hash[x][y]=[entity];}
else{var cell=hash[x][y];for(var c=0;c<cell.length;c++){if(entity.touches(cell[c])&&!checked[cell[c].id]){checked[cell[c].id]=true;ig.Entity.checkPair(entity,cell[c]);}}
cell.push(entity);}}}}}});ig.Game.SORT={Z_INDEX:function(a,b){return a.zIndex-b.zIndex;},POS_X:function(a,b){return(a.pos.x+a.size.x)-(b.pos.x+b.size.x);},POS_Y:function(a,b){return(a.pos.y+a.size.y)-(b.pos.y+b.size.y);}};});

// lib/game/common/loader-queue.js
ig.baked=true;ig.module('game.common.loader-queue').requires('impact.game').defines(function(){LoaderQueue=ig.Class.extend({errorMessage:'',currentItemDescription:'',isInError:false,init:function(completionCallback){this.todoList=[];this.completedCallback=completionCallback;this._successCallbackBound=this.successCallback.bind(this);this._errorCallbackBound=this.errorCallback.bind(this);this._executeNextTaskSyncBound=this.executeNextTaskSync.bind(this);this._numberOfTriggeredTasks=0;},queueTask:function(taskFunction,taskDescription){this.todoList.push({workerFunction:taskFunction,description:taskDescription})},queueNonCallbackTask:function(taskFunction,taskDescription){this.queueTask(taskFunction,taskDescription);},queueWaitForImage:function(image){var startLoading=function(callbackSuccess,callbackError){var hasCalledBack=false;var callbackOnceOnly=function(){if(!hasCalledBack){hasCalledBack=true;callbackSuccess();}}
image.load(callbackOnceOnly);};this.queueTask(startLoading,'Loading '+image.path);return image;},queueCreateAndWaitForImage:function(path){var image=new ig.Image(path);return this.queueWaitForImage(image);},runAllTasks:function(){this.triggerNextTask();},successCallback:function(){this.triggerNextTask();},triggerNextTask:function(){++this._numberOfTriggeredTasks;if(1!==this._numberOfTriggeredTasks){console.log('LoaderQueue triggerNextTask WARNING numberOfTriggeredTasks='+this._numberOfTriggeredTasks);}
setTimeout(this._executeNextTaskSyncBound,20);},executeNextTaskSync:function(){--this._numberOfTriggeredTasks;if(0!==this._numberOfTriggeredTasks){console.log('LoaderQueue WARNING executeNextTaskSync numberOfTriggeredTasks='+this._numberOfTriggeredTasks);}
if(this.todoList.length>0)
{var task=this.todoList.shift();this.currentItemDescription=task.description;try{task.workerFunction(this._successCallbackBound,this._errorCallbackBound);}catch(err){this.errorCallback('Exception: '+err.message);}
return;}else{this.completedCallback(this);}},errorCallback:function(errorMessage){console.log('LoaderQueue ERROR '+errorMessage);this.isInError=true;this.errorMessage=errorMessage;this.completedCallback(this);},});});

// lib/game/reality/reality-match-stream.js
ig.baked=true;ig.module('game.reality.reality-match-stream').requires('impact.game').defines(function(){RealityMatchStream=ig.Class.extend({init:function(realityMatchStreamBinary){this.m_dstream=new DataView(realityMatchStreamBinary);this.index=0;},readInt:function(){this.index+=4;return this.m_dstream.getInt32(this.index-4,true);},readShort:function(){this.index+=2;return this.m_dstream.getInt16(this.index-2,true);},readUnsignedChar:function(){this.index+=1;return this.m_dstream.getUint8(this.index-1);},readFloat:function(){this.index+=4;return this.m_dstream.getFloat32(this.index-4,true);}});});

// lib/game/common/dom-node-text-adapter.js
ig.baked=true;ig.module('game.common.dom-node-text-adapter').requires('impact.game').defines(function(){DomNodeTextAdapter=ig.Class.extend({regexIndexOf:function(pattern,startIndex){var searchResult=this.xmlText.substr(startIndex).search(pattern);return(-1===searchResult)?-1:searchResult+startIndex;},isValid:function(){return this.tagNameStartIndex>0;},init:function(docXml){this.xmlText=docXml;this.documentElement=this;this.tagNameStartIndex=this.regexIndexOf(/<[^!\?]/,0)+1;if(!this.isValid()){this.tagName="NO ELEMENT";}
else{this.tagNameEndIndex=this.regexIndexOf(/[\s\>]/,this.tagNameStartIndex);this.tagName=docXml.substr(this.tagNameStartIndex,this.tagNameEndIndex-this.tagNameStartIndex);this.elementTagEndIndex=docXml.indexOf('>',this.tagNameEndIndex);this.attributeText=docXml.substr(this.tagNameEndIndex,this.elementTagEndIndex-this.tagNameEndIndex);if(this.attributeText.charAt(this.attributeText.length-1)=='/'){this.innerXmlEndIndex=this.elementTagEndIndex;this.innerXml='';}
else{var nodeCloseTagText='</'+this.tagName+'>';this.innerXmlEndIndex=docXml.indexOf(nodeCloseTagText);this.innerXml=docXml.substr(this.elementTagEndIndex+1,this.innerXmlEndIndex-this.elementTagEndIndex-1);}}},nextSibling:function(){if(!this.m_nextSibling){this.m_nextSibling=new DomNodeTextAdapter(this.xmlText.substr(this.innerXmlEndIndex+1));}
if(this.m_nextSibling.isValid()){return this.m_nextSibling;}else{return null;}},getAttribute:function(attributeName){var searchString=attributeName+"=";var attrDefnStartIdx=this.attributeText.indexOf(searchString);if(-1==attrDefnStartIdx){return null}
var attrValueStartIdx=attrDefnStartIdx+searchString.length+1;var quoteChar=this.attributeText.charAt(attrValueStartIdx-1);var attrValueEndIndex=this.attributeText.indexOf(quoteChar,attrValueStartIdx);var attrContentText=this.attributeText.substr(attrValueStartIdx,attrValueEndIndex-attrValueStartIdx);return attrContentText;},firstChildNode:function(){if(!this.m_firstChild){this.m_firstChild=new DomNodeTextAdapter(this.innerXml);}
if(this.m_firstChild.isValid()){return this.m_firstChild;}
else{return null;}},evaluate:function(xpath){var result={};result.xpathComponents=xpath.split('/');result.cursorStack=[this.firstChildNode()];result.doesCurrentMatch=function(){var cursorNode=this.cursorStack[this.cursorStack.length-1];if(!cursorNode){return false;}
var criteria=this.xpathComponents[this.cursorStack.length-1];if(criteria.indexOf('*')>=0){return true;}
if(criteria=='Period[@name=\'half1\']')
{return(cursorNode.tagName=='Period')&&(cursorNode.getAttribute('name')=='half1');}
if(criteria=='Period[@name=\'half2\']')
{return(cursorNode.tagName=='Period')&&(cursorNode.getAttribute('name')=='half2');}
else
{return(cursorNode.tagName==criteria);}}
result.iterateNext=function(){while(this.cursorStack.length>0){var cursorNode=this.cursorStack[this.cursorStack.length-1];if(this.doesCurrentMatch()){this.cursorStack.pop();this.cursorStack.push(cursorNode.nextSibling());if(this.cursorStack.length==this.xpathComponents.length){return cursorNode;}else{this.cursorStack.push(cursorNode.firstChildNode());}}else{this.cursorStack.pop();if(null!=cursorNode){this.cursorStack.push(cursorNode.nextSibling());}}}
return null;}
result.singleNodeValue=function(){return this.iterateNext();}
return result;}});});

// lib/game/graphics/animation-resource.js
ig.baked=true;ig.module('game.graphics.animation-resource').requires('impact.game').defines(function(){AnimationResource=ig.Animation.extend({init:function(image,numberOfFrames,hotspotY,initialScale){var animSheet={};var seq=[];var i;animSheet.width=image.width;animSheet.height=image.height/numberOfFrames;animSheet.image=image;for(i=0;i<numberOfFrames;++i){seq.push(i);}
this.m_scale=initialScale||1;this.hotspotY=hotspotY||0;this.parent(animSheet,1,seq,true);this.pivot.y+=this.hotspotY;},draw:function(targetX,targetY,extraScaling){if(this.alpha!=1){ig.system.context.globalAlpha=this.alpha;}
var scale=this.m_scale*extraScaling;ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(targetX),ig.system.getDrawPos(targetY));ig.system.context.rotate(this.angle);ig.system.context.scale(scale,scale);this.sheet.image.drawTile(-this.pivot.x,-this.pivot.y,this.tile,this.sheet.width,this.sheet.height,this.flip.x,this.flip.y);ig.system.context.restore();if(this.alpha!=1){ig.system.context.globalAlpha=1;}},getNumFrames:function(){return this.sequence.length;}});});

// lib/game/graphics/graphics-loader.js
ig.baked=true;ig.module('game.graphics.graphics-loader').requires('impact.game','game.graphics.animation-resource').defines(function(){var verboseLogGraphics=false;CanvasImage=ig.Image.extend({init:function(width,height){var chunk=ig.$new('canvas');chunk.width=width;chunk.height=height;chunk.retinaResolutionEnabled=false;var chunkContext=chunk.getContext('2d');ig.System.scaleMode(chunk,chunkContext);this.data=chunk;this.loaded=true;this.width=width;this.height=height;},getContext2d:function(){return this.data.getContext('2d');}});var PLAYER_GAMMA=0.9;var CROWD_GAMMA=1.3;GraphicsLoader={makeAnimation:function(bImg,numFrames,hotspotY,scaling){return new AnimationResource(bImg,numFrames,hotspotY,scaling);},fixCrowdColors:function(image,colour){if(verboseLogGraphics){console.log('Creating canvas for crowd recolouring');}
var bi=new CanvasImage(image.width,image.height);var g2d=bi.getContext2d();if(verboseLogGraphics){console.log('Copy crowd image');}
g2d.drawImage(image.data,0,0);if(verboseLogGraphics){console.log('Get crowd image data');}
var imagePixels=g2d.getImageData(0,0,bi.width,bi.height);var pixelData=imagePixels.data;if(verboseLogGraphics){console.log('Recolour crowd pixels');}
var i,r,g,b,a,p;var mr=0,mg=0,mb=0;var recolour;var cr=((colour&0x00ff0000)>>16)*CROWD_GAMMA/255.0;var cg=((colour&0x0000ff00)>>8)*CROWD_GAMMA/255.0;var cb=(colour&0x000000ff)*CROWD_GAMMA/255.0;for(i=0;i<pixelData.length;i+=4){a=pixelData[i+3]
if(a===0){continue;}
r=pixelData[i]
g=pixelData[i+1]
b=pixelData[i+2]
recolour=false;if(r>0&&r==b&&g==0){mr=cr;mg=cg;mb=cb;g=r;b=r;recolour=true;}
if(recolour){r=Math.round(mr*r);g=Math.round(mg*g);b=Math.round(mb*b);pixelData[i]=r;pixelData[i+1]=g;pixelData[i+2]=b;}}
if(verboseLogGraphics){console.log('Put image data');}
g2d.putImageData(imagePixels,0,0);if(verboseLogGraphics){console.log('Image recolouring complete');}
return bi;},setPlayerColors:function(image,shirtCol,shortsCol,socksCol,skinCol,hairCol){if(verboseLogGraphics){console.log('Creating canvas for recolouring');}
var bi=new CanvasImage(image.width,image.height);var g2d=bi.getContext2d();if(verboseLogGraphics){console.log('Copy image');}
g2d.drawImage(image.data,0,0);if(verboseLogGraphics){console.log('Get image data');}
var imagePixels=g2d.getImageData(0,0,bi.width,bi.height);var pixelData=imagePixels.data;if(verboseLogGraphics){console.log('Recolour pixels');}
var i,r,g,b,a,p;var mr=0,mg=0,mb=0;var recolour;var shirtR=((shirtCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var shirtG=((shirtCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var shirtB=(shirtCol&0x000000ff)*PLAYER_GAMMA/255;var shortsR=((shortsCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var shortsG=((shortsCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var shortsB=(shortsCol&0x000000ff)*PLAYER_GAMMA/255;var socksR=((socksCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var socksG=((socksCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var socksB=(socksCol&0x000000ff)*PLAYER_GAMMA/255;var skinR=((skinCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var skinG=((skinCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var skinB=(skinCol&0x000000ff)*PLAYER_GAMMA/255;var hairR=((hairCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var hairG=((hairCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var hairB=(hairCol&0x000000ff)*PLAYER_GAMMA/255;for(i=0;i<pixelData.length;i+=4){a=pixelData[i+3]
if(a===0){continue;}
r=pixelData[i]
g=pixelData[i+1]
b=pixelData[i+2]
recolour=false;if(b>0&&r==0&&g==0){mr=shortsR;mg=shortsG;mb=shortsB;r=b;g=b;recolour=true;}
else if(r>0&&g==0&&b==0){mr=shirtR;mg=shirtG;mb=shirtB;g=r;b=r;recolour=true;}
else if(g>0&&r==0&&b==0){mr=socksR;mg=socksG;mb=socksB;r=g;b=g;recolour=true;}
else if(r>0&&r==g&&b==0){mr=skinR;mg=skinG;mb=skinB;g=r;b=r;recolour=true;}
else if(r>0&&r==b&&g==0){mr=hairR;mg=hairG;mb=hairB;g=r;b=r;recolour=true;}
if(recolour){r=Math.round(mr*r);g=Math.round(mg*g);b=Math.round(mb*b);pixelData[i]=r;pixelData[i+1]=g;pixelData[i+2]=b;}}
if(verboseLogGraphics){console.log('Put image data');}
g2d.putImageData(imagePixels,0,0);if(verboseLogGraphics){console.log('Image recolouring complete');}
return bi;},setHockeyPlayerColours:function(image,shirtCol,shortsCol){if(verboseLogGraphics){console.log('Creating canvas for recolouring');}
var bi=new CanvasImage(image.width,image.height);var g2d=bi.getContext2d();if(verboseLogGraphics){console.log('Copy image');}
g2d.drawImage(image.data,0,0);if(verboseLogGraphics){console.log('Get image data');}
var imagePixels=g2d.getImageData(0,0,bi.width,bi.height);var pixelData=imagePixels.data;if(verboseLogGraphics){console.log('Recolour pixels');}
var i,r,g,b,a,p;var mr=0,mg=0,mb=0;var recolour;var shirtR=((shirtCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var shirtG=((shirtCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var shirtB=(shirtCol&0x000000ff)*PLAYER_GAMMA/255;var shortsR=((shortsCol&0x00ff0000)>>16)*PLAYER_GAMMA/255;var shortsG=((shortsCol&0x0000ff00)>>8)*PLAYER_GAMMA/255;var shortsB=(shortsCol&0x000000ff)*PLAYER_GAMMA/255;for(i=0;i<pixelData.length;i+=4){a=pixelData[i+3]
if(a===0){continue;}
r=pixelData[i]
g=pixelData[i+1]
b=pixelData[i+2]
recolour=false;if(b>0&&r==0&&g==0){mr=shirtR;mg=shirtG;mb=shirtB;r=b;g=b;recolour=true;}
else if(r>0&&g==0&&b==0){mr=shortsR;mg=shortsG;mb=shortsB;g=r;b=r;recolour=true;}
if(recolour){r=Math.round(mr*r);g=Math.round(mg*g);b=Math.round(mb*b);pixelData[i]=r;pixelData[i+1]=g;pixelData[i+2]=b;}}
if(verboseLogGraphics){console.log('Put image data');}
g2d.putImageData(imagePixels,0,0);if(verboseLogGraphics){console.log('Image recolouring complete');}
return bi;}}});

// lib/game/reality/global-constants.js
ig.baked=true;ig.module('game.reality.global-constants').requires('impact.game').defines(function(){MatchStatus={BA_NORMAL:0,BA_WALL:1,BA_HOLD:2,BA_DOWN:3,BA_HOLD_THROWIN:4,BA_THROWIN:5,BA_LEFT_FOOT_SHOT_FWD:6,BA_LEFT_FOOT_SHOT_BACK:7,BA_LEFT_FOOT_SHOT_RIGHT:8,BA_LEFT_FOOT_SHOT_LEFT:9,BA_RIGHT_FOOT_SHOT_FWD:10,BA_RIGHT_FOOT_SHOT_BACK:11,BA_RIGHT_FOOT_SHOT_RIGHT:12,BA_RIGHT_FOOT_SHOT_LEFT:13,BA_LEFT_FOOT_PASS_FWD:14,BA_LEFT_FOOT_PASS_BACK:15,BA_LEFT_FOOT_PASS_RIGHT:16,BA_LEFT_FOOT_PASS_LEFT:17,BA_RIGHT_FOOT_PASS_FWD:18,BA_RIGHT_FOOT_PASS_BACK:19,BA_RIGHT_FOOT_PASS_RIGHT:20,BA_RIGHT_FOOT_PASS_LEFT:21,BA_PICK_UP_BALL:22,BA_DROP_BALL:23,BA_HEADER:24,BA_TRIP:25,BA_CELEBRATE:26,BA_GK_READY:27,BA_GK_ACRO_LEFT:28,BA_GK_ACRO_LEFT_HOLD:29,BA_GK_ACRO_RIGHT:30,BA_GK_ACRO_RIGHT_HOLD:31,BA_GK_SIDESTEP_LEFT:32,BA_GK_SIDESTEP_RIGHT:33,BA_GK_KICK:34,BA_GK_THROW_BALL:35,BA_GK_STRETCH_LEFT:36,BA_GK_STRETCH_LEFT_HOLD:37,BA_GK_STRETCH_RIGHT:38,BA_GK_STRETCH_RIGHT_HOLD:39,BA_BALL_OWNER:40,BA_TACKLE:41,BA_SLIDING_TACKLE:42,BA_SLIDING_TACKLE_STAND:43,BA_MAX:44,};ArtworkScaling={PLAYER_SCALE:0.32,GOALPOSTS_SCALE:0.5,BALL_SCALE:0.13,PLAYER_NUMBER_OFFSET_Y:5.0,PLAYER_NUMBER_OFFSET_Y_HOCKEY:10,};EventType={EVENT_UNKNOWN:0,EVENT_GOAL:1,EVENT_KICKOFF:2,EVENT_CORNER:3,EVENT_FREE_KICK:4,EVENT_WHISTLE:5,EVENT_RED_CARD:6,EVENT_YELLOW_CARD:7,EVENT_SEC_YELLOW:8,EVENT_INJURY:9,EVENT_PENALTY_DECISION:10,EVENT_OWN_GOAL:11,EVENT_PENALTY:12,};XmlExventTypeStringConversion={'GOAL':EventType.EVENT_GOAL,'KICKOFF':EventType.EVENT_KICKOFF,'CORNER':EventType.EVENT_CORNER,'FREEKICK':EventType.EVENT_FREE_KICK,'WHISTLE':EventType.EVENT_WHISTLE,'REDCARD':EventType.EVENT_RED_CARD,'YELLOWCARD':EventType.EVENT_YELLOW_CARD,'SECONDYELLOW':EventType.EVENT_SEC_YELLOW,'INJURY':EventType.EVENT_INJURY,'PENALTYDECISION':EventType.EVENT_PENALTY_DECISION,'OWNGOAL':EventType.EVENT_OWN_GOAL,'PENALTY':EventType.EVENT_PENALTY,StringToEventType:function(typeString){return this[typeString.toUpperCase()]||EventType.EVENT_UNKNOWN;}};IntroState={SCROLL_ON:1,PAUSE:2,PLAYERS_MOVE:3,SCROLL_OFF:4,},HudTiming={SQUAD_SCROLL_ON_TIME:1000,SQUAD_SCROLL_PAUSE_TIME:1000,SQUAD_SCROLL_OFF_TIME:750,SQUAD_SCROLL_OFF_PAUSE:500,},ViewerFonts={Testing:{fullName:'18px Verdana',heightPixels:18},Regular:{fullName:'12px Helvetica',heightPixels:12},Large:{fulleName:'bold 16px Helvetica',heightPixels:16},};});

// lib/game/reality/event.js
ig.baked=true;ig.module('game.reality.event').requires('impact.game','game.reality.global-constants').defines(function(){EventAtTime=ig.Class.extend({init:function(owner,eventType,frame,duration,time,endFrame){this.m_owner=owner;this.m_frame=frame;this.m_duration=duration;this.m_time=time;this.m_endFrame=endFrame;if(typeof eventType==='string'||eventType instanceof String){this.m_description=eventType;this.m_eventType=XmlExventTypeStringConversion.StringToEventType(eventType);}
else{this.m_description='';this.m_eventType=eventType;}},resetDurationAndTime:function(duration,time){this.m_duration=duration;this.m_time=time;},getFrame:function(){return this.m_frame;},getEndFrame:function(){return this.m_endFrame;},getEventType:function(){return this.m_eventType;},getOwner:function(){return this.m_owner;},getDuration:function(){return this.m_duration;},setDuration:function(duration){this.m_duration=duration;},getTime:function(){return this.m_time;},toString:function(){return'Event '+this.m_eventType+' ('+this.m_description+'), frame:'+this.m_frame+', realworldTime: '+this.m_time+', dur: '+this.m_duration;},});SortedEventList=ig.Class.extend({init:function(){this._data=[];},getLength:function(){return this._data.length;},at:function(idx){return this._data[idx];},addSorted:function(e){this._data.splice(this.indexToInsertByFrame(e.getFrame()),0,e)},clear:function(){this._data=[];},remove:function(e){this._data.splice(this._data.indexOf(e),1);},indexToInsertByFrame:function(frameNumber){var idx;for(idx=0;idx<this._data.length;++idx){if(this._data[idx].getFrame()>frameNumber){return idx;}}
return this._data.length;},});});

// lib/game/reality/position.js
ig.baked=true;ig.module('game.reality.position').requires('impact.game').defines(function(){Position=ig.Class.extend({m_iF:0,m_niF:2,m_disableDirection:false,m_initialised:false,init:function(){this.m_tX=this.m_tY=this.m_tZ=this.m_tD=this.m_tStickD=0;this.m_cX=this.m_cY=this.m_cZ=this.m_cD=this.m_cStickD=0;this.m_pX=this.m_pY=this.m_pZ=this.m_pD=this.m_pStickD=0;this.m_sX=this.m_sY=this.m_sZ=this.m_sD=this.m_sStickD=0;this.m_iF=this.m_niF;},setNumIframes:function(iF){this.m_niF=iF;this.m_iF=this.m_niF;this.m_cX=this.m_tX;this.m_cY=this.m_tY;this.m_cZ=this.m_tZ;this.m_cStickD=this.m_tStickD;if(!this.m_disableDirection){this.m_cD=this.m_tD;}},getNumIframes:function(){return this.m_niF;},uninitialise:function(){this.m_initialised=false;this.m_iF=this.m_niF;},updateStep:function(){if(this.m_iF>=this.m_niF)
return;this.m_pX=this.m_cX;this.m_pY=this.m_cY;this.m_pZ=this.m_cZ;if(!this.m_disableDirection){this.m_pD=this.m_cD;this.m_cD+=this.m_sD;this.m_cD=this.m_cD%256;this.m_pStickD=this.m_cStickD;this.m_cStickD+=this.m_sStickD;this.m_cStickD=this.m_cStickD%256;}
this.m_cX+=this.m_sX;this.m_cY+=this.m_sY;this.m_cZ+=this.m_sZ;this.m_iF++;},setPD:function(pD){this.m_pD=pD;},setCD:function(cD){this.m_cD=cD;},getCX:function(){return this.m_cX;},getCY:function(){return this.m_cY;},getCZ:function(){return this.m_cZ;},getCD:function(){return this.m_cD;},getCStickD:function(){return this.m_cStickD;},getPX:function(){return this.m_pX;},getPY:function(){return this.m_pY;},getPZ:function(){return this.m_pZ;},getPD:function(){return this.m_pD;},getPStickD:function(){return this.m_pStickD;},getTX:function(){return this.m_tX;},getTY:function(){return this.m_tY;},getTZ:function(){return this.m_tZ;},getTD:function(){return this.m_tD;},getTStickD:function(){return this.m_tStickD;},needNewTargetPosition:function(){return this.m_iF>=this.m_niF;},setTargetPosition:function(x,y,z,d,stickD){this.m_disableDirection=false;d=d||0;if(this.m_initialised){this.m_iF=0;}else{this.m_tX=x;this.m_tY=y;this.m_tZ=z;this.m_tD=d;this.m_tStickD=stickD;this.m_initialised=true;this.m_iF=this.m_niF;}
this.m_pX=this.m_cX=this.m_tX;this.m_pY=this.m_cY=this.m_tY;this.m_pZ=this.m_cZ=this.m_tZ;this.m_pD=this.m_cD=this.m_tD;this.m_pStickD=this.m_cStickD=this.m_tStickD;this.m_tX=x;this.m_tY=y;this.m_tZ=z;this.m_tD=d;this.m_tStickD=stickD;this.m_sX=(this.m_tX-this.m_pX)/this.m_niF;this.m_sY=(this.m_tY-this.m_pY)/this.m_niF;this.m_sZ=(this.m_tZ-this.m_pZ)/this.m_niF;var diff=this.m_tD-this.m_pD;diff=(diff+256)%256;if(diff>128){diff-=256;}
this.m_sD=diff/this.m_niF;var diff=this.m_tStickD-this.m_pStickD;diff=(diff+256)%256;if(diff>128){diff-=256;}
this.m_sStickD=diff/this.m_niF;},});});

// lib/game/reality/actor.js
ig.baked=true;ig.module('game.reality.actor').requires('impact.game','game.reality.event','game.reality.position').defines(function(){Actor=Position.extend({m_name:null,init:function(name){this.parent();this.m_name=name;this.m_events=new SortedEventList();this.m_nextEventIdx=0;},getName:function(){return this.m_name;},getActiveEvent:function(frameNo,rewind){var eventToTrigger;if(!rewind){if(this.m_nextEventIdx<this.m_events.getLength()){eventToTrigger=this.m_events.at(this.m_nextEventIdx);if(eventToTrigger.getFrame()<=frameNo){++this.m_nextEventIdx;return eventToTrigger;}}}
else{if(this.m_nextEventIdx>0){eventToTrigger=this.m_events.at(this.m_nextEventIdx-1);if(eventToTrigger.getFrame()>=frameNo){--this.m_nextEventIdx;return eventToTrigger;}}}},getNextEvent:function(){if(this.m_nextEventIdx<this.m_events.getLength()){return this.m_events.at(this.m_nextEventIdx);}},addEvent:function(e){this.m_events.addSorted(e);},});});

// lib/game/reality/ball.js
ig.baked=true;ig.module('game.reality.ball').requires('impact.game','game.reality.actor').defines(function(){Ball=Actor.extend({m_frame:0,init:function(){this.parent("Ball");},update:function(){this.updateStep();var diffX=this.getCX()-this.getPX();var diffY=this.getCY()-this.getPY();var dist=Math.floor(Math.sqrt(diffX*diffX+diffY*diffY)*4.0);if(this.getPZ()==this.getCZ()&&this.getCZ()>0){dist=0;}
var v=(Math.atan2(diffY,diffX)+Math.PI)/2.0;this.setPD(this.getCD());this.setCD((v*81.48733)+128);this.m_frame+=dist;},getFrame:function(){return this.m_frame;}});});

// lib/game/graphics/anim.js
ig.baked=true;ig.module('game.graphics.anim').requires('impact.game').defines(function(){AnimCommands={CMD_FLAG:0x40,PAUSE_FOREVER:-1,FRAME_INVISIBLE:0x3f,DATA_SIZE:4,};AnimCommands.CMD_FREEZE=1|AnimCommands.CMD_FLAG;AnimCommands.CMD_GOTO=2|AnimCommands.CMD_FLAG;AnimCommands.CMD_LOOP=3|AnimCommands.CMD_FLAG;AnimCommands.CMD_PAUSE=4|AnimCommands.CMD_FLAG;AnimCommands.CMD_RESOURCE=5|AnimCommands.CMD_FLAG;AnimCommands.CMD_SETVAR=6|AnimCommands.CMD_FLAG;AnimCommands.CMD_CLRVAR=7|AnimCommands.CMD_FLAG;Anim=ig.Class.extend({m_animId:0,m_animPlaybackHead:0,m_pause:0,m_frame:0,m_resource:null,init:function(animationCommandStream){var i;this.m_msg=new Array(AnimCommands.DATA_SIZE);for(i=0;i<this.m_msg.length;++i){this.m_msg[i]=0;}
this.animations=animationCommandStream;},animations:null,resources:null,update:function(){if(this.m_pause==AnimCommands.PAUSE_FOREVER){return;}
else if(this.m_pause>0){this.m_pause--;return;}
var animation=this.animations[this.m_animId];var command=animation[this.m_animPlaybackHead++];while((command&AnimCommands.CMD_FLAG)!=0){switch(command){case AnimCommands.CMD_FREEZE:this.m_pause=AnimCommands.PAUSE_FOREVER;return;case AnimCommands.CMD_GOTO:this.setAnimation(animation[this.m_animPlaybackHead++]);return;case AnimCommands.CMD_LOOP:this.setAnimation(this.m_animId);return;case AnimCommands.CMD_PAUSE:this.m_pause=animation[this.m_animPlaybackHead++];this.update();return;case AnimCommands.CMD_RESOURCE:this.m_resource=this.resources[animation[this.m_animPlaybackHead++]];break;case AnimCommands.CMD_SETVAR:this.m_msg[animation[this.m_animPlaybackHead++]]=animation[this.m_animPlaybackHead++];break;case AnimCommands.CMD_CLRVAR:this.m_msg[animation[this.m_animPlaybackHead++]]=0;break;}
command=animation[this.m_animPlaybackHead++];}
this.setFrameNumber(command);},setFrameNumber:function(frameNumber){if(AnimCommands.FRAME_INVISIBLE!=frameNumber){if(this.m_resource){this.m_resource.gotoFrame(frameNumber);}}
this.m_frame=frameNumber;},setAnimation:function(animId){this.m_animId=animId;this.m_animPlaybackHead=0;this.m_pause=0;this.update();},});});

// lib/game/reality/player.js
ig.baked=true;ig.module('game.reality.player').requires('impact.game','game.graphics.anim','game.reality.actor','game.reality.global-constants').defines(function(){var ANIM_NONE=0;var ANIM_STAND=1;var ANIM_RUN=2;var ANIM_DRIBBLE=3;var ANIM_PASS_LEFT=4;var ANIM_PASS_RIGHT=5;var ANIM_SHOOT_LEFT=6;var ANIM_SHOOT_RIGHT=7;var ANIM_SLIDE=8;var ANIM_GET_UP=9;var ANIM_TACKLE=10;var ANIM_HEADER=11;var ANIM_TRIP=12;var ANIM_FALL=13;var ANIM_GK_STRAFE_LEFT=14;var ANIM_GK_STRAFE_RIGHT=15;var ANIM_GK_READY=16;var ANIM_GK_STAND=17;var ANIM_GK_DIVE_LEFT=18;var ANIM_GK_DIVE_RIGHT=19;var ANIM_GK_DIVE_LEFT_BALL=20;var ANIM_GK_DIVE_RIGHT_BALL=21;var ANIM_GK_SAVE_LEFT=22;var ANIM_GK_SAVE_RIGHT=23;var ANIM_GK_SAVE_LEFT_BALL=24;var ANIM_GK_SAVE_RIGHT_BALL=25;var ANIM_GK_KICK_HANDS=26;var ANIM_CELEBRATE=27;var ANIM_VAR_BALL_STATUS=0;var MSG_HOLDING_BALL=1;var MSG_RELEASE_BALL=2;PlayerRESOURCE={STAND:0,RUN:1,PASS_LEFT:2,PASS_RIGHT:3,SHOOT_LEFT:4,SHOOT_RIGHT:5,SLIDE:6,TACKLE:7,HEADER:8,FALL:9,STRAFE:10,SAVE_LEFT:11,SAVE_RIGHT:12,KICK_HANDS:13,STAND_BALL:14,RUN_BALL:15,MAX:16,};var PlayerAnimationScripts=[[AnimCommands.FRAME_INVISIBLE,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.STAND,0,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.RUN,3,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.RUN,3,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.PASS_LEFT,0,0,0,1,1,1,2,2,2,2,2,3,3,3,4,4,4,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.PASS_RIGHT,0,0,0,1,1,1,2,2,2,2,2,3,3,3,4,4,4,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SHOOT_LEFT,0,0,1,1,2,2,3,3,3,3,4,4,4,5,5,5,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SHOOT_RIGHT,0,0,1,1,2,2,3,3,3,3,4,4,4,5,5,5,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SLIDE,0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,4,4,4,4,4,4,4,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SLIDE,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10,11,11,11,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.TACKLE,0,0,0,1,1,1,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.HEADER,0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,4,4,4,4,5,5,5,6,6,6,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.FALL,0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.FALL,0,0,0,1,1,1,7,7,7,8,AnimCommands.CMD_PAUSE,24,9,9,9,10,10,10,4,4,4,5,5,5,6,6,6,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.STRAFE,1,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.STRAFE,3,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.STRAFE,0,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.STAND,0,AnimCommands.CMD_FREEZE],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_LEFT,0,1,3,4,4,4,10,11,12,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_RIGHT,0,1,3,4,4,4,10,11,12,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_LEFT,0,0,0,1,1,1,3,3,3,4,4,4,4,4,4,4,4,6,6,6,7,7,7,8,8,8,9,9,9,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_RIGHT,0,0,0,1,1,1,3,3,3,4,4,4,4,4,4,4,4,6,6,6,7,7,7,8,8,8,9,9,9,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_LEFT,0,0,0,1,1,1,1,1,1,0,0,0,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_RIGHT,0,0,0,1,1,1,1,1,1,0,0,0,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_LEFT,0,0,0,1,1,1,1,1,1,2,2,2,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SAVE_RIGHT,0,0,0,1,1,1,1,1,1,2,2,2,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.KICK_HANDS,0,0,0,AnimCommands.CMD_RESOURCE,PlayerRESOURCE.SHOOT_RIGHT,3,3,3,3,4,4,4,5,5,5,AnimCommands.CMD_GOTO,ANIM_STAND],[AnimCommands.CMD_RESOURCE,PlayerRESOURCE.HEADER,0,0,0,1,1,1,2,2,2,2,2,2,3,3,3,5,5,5,6,6,6,0,0,0,1,1,1,2,2,2,2,2,2,3,3,3,5,5,5,6,6,6,0,0,0,1,1,1,2,2,2,2,2,2,3,3,3,5,5,5,6,6,6,0,0,0,1,1,1,2,2,2,2,2,2,3,3,3,5,5,5,6,6,6,AnimCommands.CMD_GOTO,ANIM_STAND],];Player=Actor.extend({m_isKeeper:false,m_onPitch:false,m_side:false,isDown:false,m_status:-1,m_requestedAnimId:ANIM_NONE,m_processedAnimId:ANIM_NONE,m_resources:new Array(PlayerRESOURCE.MAX),FRAME_RUN_COUNT:16,FRAME_RUN_STAND1:3,FRAME_RUN_STAND2:11,SPEED_MAX:16.0,SPEED_TO_FRAMES:3.0,RUN_SPEED_START:0.6,RUN_SPEED_END:0.2,DRIBBLE_SPEED_MIN:0.2,FRAME_STRAFE_COUNT:4,m_distanceRun:0,init:function(id,name,side,shirtNo,teamId){this.parent(name);this.m_id=id;this.m_side=side;this.m_shirtNo=shirtNo;this.m_teamId=teamId;this.m_animData=new Anim(PlayerAnimationScripts);this.m_animData.resources=this.m_resources;this.setAnimation(ANIM_NONE);},resetAnimation:function(){this.setAnimation(ANIM_STAND);},update:function(animationRate){var i,j,frame,step;if(this.m_requestedAnimId!=this.m_processedAnimId){if(this.m_status!=MatchStatus.BA_NORMAL||this.canAnimChangeToNormal()){this.setAnimation(this.m_requestedAnimId);if(!this.m_animData.m_resource){this.m_requestedAnimId=ANIM_STAND;this.setAnimation(this.m_requestedAnimId);}
this.m_processedAnimId=this.m_requestedAnimId;}}
var diffX=this.getTX()-this.getPX();var diffY=this.getTY()-this.getPY();var speed=Math.sqrt(diffX*diffX+diffY*diffY);if(speed>this.SPEED_MAX){speed=this.SPEED_MAX;}
speed/=this.SPEED_TO_FRAMES;this.m_distanceRun+=speed/this.getNumIframes();var runFrames=0;var runFramesMod=0;if(animationRate!=0){step=Math.floor(this.m_distanceRun);this.m_distanceRun-=step;runFramesMod=step/animationRate;}
for(i=animationRate;i>0;--i){if(this.m_animData.m_animId==ANIM_STAND&&speed>this.RUN_SPEED_START){this.setAnimation(ANIM_RUN);}
switch(this.m_animData.m_animId){case ANIM_RUN:frame=this.m_animData.m_frame;if(speed>this.RUN_SPEED_END){runFrames+=runFramesMod;step=Math.floor(runFrames);runFrames-=step;frame+=Math.floor(step);while(frame>=this.FRAME_RUN_COUNT)
frame-=this.FRAME_RUN_COUNT;}
else{if(frame==this.FRAME_RUN_STAND1||frame==this.FRAME_RUN_STAND2){this.setAnimation(ANIM_STAND);break;}
else if(frame>this.FRAME_RUN_STAND1&&frame<this.FRAME_RUN_STAND2){if(frame<(this.FRAME_RUN_STAND1+3))
frame++;else if(frame!=(this.FRAME_RUN_STAND2-1))
frame=this.FRAME_RUN_STAND2-1;else
frame=this.FRAME_RUN_STAND2;}
else{if(frame<(this.FRAME_RUN_STAND2+3))
frame++;else if(frame!=(this.FRAME_RUN_STAND1-1))
frame=this.FRAME_RUN_STAND1-1;else
frame=this.FRAME_RUN_STAND1;}}
this.m_animData.setFrameNumber(frame);break;case ANIM_DRIBBLE:frame=this.m_animData.m_frame;if(speed>this.DRIBBLE_SPEED_MIN){runFrames+=runFramesMod;step=Math.floor(runFrames);runFrames-=step;for(j=step;j>0;--j){if(frame>this.FRAME_RUN_STAND1&&frame<this.FRAME_RUN_STAND2){if(frame<(this.FRAME_RUN_STAND1+3)){frame++;}else if(frame!=(this.FRAME_RUN_STAND2-1)){frame=this.FRAME_RUN_STAND2-1;}else{frame=this.FRAME_RUN_STAND2;}}
else{if(frame<(this.FRAME_RUN_STAND2+3)){frame++;}else if(frame!=(this.FRAME_RUN_STAND1-1)){frame=this.FRAME_RUN_STAND1-1;}else{frame=this.FRAME_RUN_STAND1;}}}}
else{if(frame==this.FRAME_RUN_STAND1||frame==this.FRAME_RUN_STAND2){break;}
else if(frame>this.FRAME_RUN_STAND1&&frame<this.FRAME_RUN_STAND2){if(frame<(this.FRAME_RUN_STAND1+3))
frame++;else if(frame!=(this.FRAME_RUN_STAND2-1))
frame=this.FRAME_RUN_STAND2-1;else
frame=this.FRAME_RUN_STAND2;}
else{if(frame<(this.FRAME_RUN_STAND2+3))
frame++;else if(frame!=(this.FRAME_RUN_STAND1-1))
frame=this.FRAME_RUN_STAND1-1;else
frame=this.FRAME_RUN_STAND1;}}
this.m_animData.setFrameNumber(frame);break;case ANIM_GK_STRAFE_RIGHT:frame=this.m_animData.m_frame;runFrames+=runFramesMod;step=Math.floor(runFrames);runFrames-=step;frame+=step;while(frame>=this.FRAME_STRAFE_COUNT){frame-=this.FRAME_STRAFE_COUNT;}
this.m_animData.setFrameNumber(frame);break;case ANIM_GK_STRAFE_LEFT:frame=this.m_animData.m_frame;runFrames+=runFramesMod;step=Math.floor(runFrames);runFrames-=step;frame-=step;while(frame<0)
frame+=this.FRAME_STRAFE_COUNT;this.m_animData.setFrameNumber(frame);break;default:this.updateAnimation();}}
this.updateStep();},updateAnimation:function(){this.m_animData.update();},setAnimation:function(animId){this.m_animData.setAnimation(animId);},getAnimData:function(){return this.m_animData;},getFrame:function(){return this.m_animData.m_frame;},getCurrentResource:function(){return this.m_animData.m_resource;},getResource:function(resourceType){return this.m_resources[resourceType];},setResource:function(resourceType,resource){this.m_resources[resourceType]=resource;},getStatus:function(){return this.m_status;},setStatus:function(status)
{if(status!=this.m_status){this.m_status=status;this.selectAnimFromStatus();}},isKeeper:function(){return this.m_isKeeper;},setKeeper:function(isKeeper){this.m_isKeeper=isKeeper;},setOnPitch:function(b){this.m_onPitch=b;},isOnPitch:function(){return this.m_onPitch;},getSide:function(){return this.m_side;},getShirtNo:function(){return this.m_shirtNo;},getTeamId:function(){return this.m_teamId;},getId:function(){return this.m_id;},getHairColor:function(){return this.m_hairColor;},setHairColor:function(color){this.m_hairColor=color;},getSkinColor:function(){return this.m_skinColor;},setSkinColor:function(color){this.m_skinColor=color;},selectAnimFromStatus:function(){switch(this.m_status){case MatchStatus.BA_NORMAL:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_WALL:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_HOLD:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_DOWN:this.m_requestedAnimId=ANIM_FALL;break;case MatchStatus.BA_HOLD_THROWIN:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_THROWIN:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_LEFT_FOOT_SHOT_FWD:case MatchStatus.BA_LEFT_FOOT_SHOT_BACK:case MatchStatus.BA_LEFT_FOOT_SHOT_RIGHT:case MatchStatus.BA_LEFT_FOOT_SHOT_LEFT:this.m_requestedAnimId=ANIM_SHOOT_LEFT;break;case MatchStatus.BA_RIGHT_FOOT_SHOT_FWD:case MatchStatus.BA_RIGHT_FOOT_SHOT_BACK:case MatchStatus.BA_RIGHT_FOOT_SHOT_RIGHT:case MatchStatus.BA_RIGHT_FOOT_SHOT_LEFT:this.m_requestedAnimId=ANIM_SHOOT_RIGHT;break;case MatchStatus.BA_LEFT_FOOT_PASS_FWD:case MatchStatus.BA_LEFT_FOOT_PASS_BACK:case MatchStatus.BA_LEFT_FOOT_PASS_RIGHT:case MatchStatus.BA_LEFT_FOOT_PASS_LEFT:this.m_requestedAnimId=ANIM_PASS_LEFT;break;case MatchStatus.BA_RIGHT_FOOT_PASS_FWD:case MatchStatus.BA_RIGHT_FOOT_PASS_BACK:case MatchStatus.BA_RIGHT_FOOT_PASS_RIGHT:case MatchStatus.BA_RIGHT_FOOT_PASS_LEFT:this.m_requestedAnimId=ANIM_PASS_RIGHT;break;case MatchStatus.BA_PICK_UP_BALL:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_DROP_BALL:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_HEADER:this.m_requestedAnimId=ANIM_HEADER;break;case MatchStatus.BA_TRIP:this.m_requestedAnimId=ANIM_TRIP;break;case MatchStatus.BA_CELEBRATE:this.m_requestedAnimId=ANIM_CELEBRATE;break;case MatchStatus.BA_GK_READY:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_ACRO_LEFT:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_ACRO_LEFT_HOLD:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_ACRO_RIGHT:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_ACRO_RIGHT_HOLD:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_SIDESTEP_LEFT:this.m_requestedAnimId=ANIM_GK_STAND;break;case MatchStatus.BA_GK_SIDESTEP_RIGHT:this.m_requestedAnimId=ANIM_GK_STAND;break;case MatchStatus.BA_GK_KICK:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_THROW_BALL:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_STRETCH_LEFT:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_STRETCH_LEFT_HOLD:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_STRETCH_RIGHT:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_GK_STRETCH_RIGHT_HOLD:this.m_requestedAnimId=ANIM_STAND;break;case MatchStatus.BA_BALL_OWNER:this.m_requestedAnimId=ANIM_DRIBBLE;break;case MatchStatus.BA_TACKLE:this.m_requestedAnimId=ANIM_TACKLE;break;case MatchStatus.BA_SLIDING_TACKLE:this.m_requestedAnimId=ANIM_SLIDE;break;case MatchStatus.BA_SLIDING_TACKLE_STAND:this.m_requestedAnimId=ANIM_GET_UP;break;default:this.m_requestedAnimId=ANIM_STAND;break;}},canAnimChangeToNormal:function(){switch(this.m_animData.m_animId){case ANIM_NONE:case ANIM_STAND:case ANIM_RUN:case ANIM_DRIBBLE:case ANIM_GK_STRAFE_LEFT:case ANIM_GK_STRAFE_RIGHT:case ANIM_GK_READY:return true;default:return false;}},});});

// lib/game/reality/hockeyPlayer.js
ig.baked=true;ig.module('game.reality.hockeyPlayer').requires('impact.game','game.reality.actor','game.reality.global-constants').defines(function(){HockeyPlayer=Actor.extend({m_shirtNo:0,m_id:0,m_teamId:0,m_info:0,m_onField:0,m_currAnim:0,m_currFrame:0,m_side:false,m_isDown:0,m_stick:0,last_dist:0,tot_dist:0,anim_move:0,isOnPitch:function(){return true;},init:function(id,name,side,shirtNo,teamId){this.parent(name);this.m_side=side;this.m_info=null;this.m_onField=false;this.m_currAnim=0;this.m_currFrame=0;this.m_isDown=true;this.last_dist=0;this.anim_move=0;this.m_id=id;this.m_shirtNo=shirtNo;this.m_teamId=teamId;},update:function(animationRate){this.animate(animationRate);this.updateStep();},animate:function(animationRate){var n=this.getTX()-this.getPX();var n2=this.getTY()-this.getPY();var n3=Math.floor(Math.sqrt(n*n+n2*n2)/2.0);var last_dist=Math.sqrt(n*n+n2*n2);var n4=last_dist-this.last_dist;this.tot_dist+=last_dist;this.last_dist=last_dist;var n5=4;if(last_dist<0.5){if(this.m_currFrame!=0){this.anim_move=0;}}
else if(n4>-0.5&&n4<0.5){this.anim_move++;}
else if(n4>0.0){this.anim_move+=3.0;}
this.m_currFrame=Math.floor(this.anim_move/n5)%8;},isKeeper:function(){return false;},setOnPitch:function(b){this.m_onPitch=b;},isOnPitch:function(val){if(val!=undefined){this.m_onPitch=val;return;}
return this.m_onPitch;},getSide:function(){return this.m_side;},getShirtNo:function(){return this.m_shirtNo;},getTeamId:function(){return this.m_teamId;},getId:function(){return this.m_id;},getFrame:function(){return this.m_currFrame;}});});

// lib/game/reality/referee.js
ig.baked=true;ig.module('game.reality.referee').requires('impact.game','game.reality.actor').defines(function(){Referee=Actor.extend({init:function(){this.parent("Referee");},});});

// lib/game/reality/team.js
ig.baked=true;ig.module('game.reality.team').requires('impact.game').defines(function(){Team=ig.Class.extend({m_goals:0,m_players:new Array(),m_halfTimeStats:{},m_fullTimeStats:{},init:function(id,name,shortName,side,tactics,aggression,playstyle){this.m_teamId=id;this.m_name=name;this.m_shortName=shortName;this.m_side=side;this.m_tactics=tactics;this.m_aggression=aggression;this.m_playstyle=playstyle;},setShirtColor:function(shirtPriRgb,shirtPriGoalieRgb){this.m_shirtPriColor=parseInt(shirtPriRgb,16);this.m_shirtPriGoalieColor=parseInt(shirtPriGoalieRgb,16);},setShortsColor:function(shortsPriRgb,shortsPriGoalieRgb){this.m_shortsPriColor=parseInt(shortsPriRgb,16);this.m_shortsPriGoalieColor=parseInt(shortsPriGoalieRgb,16);},setSocksColor:function(socksPriRgb,socksPriGoalieRgb){this.m_socksPriColor=parseInt(socksPriRgb,16);this.m_socksPriGoalieColor=parseInt(socksPriGoalieRgb,16);},setHalfTimeStats:function(stats){this.m_halfTimeStats=stats;},getHalfTimeStats:function(){return this.m_halfTimeStats;},setFullTimeStats:function(stats){this.m_fullTimeStats=stats;},getFullTimeStats:function(){return this.m_fullTimeStats;},addGoal:function(){this.m_goals+=1;},subtractGoal:function(){this.m_goals-=1;},getGoals:function(){return this.m_goals;},setGoals:function(g){this.m_goals=g;},getId:function(){return this.m_teamId;},getName:function(){return this.m_name;},getShortname:function(){return this.m_shortName;},getSide:function(){return this.m_side;},getAggression:function(){return this.m_aggression;},getTactics:function(){return this.m_tactics;},getPlayStyle:function(){return this.m_playstyle;},addPlayer:function(p){this.m_players.push(p);},getNumPlayers:function(){return this.m_players.length;},getPlayerByIndex:function(index){return this.m_players[index];},getPlayerByPlayerId:function(pId){for(var idx=0;idx<this.m_players.length;++idx){if(this.m_players[idx].getId()==pId){return this.m_players[idx];}}
return null;}});});

// lib/game/reality/match.js
ig.baked=true;ig.module('game.reality.match').requires('impact.game','game.graphics.graphics-loader','game.reality.ball','game.reality.global-constants','game.reality.player','game.reality.hockeyPlayer','game.reality.referee','game.reality.team').defines(function(){var verboseLogXmlParse=false;var PITCH_TUNNEL_POSITION_X=760;var MAX_HOCKEY_FRAMES=10000;Match=ig.Class.extend({m_teams:new Array(2),m_referee:null,m_matchId:0,m_currFrame:0,m_clock:0,m_animationRate:1,m_ball:null,m_rewind:false,matchBuffer:null,m_statusPrefetchTable:[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,4,4,0,0,],init:function(){this.m_ball=new Ball();this.m_referee=new Referee();},getSecsPerFrame:function(){return(this.m_secsPerFrame)?this.m_secsPerFrame:0.6666667;},getDate:function(){return this.m_date;},getBall:function(){return this.m_ball;},setHomeTeam:function(homeTeam){this.m_teams[0]=homeTeam;},getHomeTeam:function(){return this.m_teams[0];},setAwayTeam:function(awayTeam){this.m_teams[1]=awayTeam;},getAwayTeam:function(){return this.m_teams[1];},getTeamById:function(teamId){if(this.m_teams[0].getId()===teamId){return this.m_teams[0];}
else{return this.m_teams[1];}},getReferee:function(){return this.m_referee;},getStadiumCapacity:function(){return this.m_stadiumCapacity;},getAttendance:function(){return this.m_attendance;},setRewindState:function(state){this.m_rewind=state;},getRewindState:function(){return this.m_rewind;},setCurrentFrame:function(frame){if(frame<0){this.m_currFrame=0;}
else if(frame>=this.m_ftFrame){this.m_currFrame=this.m_ftFrame-1;}
else{this.m_currFrame=frame;}
if(frame==0&&ig.game.gameType=='hockey'){ig.game.mzlive.m_gameSound.SOUND_AUDIENCE_HOCKEY_INTRO.play();}
this.m_ball.uninitialise();for(idxTeam=0;idxTeam<2;++idxTeam){team=this.m_teams[idxTeam];numPlayers=team.getNumPlayers();for(i=0;i<numPlayers;i++){p=team.getPlayerByIndex(i);p.uninitialise();if(ig.game.gameType!='hockey'){p.resetAnimation();}
if(frame==0){p.m_nextEventIdx=0;}}}
this.nextFrame();},getCurrentFrame:function(){return(this.m_currFrame<0)?0:this.m_currFrame;},getMatchTime:function(){return this.m_clock;},getMatchTimeHockey:function(){return Math.floor(this.m_clock%1200);},getPeriodHockey:function(){return Math.floor(this.m_clock/1200)+1;},getHTFrame:function(){return this.m_htFrame;},getKO2Frame:function(){return this.m_ko2Frame;},getKOFrame:function(){return this.m_koFrame;},getFTFrame:function(){return this.m_ftFrame;},getAnimationRate:function(){return this.m_animationRate;},nextFrame:function(){var i,idxTeam;if(!this.m_ball.needNewTargetPosition()){return;}
if(this.m_currFrame==this.m_ftFrame&&!this.m_rewind){return;}
if(this.m_currFrame<=this.m_koFrame&&this.m_rewind){return;}
var mframe=this.matchBuffer[this.m_currFrame];if(!this.m_rewind){this.m_currFrame++;}
else{if(this.matchBuffer[this.m_currFrame-1]!==undefined){this.m_currFrame--;}}
if(mframe==undefined){return;}
this.m_ball.setTargetPosition(mframe.ball.x,mframe.ball.y,mframe.ball.z);this.m_clock=mframe.clock;for(idxTeam=0;idxTeam<2;++idxTeam){var team=this.m_teams[idxTeam];var numPlayers=team.getNumPlayers();for(i=0;i<numPlayers;i++){p=team.getPlayerByIndex(i);p.setOnPitch(false);}}
for(i=0;i<this.m_numActors;++i){var pframe=mframe.players[i];var id=pframe.id;if(id==0){continue;}
var status=pframe.status;var x=pframe.position.x;var y=pframe.position.y;if(ig.game.gameType=='hockey'){var s=pframe.position.stickD;}
var d=pframe.position.z;var stickD=pframe.position.stickD;if(ig.game.gameType!='hockey'&&x==-1){continue;}
var p=this.getHomeTeam().getPlayerByPlayerId(id);if(p==null){p=this.getAwayTeam().getPlayerByPlayerId(id);}
if(ig.game.gameType=='hockey'){p.isDown=pframe.position.isDown;}
p.setTargetPosition(x,y,0,d,stickD);p.isOnPitch(pframe.onField);if(ig.game.gameType!='hockey'){p.setStatus(status);if((this.m_currFrame>this.m_htFrame&&this.m_currFrame<this.m_ko2Frame)&&this.x>PITCH_TUNNEL_POSITION_X){continue;}
p.setOnPitch(true);}}},setInterpolationRate:function(rate){var numPlayers,i,idxTeam,team,p;if(rate<1){rate=1;}
m_animationTimer=0;m_animationRatePrecise=3.0/rate;this.m_ball.setNumIframes(rate);for(idxTeam=0;idxTeam<2;++idxTeam){team=this.m_teams[idxTeam];numPlayers=team.getNumPlayers();for(i=0;i<numPlayers;i++){p=team.getPlayerByIndex(i);p.setNumIframes(rate);}}},setMatchStream:function(matchStream){var matchId=matchStream.readInt();this.m_numActors=matchStream.readInt();this.m_secsPerFrame=matchStream.readFloat();if(verboseLogXmlParse){console.log(ig.game.gameType+'\matchId: '+this.m_matchId+'\nm_numActors: '+this.m_numActors+'\nm_secsPerFrame: '+this.m_secsPerFrame);}
this.m_currFrame=0;var lastStatus=-1;if(ig.game.gameType=='soccer'){this.matchBuffer=new Array(this.m_ftFrame);for(var frameNo=0;frameNo<this.m_ftFrame;++frameNo){var mframe={};this.matchBuffer[frameNo]=mframe;mframe.clock=matchStream.readInt();var ballX=matchStream.readShort();var ballY=matchStream.readShort();var ballZ=matchStream.readShort();mframe.ball={x:ballX,y:ballY,z:ballZ};mframe.players=new Array(this.m_numActors);for(var i=0;i<this.m_numActors;++i){var pframe={};mframe.players[i]=pframe;pframe.id=matchStream.readUnsignedChar();var status=matchStream.readUnsignedChar();var playerX=matchStream.readShort();var playerY=matchStream.readShort();var playerD=matchStream.readUnsignedChar();if(pframe.id==0){continue;}
pframe.status=status;pframe.position={x:playerX,y:playerY,z:playerD};if(status!=lastStatus){lastStatus=status;var prefetch=this.m_statusPrefetchTable[status];if(prefetch!=0){var prefetchFrameNo=frameNo-prefetch;if(prefetchFrameNo<0)
prefetchFrameNo=0;for(;prefetchFrameNo<frameNo;++prefetchFrameNo){pframe=this.matchBuffer[prefetchFrameNo].players[i];pframe.status=status;}}}}}}
else{this.m_ftFrame=0;this.matchBuffer=new Array(MAX_HOCKEY_FRAMES);var runningPenalties=[2];runningPenalties[0]=[];runningPenalties[1]=[];for(var frameNo=0;frameNo<MAX_HOCKEY_FRAMES;++frameNo){if(matchStream.index>=matchStream.m_dstream.byteLength)
{break;}
this.m_ftFrame++;var mframe={penalties:[2]};mframe.penalties[0]=[];mframe.penalties[1]=[];this.matchBuffer[frameNo]=mframe;mframe.clock=matchStream.readShort();var ballX=matchStream.readShort();var ballY=matchStream.readShort();var ballZ=matchStream.readShort();mframe.ball={x:ballX,y:ballY,z:ballZ};mframe.players=new Array(this.m_numActors);for(var i=0;i<this.m_numActors;++i){var pframe={};mframe.players[i]=pframe;pframe.id=matchStream.readUnsignedChar();var status=matchStream.readUnsignedChar();var playerX=matchStream.readShort();var playerY=matchStream.readShort();var playerD=matchStream.readUnsignedChar()+128;var stickD=matchStream.readUnsignedChar();var isDown=false;if(stickD==255){isDown=true;}
if(pframe.id==0){pframe.onField=false;}
else{pframe.onField=true;pframe.status=status;pframe.position={x:playerX,y:playerY,z:playerD,stickD:stickD+128,isDown:isDown};if(status!=lastStatus){lastStatus=status;var prefetch=this.m_statusPrefetchTable[status];if(prefetch!=0){var prefetchFrameNo=frameNo-prefetch;if(prefetchFrameNo<0){prefetchFrameNo=0;}
for(;prefetchFrameNo<frameNo;++prefetchFrameNo){pframe=this.matchBuffer[prefetchFrameNo].players[i];pframe.status=status;}}}}
var p=this.getHomeTeam().getPlayerByPlayerId(pframe.id);var tid=0;if(p==null){tid=1;p=this.getAwayTeam().getPlayerByPlayerId(pframe.id);}
if(p!=null){var e=p.getActiveEvent(frameNo,false);if(e!=null&&e.getEventType()==EventType.EVENT_PENALTY){runningPenalties[tid].push({duration:121,endFrame:e.getEndFrame(),startTime:(mframe.clock)});}}}
for(var teamIdx=0;teamIdx<2;teamIdx++){for(var p=0;p<runningPenalties[teamIdx].length;){var ptime=runningPenalties[teamIdx][p].startTime+runningPenalties[teamIdx][p].duration-mframe.clock;if(ptime>120){ptime=120;}
if(ptime>0&&this.m_ftFrame<runningPenalties[teamIdx][p].endFrame){mframe.penalties[teamIdx].push({time:ptime});p++;}
else{runningPenalties[teamIdx].splice(p,1);}}}}}
for(teamIndex=0;teamIndex<2;++teamIndex){var numPlayers=this.m_teams[teamIndex].getNumPlayers();var i,e;for(i=0;i<numPlayers;i++){var p=this.m_teams[teamIndex].getPlayerByIndex(i);p.m_nextEventIdx=0;}}
if(verboseLogXmlParse){console.log('parsed '+this.m_ftFrame+' frames from binary data stream');}},parseRmsDate:function(dateString){var inIsoFormat=dateString.replace(' ','T');return new Date(inIsoFormat);},setMatchXml:function(doc){var docRoot=doc.documentElement;var getSingleNode=function(xpath){return docRoot.evaluate(xpath).singleNodeValue();}
var getNodeIterator=function(xpath,startNode){startNode=startNode||docRoot;return startNode.evaluate(xpath);}
this.m_matchId=docRoot.getAttribute('matchId');if(docRoot.tagName=='HockeyStatistics'){ig.game.gameType='hockey';}
else if(docRoot.tagName=='SoccerStatistics'){ig.game.gameType='soccer';}
var nl;this.m_date=this.parseRmsDate(docRoot.getAttribute('date'));this.m_koFrame=0;nl=getNodeIterator('Periods/*');var p;while(p=nl.iterateNext()){if(p.getAttribute('name')=='half1'){this.m_koFrame=this.timeToFrame(p.getAttribute('start'));this.m_htFrame=this.timeToFrame(p.getAttribute('end'));}
if(p.getAttribute('name')=='half2'){this.m_ko2Frame=this.timeToFrame(p.getAttribute('start'));this.m_ftFrame=this.timeToFrame(p.getAttribute('end'));}
if(p.getAttribute('name')=='extra1'||p.getAttribute('name')=='extra2'){this.m_ftFrame=this.timeToFrame(p.getAttribute('end'));}}
var s;s=getSingleNode('Stadium');if(s){var maxSeats=parseInt(s.getAttribute('maxSeats'));var maxStands=parseInt(s.getAttribute('maxStands'));var maxVips=parseInt(s.getAttribute('maxVips'));var stand=parseInt(s.getAttribute('stand'));var sit=parseInt(s.getAttribute('sit'));var vip=parseInt(s.getAttribute('vip'));this.m_stadiumCapacity=maxSeats+maxStands+maxVips;this.m_attendance=stand+sit+vip;}
nl=getNodeIterator('Team');var s;while(s=nl.iterateNext()){if(ig.game.gameType=='soccer'){var teamId=s.getAttribute('id');if(teamId.indexOf('home')!==-1||teamId.indexOf('away')!==-1){teamId=teamId.replace('home','');teamId=teamId.replace('away','');}
teamId=parseInt(teamId);}
else{var teamId=parseInt(s.getAttribute('id'));}
var name=s.getAttribute('name');var shortName=s.getAttribute('shortname');var tactics=s.getAttribute('tactic');var aggression=s.getAttribute('aggression');var playstyle=s.getAttribute('playstyle');var visiting=s.getAttribute('visiting');var side=visiting==0?'home':'away';var t=new Team(teamId,name,shortName,side,tactics,aggression,playstyle);if(visiting==0){this.setHomeTeam(t);}else{this.setAwayTeam(t);}
t.setShirtColor(s.getAttribute('shirtPriRgb'),s.getAttribute('shirtPriRgbGoalie'));t.setShortsColor(s.getAttribute('shortsPriRgb'),s.getAttribute('shortsPriRgbGoalie'));t.setSocksColor(s.getAttribute('socksPriRgb'),s.getAttribute('socksPriRgbGoalie'));var statsNodes=getNodeIterator('child::*',s);var teamStats;while(teamStats=statsNodes.iterateNext()){var goals=parseInt(teamStats.getAttribute('goals'));var freekicks=parseInt(teamStats.getAttribute('freekicks'));var offsides=parseInt(teamStats.getAttribute('offsides'));var corners=parseInt(teamStats.getAttribute('corners'));var throwins=parseInt(teamStats.getAttribute('throwins'));var penaltyshots=parseInt(teamStats.getAttribute('penaltyshots'));var saves=parseInt(teamStats.getAttribute('saves'));var yellowCards=parseInt(teamStats.getAttribute('yellowCards'));var redCards=parseInt(teamStats.getAttribute('redCards'));var injuries=parseInt(teamStats.getAttribute('injuries'));var shotsOnGoal=parseInt(teamStats.getAttribute('shotsOnGoal'));var shotsWide=parseInt(teamStats.getAttribute('shotsWide'));var interceptedPasses=parseInt(teamStats.getAttribute('interceptedPasses'));var goodPasses=parseInt(teamStats.getAttribute('goodPasses'));var oobPasses=parseInt(teamStats.getAttribute('oobPasses'));var tacklesWon=parseInt(teamStats.getAttribute('tacklesWon'));var tacklesLost=parseInt(teamStats.getAttribute('tacklesLost'));var possession=parseInt(teamStats.getAttribute('possession'));var substitutions=parseInt(teamStats.getAttribute('substitutions'));var shots=shotsOnGoal+shotsWide;var passes=interceptedPasses+goodPasses+oobPasses;if(ig.game.gameType=='hockey'){var statsArr={goals:goals,};}
else{var statsArr={goals:goals,shots:shots,shotsOnTarget:shotsOnGoal,possession:possession,tackles:tacklesWon+tacklesLost,yellowCards:yellowCards,redCards:redCards,injuries:injuries,corners:corners,shotAccuracy:Math.round(shotsOnGoal/shots*100),passAccuracy:Math.round(goodPasses/passes*100),};}
if(teamStats.tagName=="HalfStatistics"){t.setHalfTimeStats(statsArr);}
else{t.setFullTimeStats(statsArr);}}}
if((this.getHomeTeam()==null)||(this.getAwayTeam()==null)){throw"One or both teams missing";}
if(verboseLogXmlParse){console.log('Teams loaded');}
var events,e;events=getNodeIterator('Referee/*');while(re=events.iterateNext()){if(verboseLogXmlParse){console.log('Ref event tag='+re.tagName+' frame='+re.getAttribute('frame'));}
e=new EventAtTime(this.m_referee,re.tagName,parseInt(re.getAttribute('frame')),0,0,0);this.m_referee.addEvent(e);}
nl=getNodeIterator('Player');while(s=nl.iterateNext()){var playerId=parseInt(s.getAttribute('internalId'));var name=s.getAttribute('name');var shirtNo=parseInt(s.getAttribute('shirtno'));if(ig.game.gameType=='hockey'){var teamId=parseInt(s.getAttribute("teamId"));if(this.getHomeTeam().getId()==teamId){var p=new HockeyPlayer(playerId,name,'home',shirtNo,teamId);this.getHomeTeam().addPlayer(p);}
else{var p=new HockeyPlayer(playerId,name,'away',shirtNo,teamId);this.getAwayTeam().addPlayer(p);}}
else{var keeper=s.getAttribute('goalkeeper');var hairColour=parseInt(s.getAttribute('hair_color'),16);var skinColour=parseInt(s.getAttribute('skin_color'),16);var teamId=s.getAttribute("teamId");var selfchallenge=false;var side=false;if(teamId.indexOf('home')!==-1){teamId=teamId.replace('home','');side='home';selfchallenge=true;}
else if(teamId.indexOf('away')!==-1){teamId=teamId.replace('away','');side='away';selfchallenge=true;}
teamId=parseInt(teamId);if((!selfchallenge&&this.getHomeTeam().getId()==teamId)||(selfchallenge&&side=='home')){var p=new Player(playerId,name,'home',shirtNo,teamId);this.getHomeTeam().addPlayer(p);}
else{var p=new Player(playerId,name,'away',shirtNo,teamId);this.getAwayTeam().addPlayer(p);}
p.setHairColor(hairColour);p.setSkinColor(skinColour);if(keeper==1){p.setKeeper(true);}}
if(verboseLogXmlParse){console.log('Added player '+name+' (id '+playerId+')');}
events=getNodeIterator('child::*',s);var pe;while(pe=events.iterateNext()){var en=this.eventTypeFromXmlEventNode(pe);if((en!='Statistics')&&(en!='item')){var frameNo=0;if(pe.getAttribute("frame")){frameNo=parseInt(pe.getAttribute("frame"));}
else if(pe.getAttribute("time")){frameNo=this.timeToFrame(pe.getAttribute("time"));}
var duration=0;if(pe.getAttribute("duration")){duration=this.timeToFrame(pe.getAttribute("duration"));}
var endFrame=0;if(pe.getAttribute("endframe")){endFrame=parseInt(pe.getAttribute("endframe"));}
e=new EventAtTime(p,en,frameNo,duration,0,endFrame);p.addEvent(e);if(verboseLogXmlParse){console.log('\tEvent: '+en+' '+frameNo);}}}}
if(verboseLogXmlParse){console.log('Players loaded');}},eventTypeFromXmlEventNode:function(xmlEventNode){var tagName=xmlEventNode.tagName;if(tagName=='Card'){switch(xmlEventNode.getAttribute('type')){case'red':return'RedCard';case'yellow':return'YellowCard';case'second yellow':return'SecondYellow';}}
if(tagName=='Goal'){switch(xmlEventNode.getAttribute('type')){case'own goal':return'OwnGoal';default:return tagName;}}
return tagName;},timeToFrame:function(timeToParse){var seconds=0;try{var colonIdx=timeToParse.indexOf(":");var minute=parseInt(timeToParse.substring(0,colonIdx),10);var second=parseFloat(timeToParse.substring(colonIdx+1),10);seconds=(minute*60)+second;}
catch(e){console.log('Error converting '+time+' to frame number '+e.message);}
return Math.round(seconds/this.getSecsPerFrame());},frameToMatchMinute:function(frame){return Math.ceil(frame*this.m_secsPerFrame/60);},});});

// lib/game/reality/match-loader.js
ig.baked=true;ig.module('game.reality.match-loader').requires('impact.game','game.common.dom-node-text-adapter','game.reality.reality-match-stream','game.reality.match').defines(function(){MatchLoader=ig.Class.extend({matchStream:null,matchXml:null,match:null,init:function(newBinUrl,newXmlUrl){this.xmlUrl=newXmlUrl;this.binUrl=newBinUrl;},loadStatsXmlAsync:function(nextFunction,errorFunction){var matchLoaderInstance=this;var xhr=new XMLHttpRequest();xhr.open('GET',matchLoaderInstance.xmlUrl,true);xhr.responseType='text';xhr.onload=function(e){if(this.status==200){var fixedstring;matchLoaderInstance.matchXml=new DomNodeTextAdapter(this.response);nextFunction();}
else{errorFunction('status '+this.status+' downloading match XML')}}
xhr.send();return true;},processLoadedStatsXml:function(nextFunction,errorFunction){this.match.setMatchXml(this.matchXml);nextFunction();},loadMatchStreamAsync:function(nextFunction,errorFunction){var matchLoaderInstance=this;var xhr=new XMLHttpRequest();xhr.open('GET',matchLoaderInstance.binUrl,true);xhr.responseType='arraybuffer';xhr.onload=function(e){if(this.status==200){matchLoaderInstance.matchStream=new RealityMatchStream(this.response);nextFunction();}
else{errorFunction('status '+this.status+' downloading RealityMatchStream')}}
xhr.send();return true;},processLoadedMatchStream:function(nextFunction,errorFunction){this.match.setMatchStream(this.matchStream);nextFunction();},queueTasks:function(loaderQueue){this.match=new Match();var matchLoaderInstance=this;loaderQueue.queueTask(this.loadStatsXmlAsync.bind(this),'Loading XML data file');loaderQueue.queueNonCallbackTask(this.processLoadedStatsXml.bind(this),'Processing XML data file');loaderQueue.queueTask(this.loadMatchStreamAsync.bind(this),'Loading Binary data file');loaderQueue.queueNonCallbackTask(this.processLoadedMatchStream.bind(this),'Processing Binary data file');}});});

// lib/game/mzlive.js
ig.baked=true;ig.module('game.mzlive').requires('impact.game','impact.font','game.common.loader-queue','game.reality.reality-match-stream','game.reality.match-loader').defines(function(){var PLAYBACK_TURBO_LOOP=10;var STATE_INIT=0;var STATE_LOADING=1;var STATE_INTRO=2;var STATE_PRE_FIRST_HALF=3;var STATE_FIRST_HALF=4;var STATE_HALF_TIME=5;var STATE_SECOND_HALF=6;var STATE_FULL_TIME=7;var STATE_EXIT=8;var INTERPOLATION_RATES=[0,1,1.25,1.667,2,2.5,3.333,4,5,6.667,10];Mzlive=ig.Class.extend({m_gameSound:{SOUND_WHISTLE:new ig.Sound(mz.base_path+'media/whistle.*'),SOUND_AUDIENCE_HOCKEY_INTRO:new ig.Sound(mz.base_path+'media/hockey_audio/audience_1.*'),SOUND_AUDIENCE_3:new ig.Sound(mz.base_path+'media/audience_3.*'),SOUND_AUDIENCE_1:new ig.Sound(mz.base_path+'media/audience_1.*'),SOUND_AUDIENCE_2:new ig.Sound(mz.base_path+'media/audience_2.*'),SOUND_AUDIENCE_GOAL:new ig.Sound(mz.base_path+'media/Goal1.*'),SOUND_STICK_HIT:new ig.Sound(mz.base_path+'media/hockey_audio/shot.*'),SOUND_KICK:new ig.Sound(mz.base_path+'media/kick.*'),},m_lastSound:0,m_lastSoundFrame:0,m_masterVolume:1,m_displayNumbers:true,m_pause:false,m_slowmoState:false,m_match:null,m_gameTime:0,reinitialize:false,controlsTimerIntro:true,controlsVisible:true,setControlsVisible:null,buttonPressed:false,buttonImagesCamera:new ig.Image(mz.base_path+'media/ViewerButtons/camera_sheet.png'),buttonImagesPlusMinus:new ig.Image(mz.base_path+'media/ViewerButtons/plus_minus_sheet.png'),buttonImagesToggleSheet:new ig.Image(mz.base_path+'media/ViewerButtons/toggle_sheet.png'),buttonImagesHelp:new ig.Image(mz.base_path+'media/ViewerButtons/help.png'),buttonImagesRestart:new ig.Image(mz.base_path+'media/ViewerButtons/restart_match.png'),buttonImagesFullscreen:new ig.Image(mz.base_path+'media/ViewerButtons/fullscreen.png'),buttonImagesPause:new ig.Image(mz.base_path+'media/ViewerButtons/pause.png'),buttonImagesSpeedControl:new ig.Image(mz.base_path+'media/ViewerButtons/speed_control.png'),buttonImagesClose:new ig.Image(mz.base_path+'media/ViewerButtons/close.png'),buttonImagesToggleRotateScreen:new ig.Image(mz.base_path+'media/ViewerButtons/rotate_screen.png'),init:function(){this.m_state=STATE_INIT;this.m_defaultInterpolationIndex=8;this.m_interpolationRateChanged=true;this.m_interpolationIndex=this.m_defaultInterpolationIndex;this.m_rewindStateChanged=false;this.m_rewind=false;this.m_crowdSoundArray=[this.m_gameSound.SOUND_AUDIENCE_1,this.m_gameSound.SOUND_AUDIENCE_2,this.m_gameSound.SOUND_AUDIENCE_3];if(ig.ua.mobile){ig.Sound.enabled=false;}
var _this=this;$("body").on("click touchend","#canvas",function(e){if(ig.game.mzlive.buttonPressed){ig.game.mzlive.buttonPressed=false;return;}
_this.toggleViewControls();});},finalInitAfterLoading:function(){if(this.reinitialize){this.reinitialize=false;this.controlsTimerIntro=true;this.controlsVisible=true;this.setControlsVisible=null;this.buttonPressed=false;this.m_state=STATE_INIT;this.m_defaultInterpolationIndex=8;this.m_interpolationRateChanged=true;this.m_interpolationIndex=this.m_defaultInterpolationIndex;this.m_rewindStateChanged=false;this.m_rewind=false;}
ig.soundManager.volume=this.m_masterVolume;var topMargin=(ig.ua.mobile)?40:0;var bottomMargin=(ig.ua.mobile)?20:0;this.buttonRewindSpeedControl=new ig.TouchButton('RewindSpeedControl',{left:10,bottom:0+bottomMargin},48,48,this.buttonImagesSpeedControl,2,3,'highlight');this.buttonPause=new ig.TouchButton('Pause',{left:60,bottom:0+bottomMargin},48,48,this.buttonImagesPause,2,3,'highlight');this.buttonPlay=new ig.TouchButton('Play',{left:110,bottom:0+bottomMargin},48,48,this.buttonImagesPause,0,1,'highlight');this.buttonForwardSpeedControl=new ig.TouchButton('ForwardSpeedControl',{left:160,bottom:0+bottomMargin},48,48,this.buttonImagesSpeedControl,0,1,'highlight');this.buttonCameraMode=new ig.TouchButton('CycleCamera',{right:0,bottom:0+bottomMargin},48,48,this.buttonImagesCamera,0,1,'highlight');this.buttonToggleNumbers=new ig.TouchButton('ToggleNumbers',{right:50,bottom:0+bottomMargin},48,48,this.buttonImagesToggleSheet,0,1,'highlight');this.buttonRestartMatch=new ig.TouchButton('RestartMatch',{right:100,bottom:0+bottomMargin},48,48,this.buttonImagesRestart,0,1,'highlight');ig.input.bind(ig.KEY.SUBSTRACT,'FramerateSlower');ig.input.bind(ig.KEY.ADD,'FramerateFaster');ig.input.bind(ig.KEY.SPACE,'SkipIntro');ig.input.bind(ig.KEY.B,'Rewind');ig.input.bind(ig.KEY.C,'CycleCamera');ig.input.bind(ig.KEY.H,'ToggleHelp');ig.input.bind(ig.KEY.N,'ToggleNumbers');ig.input.bind(ig.KEY.P,'TogglePause');ig.input.bind(ig.KEY.R,'RestartMatch');ig.input.bind(ig.KEY.S,'ToggleSound');ig.input.bind(ig.KEY.V,'ToggleRotateScreen');this.UpdateButtonImages();window.myTouchButtons=new ig.TouchButtonCollection([]);window.myTouchButtons.buttons.push(this.buttonRewindSpeedControl);window.myTouchButtons.buttons.push(this.buttonPause);window.myTouchButtons.buttons.push(this.buttonPlay);window.myTouchButtons.buttons.push(this.buttonForwardSpeedControl);window.myTouchButtons.buttons.push(this.buttonCameraMode);window.myTouchButtons.buttons.push(this.buttonToggleNumbers);window.myTouchButtons.buttons.push(this.buttonRestartMatch);this.buttonToggleClose=new ig.TouchButton('close',{right:0,top:10+topMargin},48,48,this.buttonImagesClose,0,1,'highlight');window.myTouchButtons.buttons.push(this.buttonToggleClose);this.buttonToggleRotateScreen=new ig.TouchButton('ToggleRotateScreen',{right:0,top:60+topMargin},48,48,this.buttonImagesToggleRotateScreen,0,1,'highlight');window.myTouchButtons.buttons.push(this.buttonToggleRotateScreen);if(!ig.ua.mobile){this.buttonToggleHelp=new ig.TouchButton('ToggleHelp',{right:50,top:10+topMargin},48,48,this.buttonImagesHelp,0,1,'highlight');window.myTouchButtons.buttons.push(this.buttonToggleHelp);}
if(ig.ua.mobile&&window.fullScreenApi.supportsFullScreen){this.buttonToggleFullscreen=new ig.TouchButton('ToggleFullscreen',{left:this.m_ms.m_screenDimension.width/2-24,bottom:this.m_ms.m_screenDimension.height/2-24},48,48,this.buttonImagesFullscreen,0,1,'highlight');window.myTouchButtons.buttons.push(this.buttonToggleFullscreen);}
window.myTouchButtons.align();if(ig.game.gameType=='hockey'){this.m_gameSound.SOUND_KICK=this.m_gameSound.SOUND_STICK_HIT;this.m_gameSound.SOUND_KICK.volume=.25;}
if(ig.game.gameType=='hockey'){this.m_gameSound.SOUND_AUDIENCE_1.play();this.m_gameSound.SOUND_AUDIENCE_HOCKEY_INTRO.volume=.35;this.m_gameSound.SOUND_AUDIENCE_HOCKEY_INTRO.play();this.m_match.setCurrentFrame(0);}
else{this.m_gameSound.SOUND_AUDIENCE_1.play();}
this.m_lastSound=1;this.m_lastSoundFrame=0;this.m_gameTime=0;this.m_lastFrameRealworldTime=null;this.m_state=STATE_INTRO;this.m_skipPressed=false;this.m_pause=false;this.m_ms.initIntro();},UpdateButtonImages:function(){if(!window.myTouchButtons){return;}
if(this.setControlsVisible===null&&window.myTouchButtons.buttons[0].enabled===false){return;}
if(this.setControlsVisible!==null){switch(this.setControlsVisible){case true:window.myTouchButtons.show();break;case false:window.myTouchButtons.hide();break;}
this.setControlsVisible=null;}
this.buttonCameraMode.tile=2*this.m_ms.getCameraMode();this.buttonCameraMode.highlightTile=this.buttonCameraMode.tile+1;this.buttonToggleNumbers.tile=this.m_displayNumbers?2:0;this.buttonToggleNumbers.highlightTile=this.buttonToggleNumbers.tile+1;this.buttonRewindSpeedControl.tile=this.m_slowmoState?6:2;this.buttonRewindSpeedControl.highlightTile=this.buttonRewindSpeedControl.tile+1;this.buttonForwardSpeedControl.tile=this.m_slowmoState?4:0;this.buttonForwardSpeedControl.highlightTile=this.buttonForwardSpeedControl.tile+1;if(ig.game.view=="portrait"||mz.getMobileHeight(true)<500){this.buttonToggleRotateScreen.enabled=false;}
this.buttonToggleRotateScreen.tile=ig.game.forcedView=="portrait"?0:2;if(this.buttonToggleFullscreen){this.buttonToggleFullscreen.tile=window.fullScreenApi.isFullScreen()?2:0;this.buttonToggleFullscreen.highlightTile=this.buttonToggleFullscreen.tile+1;}},update:function(){this.processButtonPresses();var currentFrameRealworldTime=new Date().getTime();var frameElapsedRealWorldTime;if(this.m_lastFrameRealworldTime){frameElapsedRealWorldTime=currentFrameRealworldTime-this.m_lastFrameRealworldTime;}
else{frameElapsedRealWorldTime=0;}
this.m_lastFrameRealworldTime=currentFrameRealworldTime;if(!this.m_pause){this.m_gameTime+=frameElapsedRealWorldTime;}
if(this.m_interpolationRateChanged){this.m_interpolationRateChanged=false;this.m_interpolationRate=INTERPOLATION_RATES[this.m_interpolationIndex];this.m_match.setInterpolationRate(this.m_interpolationRate);this.m_ms.resetGameSpeedNotification(this.getGameTime());}
if(this.m_rewindStateChanged){this.m_rewindStateChanged=false;this.m_match.setRewindState(this.m_rewind);if(this.m_rewind){this.m_ms.clearEvents();}}
var loop=(this.m_interpolationRate===0)?PLAYBACK_TURBO_LOOP:1;if(this.m_pause){loop=0;}
while(loop-->0){switch(this.m_state){case STATE_INTRO:if(this.m_ms.updateIntro()){if(this.m_match.getCurrentFrame()>=this.m_match.getKOFrame()-1)
this.m_state=STATE_FIRST_HALF;else
this.m_state=STATE_PRE_FIRST_HALF;loop=0;}
break;case STATE_PRE_FIRST_HALF:this.m_ms.updateMatch();if(this.m_match.getCurrentFrame()>=this.m_match.getKOFrame()-1){this.m_state=STATE_FIRST_HALF;loop=0;}
break;case STATE_FIRST_HALF:case STATE_SECOND_HALF:if(this.m_ms.updateMatch()){if(!this.m_rewind){if(ig.game.gameType=='hockey'){this.m_state=STATE_FULL_TIME;}
else{if(this.m_state==STATE_FIRST_HALF){this.m_state=STATE_HALF_TIME;}
else{this.m_state=STATE_FULL_TIME;}}}
else{if(this.m_state==STATE_FIRST_HALF){this.togglePauseMatch();this.m_rewind=false;this.m_rewindStateChanged=true;}
else{this.m_state=STATE_HALF_TIME;}}
loop=0;}
break;case STATE_HALF_TIME:if(this.m_ms.updateHalfTime()){if(!this.m_rewind){this.m_state=STATE_SECOND_HALF;}
else{this.m_state=STATE_FIRST_HALF;}
loop=0;}
break;case STATE_FULL_TIME:if(!this.m_rewind){this.m_ms.updateFullTime();}
else{this.m_state=STATE_SECOND_HALF;loop=0;}
break;}}
switch(this.m_state){case STATE_FIRST_HALF:case STATE_SECOND_HALF:this.updateAudio();break;}},draw:function(){switch(this.m_state){case STATE_INTRO:this.m_ms.renderIntro();break;case STATE_PRE_FIRST_HALF:case STATE_FIRST_HALF:case STATE_SECOND_HALF:case STATE_HALF_TIME:case STATE_FULL_TIME:default:this.m_ms.renderFrame();break;}},toggleViewControls:function(){this.setControlsVisible=(this.controlsVisible)?false:true;},updateAudio:function(){if(this.m_pause){return;}
var cFrame=this.m_match.getCurrentFrame();if(cFrame-this.m_lastSoundFrame>50||this.m_lastSoundFrame==0){var r=Math.floor(Math.random()*32)-(cFrame&31);if(r===0){r=Math.floor(Math.random()*this.m_crowdSoundArray.length);if(r!=this.m_lastSound){this.m_crowdSoundArray[r].play();this.m_lastSound=r;this.m_lastSoundFrame=cFrame;}}}},stopAllAudio:function(){for(var key in this.m_gameSound){if(this.m_gameSound.hasOwnProperty(key)){this.m_gameSound[key].stop();}}
this.m_lastSoundFrame=0;},getDefaultInterpolationRate:function(){return INTERPOLATION_RATES[this.m_defaultInterpolationIndex];},togglePauseMatch:function(){this.m_pause=!this.m_pause;if(this.m_pause){this.stopAllAudio();}},toggleRewind:function(){this.m_rewind=!this.m_rewind;this.m_rewindStateChanged=true;},speedControl:function(){if(this.isPaused()){this.togglePauseMatch();}
if(!this.m_slowmoState){if(this.m_interpolationIndex>this.m_defaultInterpolationIndex){this.m_interpolationIndex=this.m_defaultInterpolationIndex;}
if(this.m_interpolationIndex>0){this.m_interpolationIndex--;this.m_interpolationRateChanged=true;}}
else{if(this.m_interpolationIndex<=this.m_defaultInterpolationIndex){this.m_interpolationIndex=INTERPOLATION_RATES.length-1;this.m_interpolationRateChanged=true;}
else if(this.m_interpolationIndex>this.m_defaultInterpolationIndex+1){this.m_interpolationIndex--;this.m_interpolationRateChanged=true;}}},isPlaying:function(){return(this.m_state===STATE_FIRST_HALF||this.m_state===STATE_SECOND_HALF);},isFirstHalf:function(){return(this.m_state==STATE_FIRST_HALF);},isHalfTime:function(){return(this.m_state==STATE_HALF_TIME);},isSecondHalf:function(){return(this.m_state==STATE_SECOND_HALF);},isFullTime:function(){return(this.m_state==STATE_FULL_TIME);},getGameTime:function(){return this.m_gameTime;},skipPressed:function(){return this.m_skipPressed;},isPaused:function(){return this.m_pause;},displayNumbers:function(){return this.m_displayNumbers;},processButtonPresses:function(){if(this.m_state<STATE_INTRO){return;}
if(ig.input.pressed('FramerateFaster')){if(this.m_interpolationIndex>0){this.m_interpolationIndex--;this.m_interpolationRateChanged=true;}
this.UpdateButtonImages();}
if(ig.input.pressed('FramerateSlower')){if(this.m_interpolationIndex<(INTERPOLATION_RATES.length-1)){this.m_interpolationIndex++;this.m_interpolationRateChanged=true;}
this.UpdateButtonImages();}
if(ig.input.pressed('ForwardSpeedControl')){if(this.m_rewind){this.toggleRewind();this.m_interpolationRateChanged=true;this.m_interpolationIndex=this.m_defaultInterpolationIndex;}
this.speedControl();this.UpdateButtonImages();}
if(ig.input.pressed('RewindSpeedControl')){if(!this.m_rewind){this.toggleRewind();if(!this.m_slowmoState){this.m_interpolationRateChanged=true;this.m_interpolationIndex=this.m_defaultInterpolationIndex;}
else{this.speedControl();}}
else{this.speedControl();}
this.UpdateButtonImages();}
if(ig.input.pressed('ToggleNumbers')){this.m_displayNumbers=!this.m_displayNumbers;this.UpdateButtonImages();}
if(ig.input.pressed('CycleCamera')){this.m_ms.nextCameraMode();this.UpdateButtonImages();}
if(ig.input.pressed('TogglePause')){this.togglePauseMatch();this.UpdateButtonImages();}
if(ig.input.pressed('Pause')){if(!this.isPaused()){this.togglePauseMatch();}
this.m_slowmoState=true;this.m_interpolationRateChanged=true;this.m_interpolationIndex=this.m_defaultInterpolationIndex;this.UpdateButtonImages();}
if(ig.input.pressed('Play')){if(this.isPaused()){this.togglePauseMatch();}
if(this.m_rewind){this.toggleRewind();}
this.m_slowmoState=false;this.m_interpolationRateChanged=true;this.m_interpolationIndex=this.m_defaultInterpolationIndex;this.UpdateButtonImages();}
if(ig.input.pressed('ToggleSound')){this.m_masterVolume=(this.m_masterVolume==1)?0:1;ig.soundManager.volume=this.m_masterVolume;if(this.m_masterVolume==0){this.stopAllAudio();}
this.UpdateButtonImages();}
if(ig.input.pressed('SkipIntro')){this.m_skipPressed=true;this.UpdateButtonImages();}
if(ig.input.pressed('RestartMatch')){this.stopAllAudio();if(this.m_rewind){this.toggleRewind();}
this.m_ms.clearEvents();this.m_match.getHomeTeam().setGoals(0);this.m_match.getAwayTeam().setGoals(0);this.m_match.setCurrentFrame(0);this.m_ms.cameraFocus();this.m_ms.updateCamera();this.m_gameSound.SOUND_AUDIENCE_1.play();this.m_lastSound=1;this.m_lastSoundFrame=0;this.m_state=STATE_INTRO;this.m_skipPressed=false;this.m_pause=false;this.m_ms.initIntro();this.UpdateButtonImages();}
if(ig.input.pressed('ToggleHelp')){this.m_ms.toggleHelp();if(this.m_ms.getHelpStatus()&&!this.isPaused()){this.togglePauseMatch();}
else if(!this.m_ms.getHelpStatus()&&this.isPaused()){this.togglePauseMatch();}
this.UpdateButtonImages();}
if(ig.input.pressed('Rewind')){this.toggleRewind();this.UpdateButtonImages();}
if(ig.input.pressed('ToggleRotateScreen')){if(ig.game.view=="landscape"&&ig.game.forcedView===null){ig.game.forcedView="portrait";}
else{ig.game.forcedView=null;}
$(window).trigger("resize");}
if(ig.input.pressed('close')){this.endGame();}},endGame:function(){if(!this.isPaused()){this.togglePauseMatch();}
this.reinitialize=true;mz.endMatch();}});});

// lib/game/render/hud.js
ig.baked=true;ig.module('game.render.hud').requires('impact.game','game.graphics.anim','game.graphics.graphics-loader','game.reality.event','game.reality.global-constants').defines(function(){var CLOCK_BG={x:4,y:4,width:42,height:34};var CLOCK_TEXT={x:3,y:1};var PERIOD_TEXT={x:14,y:16};var TEAM_TEXT_HOME_COLOUR='#ffffff';var TEAM_TEXT_HOME_COLOUR_HOCKEY='#007eff';var TEAM_TEXT_AWAY_COLOUR='#33ee00';var TEAM_TEXT_AWAY_COLOUR_HOCKEY='#c01701';var SCORE_WIDTH=27;var SCORE_10_WIDTH=SCORE_WIDTH+6;var SCORE_BG={x:49,y:4,width:0,height:34};var SCORE_TEAM1={x:52,y:5};var SCORE_TEAM2={x:52,y:19};var SCORE_GOALS_OFFSET=14;var EVENT_FLASH_DURATION=1000;var EVENT_FLASH_MASK=255;var EVENT_SCROLL_ON_TIME=300;var EVENT_SCROLL_OFF_TIME=800;var EVENT_SPACING=8;var EVENT_POSITION_X=4;var EVENT_POSITION_Y=42;var GAME_SPEED_DURATION=1000;var SQUAD_X=50;var SQUAD_NUMBERS_WIDTH=32;var SQUAD_TEAMS_HEIGHT=32;var SQUAD_TEAMS_HEIGHT_INNER=SQUAD_TEAMS_HEIGHT-3;var SQUAD_PLAYERS_WIDTH=208;var SQUAD_PLAYERS_HEIGHT_SOCCER=190;var SQUAD_PLAYERS_HEIGHT=260;var SQUAD_INSET_X=10;var SQUAD_INSET_Y=4;var SQUAD_TEAM_NAME_X=SQUAD_X+SQUAD_NUMBERS_WIDTH+SQUAD_INSET_X;var SQUAD_TEAM_NAME_Y_OFFSET=3;var SQUAD_PLAYER_SCALE=0.57;var SQUAD_BG_LIGHT='#505050';var SQUAD_BG_MEDIUM='#323232';var SQUAD_BG_DARK='#000000';HudAssets={iconYellowCard:new ig.Image(mz.base_path+'media/icon_yellow_card.png'),iconRedCard:new ig.Image(mz.base_path+'media/icon_red_card.png'),iconInjury:new ig.Image(mz.base_path+'media/icon_injury.png'),iconGoal:new ig.Image(mz.base_path+'media/icon_goal.png'),iconOwnGoal:new ig.Image(mz.base_path+'media/icon_own_goal.png'),iconGoalHockey:new ig.Image(mz.base_path+'media/icon_goal_hockey.png'),iconOwnGoalHockey:new ig.Image(mz.base_path+'media/icon_own_goal_hockey.png'),};Hud=ig.Class.extend({init:function(mzlive,ms,match,events,dimension){var i,team;this.m_mzLive=mzlive;this.m_mainScene=ms;this.m_match=match;this.m_activeEvents=events;this.m_screenDimension={width:ig.system.width,height:ig.system.height};g=ig.system.context;this.m_teamNameSize=new Array(2);g.font=ViewerFonts.Regular.fullName;for(i=0;i<2;++i){team=this.m_match.m_teams[i];this.m_teamNameSize[i]=g.measureText(team.getName());}
this.m_helpSectionTextArray=[["+",mz.translations["increaseSpeed"]],["-",mz.translations["decreaseSpeed"]],["Space",mz.translations["skipIntro"]],["B",mz.translations["toggleRewind"]],["C",mz.translations["changeCamera"]],["H",mz.translations["toggleHelp"]],["N",mz.translations["toggleNumbers"]],["P",mz.translations["togglePause"]],["R",mz.translations["restartMatch"]],["S",mz.translations["toggleSound"]],["V",mz.translations["rotateScreen"]]];if(ig.game.gameType=="soccer"){SQUAD_PLAYERS_HEIGHT=SQUAD_PLAYERS_HEIGHT_SOCCER;}
var _this=this;window.addEventListener("resize",function(){_this.m_screenDimension={width:ig.system.width,height:ig.system.height};});},renderCurrentSpeed:function(){var speedGameTime=this.m_mainScene.getGameSpeedNotificationTime();var gameTime=this.m_mzLive.getGameTime();var livedFor=gameTime-speedGameTime;if(livedFor>GAME_SPEED_DURATION){return;}
var defaultInterpolationRate=this.m_mzLive.getDefaultInterpolationRate();var currentInterpolationRate=(this.m_mzLive.m_interpolationRate>0)?this.m_mzLive.m_interpolationRate:0.1;var currentSpeed=Math.round((defaultInterpolationRate/currentInterpolationRate)*100)/100;g=ig.system.context
g.save();g.font=ViewerFonts.Testing.fullName;var text=currentSpeed+"x";if(this.m_match.getRewindState()){text="-"+text;}
var wordLength=g.measureText(text).width;var wordHeight=g.measureText(text).height;var width=wordLength+10;var height=28;var x=(ig.ua.mobile&&ig.game.view=="landscape")?25:16;var y=this.m_screenDimension.height-80-height;g.fillStyle='#000000';g.globalAlpha=0.5;g.fillRect(x,y,width,height);g.globalAlpha=1.0;g.textBaseline='middle';g.fillStyle='#ffffff';g.fillText(text,x+5,y+height/2);g.restore();},renderStats:function(type){var homeTeam,awayTeam,g;homeTeam=this.m_match.getHomeTeam();awayTeam=this.m_match.getAwayTeam();if(type=="halfTime"){homeTeamStats=homeTeam.getHalfTimeStats();awayTeamStats=awayTeam.getHalfTimeStats();}
else{homeTeamStats=homeTeam.getFullTimeStats();awayTeamStats=awayTeam.getFullTimeStats();}
g=ig.system.context
g.save();g.font=ViewerFonts.Testing.fullName;var yLineHeight=30;if(ig.ua.mobile){g.font=ViewerFonts.Regular.fullName;yLineHeight=15;}
if(ig.game.gameType=='hockey'){var wordsize;var longestWordLength=g.measureText(mz.translations[type]).width;for(var key in homeTeamStats){if(!homeTeamStats.hasOwnProperty(key)){continue;}
wordsize=g.measureText(mz.translations[key]);if(wordsize.width>longestWordLength){longestWordLength=wordsize.width;}}
var padding=10;var statsWidth=longestWordLength+150;var statsHeight=3*yLineHeight+10;var statsX=this.m_screenDimension.width/2-statsWidth/2;var statsY=(ig.ua.mobile)?5:this.m_screenDimension.height/2-statsHeight/2;g.fillStyle='#000000';g.globalAlpha=0.5;g.fillRect(statsX,statsY,statsWidth,statsHeight);g.globalAlpha=1.0;g.textBaseline='top';g.fillStyle='#ffffff';g.textAlign='center';g.fillText(mz.translations[type],this.m_screenDimension.width/2,statsY+5);g.textAlign='left';g.fillText(homeTeam.getShortname(),statsX+padding,statsY+yLineHeight+5);g.textAlign='center';g.fillText(homeTeamStats.goals+" - "+awayTeamStats.goals,this.m_screenDimension.width/2,statsY+yLineHeight+5);g.textAlign='right';g.fillText(awayTeam.getShortname(),statsX+statsWidth-padding,statsY+yLineHeight+5);}
else{var wordsize;var longestWordLength=g.measureText(mz.translations[type]).width;for(var key in homeTeamStats){if(!homeTeamStats.hasOwnProperty(key)){continue;}
wordsize=g.measureText(mz.translations[key]);if(wordsize.width>longestWordLength){longestWordLength=wordsize.width;}}
var padding=10;var statsWidth=longestWordLength+150;var statsHeight=13*yLineHeight+10;var statsX=this.m_screenDimension.width/2-statsWidth/2;var statsY=(ig.ua.mobile)?5:this.m_screenDimension.height/2-statsHeight/2;g.fillStyle='#000000';g.globalAlpha=0.5;g.fillRect(statsX,statsY,statsWidth,statsHeight);g.globalAlpha=1.0;g.textBaseline='top';g.fillStyle='#ffffff';g.textAlign='center';g.fillText(mz.translations[type],this.m_screenDimension.width/2,statsY+5);g.textAlign='left';g.fillText(homeTeam.getShortname(),statsX+padding,statsY+yLineHeight+5);g.textAlign='center';g.fillText(homeTeamStats.goals+" - "+awayTeamStats.goals,this.m_screenDimension.width/2,statsY+yLineHeight+5);g.textAlign='right';g.fillText(awayTeam.getShortname(),statsX+statsWidth-padding,statsY+yLineHeight+5);var yOffset=yLineHeight*2+5;var extra;var percentFields=["possession","shotAccuracy","passAccuracy"];for(var key in homeTeamStats){if(!homeTeamStats.hasOwnProperty(key)){continue;}
extra="";if(percentFields.indexOf(key)!=-1){extra="%";}
g.textAlign='left';g.fillText(homeTeamStats[key]+extra,statsX+padding,statsY+yOffset);g.textAlign='center';g.fillText(mz.translations[key],this.m_screenDimension.width/2,statsY+yOffset);g.textAlign='right';g.fillText(awayTeamStats[key]+extra,statsX+statsWidth-padding,statsY+yOffset);yOffset+=yLineHeight;}}
g.restore();},renderScoreBoard:function(){var homeTeam,awayTeam,g;homeTeam=this.m_match.getHomeTeam();awayTeam=this.m_match.getAwayTeam();g=ig.system.context;g.save();if(ig.game.gameType=='hockey'){g.fillStyle='#ffffff';g.globalAlpha=0.8;}
else{g.fillStyle='#000000';g.globalAlpha=0.5;}
if(ig.ua.mobile&&ig.game.view=="landscape"){CLOCK_BG={x:25,y:4,width:42,height:34};SCORE_BG={x:70,y:4,width:0,height:34};SCORE_TEAM1={x:73,y:5};SCORE_TEAM2={x:73,y:19};EVENT_POSITION_X=25;}
else{CLOCK_BG={x:4,y:4,width:42,height:34};SCORE_BG={x:49,y:4,width:0,height:34};SCORE_TEAM1={x:52,y:5};SCORE_TEAM2={x:52,y:19};EVENT_POSITION_X=4;}
g.fillRect(CLOCK_BG.x,CLOCK_BG.y,CLOCK_BG.width,CLOCK_BG.height);var scoreBoxWidth=Math.max(this.m_teamNameSize[0].width,this.m_teamNameSize[1].width)+
((homeTeam.getGoals()>9||awayTeam.getGoals())?SCORE_10_WIDTH:SCORE_WIDTH);g.fillRect(SCORE_BG.x,SCORE_BG.y,scoreBoxWidth,SCORE_BG.height);g.globalAlpha=1.0;g.font=ViewerFonts.Regular.fullName;g.textBaseline='top';if(ig.game.gameType=='hockey'){if(!this.m_mzLive.isFullTime()&&(this.m_match.m_ftFrame>this.m_match.m_currFrame)){var seconds=this.m_match.getMatchTimeHockey();var minutes=Math.floor(seconds/60);seconds=Math.floor(seconds%60)
var timeStr=((minutes<10?'0'+minutes:''+minutes))+':'+((seconds<10?'0'+seconds:''+seconds));g.fillStyle='#000000';g.fillText(timeStr,CLOCK_BG.x+CLOCK_TEXT.x,CLOCK_BG.y+CLOCK_TEXT.y);var period=this.m_match.getPeriodHockey();var periodStr=''+period;g.fillStyle='#000000';g.fillText(periodStr,CLOCK_BG.x+PERIOD_TEXT.x,CLOCK_BG.y+PERIOD_TEXT.y);g.fillStyle='#ffffff';var penalties=this.m_match.matchBuffer[this.m_match.m_currFrame].penalties;for(var i=0;i<penalties[0].length;i++){g.fillRect(SCORE_BG.x+scoreBoxWidth+4+i*38,SCORE_BG.y,35,14);}
for(var i=0;i<penalties[1].length;i++){g.fillRect(SCORE_BG.x+scoreBoxWidth+4+i*38,SCORE_BG.y+16,35,14);}
g.globalAlpha=1;g.fillStyle=TEAM_TEXT_HOME_COLOUR_HOCKEY;for(var i=0;i<penalties[0].length;i++){var secs=penalties[0][i].time;var n1=Math.floor(secs/60);var n2=Math.floor(secs%60);var txt=((n1<10?'0'+n1:''+n1))+':'+
((n2<10?'0'+n2:''+n2));g.fillText(txt,SCORE_BG.x+scoreBoxWidth+6+i*38,SCORE_BG.y);}
g.fillStyle=TEAM_TEXT_AWAY_COLOUR_HOCKEY;for(var i=0;i<penalties[1].length;i++){var secs=penalties[1][i].time;var n1=Math.floor(secs/60);var n2=Math.floor(secs%60);var txt=((n1<10?'0'+n1:''+n1))+':'+
((n2<10?'0'+n2:''+n2));g.fillText(txt,SCORE_BG.x+scoreBoxWidth+6+i*38,SCORE_BG.y+16);}}
g.fillStyle=TEAM_TEXT_HOME_COLOUR_HOCKEY;g.fillText(homeTeam.getName(),SCORE_TEAM1.x,SCORE_TEAM1.y);g.fillText(''+homeTeam.getGoals(),SCORE_TEAM1.x+scoreBoxWidth-SCORE_GOALS_OFFSET,SCORE_TEAM1.y);g.fillStyle=TEAM_TEXT_AWAY_COLOUR_HOCKEY;g.fillText(awayTeam.getName(),SCORE_TEAM2.x,SCORE_TEAM2.y);g.fillText(''+awayTeam.getGoals(),SCORE_TEAM2.x+scoreBoxWidth-SCORE_GOALS_OFFSET,SCORE_TEAM2.y);}
else{var seconds=this.m_match.getMatchTime();var minutes=Math.floor(seconds/60);seconds=Math.floor(seconds%60)
var timeStr=((minutes<10?'0'+minutes:''+minutes))+':'+((seconds<10?'0'+seconds:''+seconds));g.fillStyle='#ffffff';g.fillText(timeStr,CLOCK_BG.x+CLOCK_TEXT.x,CLOCK_BG.y+CLOCK_TEXT.y);g.fillStyle=TEAM_TEXT_HOME_COLOUR;g.fillText(homeTeam.getName(),SCORE_TEAM1.x,SCORE_TEAM1.y);g.fillText(''+homeTeam.getGoals(),SCORE_TEAM1.x+scoreBoxWidth-SCORE_GOALS_OFFSET,SCORE_TEAM1.y);g.fillStyle=TEAM_TEXT_AWAY_COLOUR;g.fillText(awayTeam.getName(),SCORE_TEAM2.x,SCORE_TEAM2.y);g.fillText(''+awayTeam.getGoals(),SCORE_TEAM2.x+scoreBoxWidth-SCORE_GOALS_OFFSET,SCORE_TEAM2.y);}
g.restore();},renderHelp:function(){var g;g=ig.system.context
g.save();g.font=ViewerFonts.Testing.fullName;var longestWordLength=0;var wordsize;for(var i=0;i<this.m_helpSectionTextArray.length;++i){wordsize=g.measureText(this.m_helpSectionTextArray[i][1]);if(wordsize.width>longestWordLength){longestWordLength=wordsize.width;}}
var padding=10;var helpWidth=140+longestWordLength;var helpHeight=(this.m_helpSectionTextArray.length+1)*30+padding*2;var helpX=this.m_screenDimension.width/2-helpWidth/2;var helpY=this.m_screenDimension.height/2-helpHeight/2;g.fillStyle='#000000';g.globalAlpha=0.5;g.fillRect(helpX,helpY,helpWidth,helpHeight);g.globalAlpha=1.0;g.textBaseline='top';g.fillStyle='#ffffff';g.textAlign='center';g.fillText(mz.translations["help"],this.m_screenDimension.width/2,helpY+padding);g.textAlign='left';yOffset=padding+30;for(var i=0;i<this.m_helpSectionTextArray.length;++i){g.fillText(''+this.m_helpSectionTextArray[i][0]+':',helpX+20,helpY+yOffset);g.fillText(''+this.m_helpSectionTextArray[i][1],helpX+120,helpY+yOffset);yOffset+=30;}
g.restore();},renderEvents:function(){var num,idx,e;for(idx=0,num=0;idx<this.m_activeEvents.getLength();++idx){e=this.m_activeEvents.at(idx);switch(e.getEventType()){case EventType.EVENT_GOAL:if(ig.game.gameType=='hockey'){this.renderEvent(HudAssets.iconGoalHockey,e,num);}
else{this.renderEvent(HudAssets.iconGoal,e,num);}
num++;break;case EventType.EVENT_YELLOW_CARD:this.renderEvent(HudAssets.iconYellowCard,e,num);num++;break;case EventType.EVENT_SEC_YELLOW:case EventType.EVENT_RED_CARD:this.renderEvent(HudAssets.iconRedCard,e,num);num++;break;case EventType.EVENT_INJURY:this.renderEvent(HudAssets.iconInjury,e,num);num++;break;case EventType.EVENT_OWN_GOAL:if(ig.game.gameType=='hockey'){this.renderEvent(HudAssets.iconOwnGoalHockey,e,num);}
else{this.renderEvent(HudAssets.iconOwnGoal,e,num);}
num++;break;}}},renderEvent:function(icon,e,num){var source,target,t;var p=e.getOwner();var pName=this.m_match.frameToMatchMinute(e.getFrame())+'\': '+p.getShirtNo()+' '+p.getName();var g=ig.system.context
var iw=icon.width;var ih=icon.height;var fontToUse=ViewerFonts.Regular;g.font=fontToUse.fullName;g.textBaseline='top';var pnWidth=g.measureText(pName).width;var totWidth=iw+EVENT_SPACING+pnWidth+EVENT_SPACING;var xp=EVENT_POSITION_X+5;var yp=EVENT_POSITION_Y+(num*fontToUse.heightPixels)+2;var livedFor=this.m_mzLive.getGameTime()-e.getTime();var duration=e.getDuration();if(livedFor<EVENT_SCROLL_ON_TIME){source=-totWidth;target=xp;xp=source+(((target-source)*livedFor)/EVENT_SCROLL_ON_TIME);}
else if(livedFor>duration-EVENT_SCROLL_OFF_TIME){source=xp;target=-totWidth;t=livedFor-(duration-EVENT_SCROLL_OFF_TIME);xp=source+(((target-source)*t)/EVENT_SCROLL_OFF_TIME);}
if(ig.game.gameType=='hockey'){g.fillStyle='#ffffff';g.globalAlpha=0.8;}
else{g.fillStyle='#000000';g.globalAlpha=0.5;}
g.fillRect(EVENT_POSITION_X,yp,totWidth+5,fontToUse.heightPixels+2);g.globalAlpha=1.0;if(livedFor>EVENT_FLASH_DURATION||(livedFor&EVENT_FLASH_MASK)>(EVENT_FLASH_MASK/2)){icon.draw(xp,yp+(fontToUse.heightPixels-ih)/2);}
var homeColor=(ig.game.gameType=='hockey')?TEAM_TEXT_HOME_COLOUR_HOCKEY:TEAM_TEXT_HOME_COLOUR;var awayColor=(ig.game.gameType=='hockey')?TEAM_TEXT_AWAY_COLOUR_HOCKEY:TEAM_TEXT_AWAY_COLOUR;g.fillStyle=(p.getSide()=='home')?homeColor:awayColor;g.fillText(pName,xp+iw+EVENT_SPACING,yp);},renderSquadList:function(){var source,target,t;var fontHeight,pny,i;var teamIndex,team,player;if(this.m_mainScene.getHelpStatus()){return;}
var g=ig.system.context;g.save();var fontToUse=ViewerFonts.Regular;g.font=fontToUse.fullName;g.textBaseline='top';g.fillStyle='#ffffff';var y=0;var introTime=this.m_mainScene.getIntroTime();switch(this.m_mainScene.getIntroState()){case IntroState.SCROLL_ON:source=this.m_screenDimension.height;target=(this.m_screenDimension.height-(SQUAD_PLAYERS_HEIGHT+SQUAD_TEAMS_HEIGHT))/2;t=(introTime>HudTiming.SQUAD_SCROLL_ON_TIME)?HudTiming.SQUAD_SCROLL_ON_TIME:introTime;y=source+(((target-source)*t)/HudTiming.SQUAD_SCROLL_ON_TIME);break;case IntroState.PAUSE:case IntroState.PLAYERS_MOVE:y=(this.m_screenDimension.height-(SQUAD_PLAYERS_HEIGHT+SQUAD_TEAMS_HEIGHT))/2;break;case IntroState.SCROLL_OFF:source=(this.m_screenDimension.height-(SQUAD_PLAYERS_HEIGHT+SQUAD_TEAMS_HEIGHT))/2;target=this.m_screenDimension.height;t=(introTime>HudTiming.SQUAD_SCROLL_OFF_TIME)?HudTiming.SQUAD_SCROLL_OFF_TIME:introTime;y=source+(((target-source)*t)/HudTiming.SQUAD_SCROLL_OFF_TIME);break;}
if(ig.game.view=="portrait"){var squadX=(this.m_screenDimension.width/2)-(SQUAD_PLAYERS_WIDTH-SQUAD_NUMBERS_WIDTH*2)+25;var squadTeamNameX=squadX+SQUAD_NUMBERS_WIDTH;y=y-(SQUAD_PLAYERS_HEIGHT+SQUAD_TEAMS_HEIGHT)/2;y=(y<40)?40:y;var xOffsets=[0,0];var yOffsets=[0,SQUAD_PLAYERS_HEIGHT+SQUAD_TEAMS_HEIGHT_INNER+10];}
else{var squadX=SQUAD_X;var squadTeamNameX=SQUAD_TEAM_NAME_X;var xOffsets=[0,this.m_screenDimension.width-(squadX*2)-SQUAD_PLAYERS_WIDTH-SQUAD_NUMBERS_WIDTH];var yOffsets=[0,0];}
g.globalAlpha=0.5;for(teamIndex=0;teamIndex<2;++teamIndex){ox=xOffsets[teamIndex];oy=yOffsets[teamIndex];g.fillStyle=SQUAD_BG_LIGHT;g.fillRect(squadX+ox,y+SQUAD_TEAMS_HEIGHT+oy,SQUAD_NUMBERS_WIDTH,SQUAD_PLAYERS_HEIGHT);g.fillStyle=SQUAD_BG_MEDIUM;g.fillRect(squadX+SQUAD_NUMBERS_WIDTH+ox,y+SQUAD_TEAMS_HEIGHT+oy,SQUAD_PLAYERS_WIDTH,SQUAD_PLAYERS_HEIGHT);g.fillStyle=SQUAD_BG_DARK;g.fillRect(squadX+ox+SQUAD_TEAMS_HEIGHT,y+oy,SQUAD_PLAYERS_WIDTH,SQUAD_TEAMS_HEIGHT_INNER);g.fillStyle=SQUAD_BG_LIGHT;g.fillRect(squadX+ox,y+oy,SQUAD_NUMBERS_WIDTH,SQUAD_TEAMS_HEIGHT_INNER);}
g.globalAlpha=1.0;g.font=ViewerFonts.Large.fullName;g.fillStyle='#ffffff';for(teamIndex=0;teamIndex<2;++teamIndex){oy=yOffsets[teamIndex];g.fillText(this.m_match.m_teams[teamIndex].getName(),squadTeamNameX+xOffsets[teamIndex],y+SQUAD_TEAM_NAME_Y_OFFSET+oy);}
g.font=ViewerFonts.Regular.fullName;fontHeight=ViewerFonts.Regular.heightPixels;for(teamIndex=0;teamIndex<2;++teamIndex){ox=xOffsets[teamIndex];pny=y+SQUAD_TEAMS_HEIGHT+SQUAD_INSET_Y+yOffsets[teamIndex];team=this.m_match.m_teams[teamIndex];for(i=0;i<team.getNumPlayers();i++){player=team.getPlayerByIndex(i);g.fillText(''+player.getShirtNo(),squadX+SQUAD_INSET_X+ox,pny);g.fillText(''+player.getName(),squadX+SQUAD_NUMBERS_WIDTH+SQUAD_INSET_X+ox,pny);pny+=fontHeight-1;}}
var animResource;for(teamIndex=0;teamIndex<2;++teamIndex){team=this.m_match.m_teams[teamIndex];i=0;do{player=team.getPlayerByIndex(i++)}while(player.isKeeper());if(ig.game.gameType=='hockey'){var rot=(introTime/8)*Math.PI/128.0;frame=Math.floor((introTime/96)%8);var x=squadX+(SQUAD_NUMBERS_WIDTH/2)+xOffsets[teamIndex];var y1=y+(SQUAD_TEAMS_HEIGHT/2)-2+yOffsets[teamIndex];ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(x),ig.system.getDrawPos(y1));ig.system.context.rotate(rot);var frOffset=frame*49;ig.system.context.drawImage(this.m_mainScene.m_hockeyPlayers[teamIndex].data,0,frOffset,49,49,-20,-20,40,40);ig.system.context.restore();}
else{animResource=player.getResource(PlayerRESOURCE.RUN);animResource.gotoFrame((introTime/64)%animResource.getNumFrames());animResource.angle=(introTime/8)*Math.PI/128.0;animResource.draw(squadX+(SQUAD_NUMBERS_WIDTH/2)+xOffsets[teamIndex],y+(SQUAD_TEAMS_HEIGHT/2)+yOffsets[teamIndex],SQUAD_PLAYER_SCALE/ArtworkScaling.PLAYER_SCALE);}}
g.restore();},});});

// lib/game/render/main-scene.js
ig.baked=true;ig.module('game.render.main-scene').requires('impact.game','game.graphics.anim','game.graphics.graphics-loader','game.reality.event','game.reality.global-constants','game.render.hud').defines(function(){var debugRenderCrosses=false;var CAMERA_FIXED=0;var CAMERA_AUTO=1;var CAMERA_ZOOMED=2;var DesignedForScreenSize={width:0,height:0};var DesignedForScreenSizeHockey={width:850,height:567};var DesignedForScreenSizeFootball={width:800,height:600};var CAMERA_PITCH_WINDOW={x:150.0,y:90.0};var CAMERA_SCROLL_WINDOW={x:40.0,y:40.0};var CAMERA_HOCKEY_PITCH_WINDOW={x:-2000,y:-1000};var CAMERA_HOCKEY_SCROLL_WINDOW={x:120,y:120};var CAMERA_DEAD_BALL_VELOCITY=8;var CAMERA_DYNAMIC_BALL_VELOCITY=8;var CAMERA_HOCKEY_DEAD_BALL_VELOCITY=24;var CAMERA_HOCKEY_DYNAMIC_BALL_VELOCITY=24;var CAMERA_DEFAULT_ZOOM=1.9;var CAMERA_HEIGHT_MAX=64.0;var CAMERA_ZOOM_DIVISOR=128.0;var CAMERA_ZOOM_BIRDS_EYE=1.48;var CAMERA_ZOOM_CLOSE=3.2;var CAMERA_HOCKEY_ZOOM_BIRDS_EYE=1.06;var CAMERA_HOCKEY_DEFAULT_ZOOM=1.9;var CAMERA_HOCKEY_HEIGHT_MAX=64.0;var CAMERA_HOCKEY_ZOOM_DIVISOR=128.0;var CAMERA_HOCKEY_ZOOM_CLOSE=3.2;var PITCH_WORLD_SIZE_HOCKEY={x:6096.0,y:2591.0};var PITCH_WORLD_SIZE_FOOTBALL={x:1000.0,y:750.0};var PITCH_WORLD_SIZE={x:0,y:0};var VECTOR_SHADOW={x:0.1,y:-0.4};var PITCH_LOCAL_SIZE={x:780.0,y:320.0};var PITCH_LOCAL_SIZE_HOCKEY={x:780.0,y:320.0};var PITCH_LOCAL_SIZE_FOOTBALL={x:500.0,y:374.0};var PITCH_LOCAL_OFFSET={x:0,y:0};var PITCH_LOCAL_OFFSET_FOOTBALL={x:199.5,y:202.5};var PITCH_LOCAL_OFFSET_HOCKEY={x:0,y:0};var PITCH_GOALPOST_OFFSET=1.0
var BALL_ABOVE_PLAYER=0.0;var BALL_ABOVE_GOALPOST=24.0;var PLAYER_BALL_OFFSET=6;var BALL_KICK_DIST=36;var BALL_ZOOM_DIVISOR=50.0;var EVENT_NOTIFICATION_DURATION=10000;var GFX_FOLDER=mz.base_path+'media/';var ASSET_PITCH_1=GFX_FOLDER+'pitch_1.jpg';var ASSET_PITCH_2=GFX_FOLDER+'pitch_2.jpg';var ASSET_PITCH_3=GFX_FOLDER+'pitch_3.jpg';var ASSET_PITCH_4=GFX_FOLDER+'pitch_4.jpg';var ASSET_HOCKEY_PITCH_NORMAL=GFX_FOLDER+'rink_new.jpg';var ASSET_STADIUM_TILE=GFX_FOLDER+'stadium_tile.png';var ASSET_STADIUM_CORNER=GFX_FOLDER+'stadium_corner_tile.png';var ASSET_CROWD_SPARSE=GFX_FOLDER+'crowd_tile_sparse.png';var ASSET_CROWD_MEDIUM=GFX_FOLDER+'crowd_tile_medium.png';var ASSET_CROWD_PACKED=GFX_FOLDER+'crowd_tile_packed.png';var ASSET_CROWD_CORNER_SPARSE=GFX_FOLDER+'crowd_corner_tile_sparse.png';var ASSET_CROWD_CORNER_MEDIUM=GFX_FOLDER+'crowd_corner_tile_medium.png';var ASSET_CROWD_CORNER_PACKED=GFX_FOLDER+'crowd_corner_tile_packed.png';var ASSET_GOALPOSTS=GFX_FOLDER+'goalposts.png';var ASSET_PLAYER_RUN=GFX_FOLDER+'player_run.png';var ASSET_PLAYER_STAND=GFX_FOLDER+'player_standing.png';var ASSET_PLAYER_PASS_LEFT=GFX_FOLDER+'player_pass_left.png';var ASSET_PLAYER_PASS_RIGHT=GFX_FOLDER+'player_pass_right.png';var ASSET_PLAYER_SHOOT_LEFT=GFX_FOLDER+'player_shoot_left.png';var ASSET_PLAYER_SHOOT_RIGHT=GFX_FOLDER+'player_shoot_right.png';var ASSET_PLAYER_SLIDE=GFX_FOLDER+'player_slide.png';var ASSET_PLAYER_TACKLE=GFX_FOLDER+'player_tackle.png';var ASSET_PLAYER_HEADER=GFX_FOLDER+'player_header.png';var ASSET_PLAYER_FALL=GFX_FOLDER+'player_fall.png';var ASSET_HOCKEY_PLAYER=GFX_FOLDER+'hockey_player.png';var ASSET_PLAYER_STICK=GFX_FOLDER+'stick.png';var ASSET_PLAYER_SAVE_LEFT=GFX_FOLDER+'player_save_left.png';var ASSET_PLAYER_SAVE_RIGHT=GFX_FOLDER+'player_save_right.png';var ASSET_PLAYER_KICK_HANDS=GFX_FOLDER+'player_kick_from_hands.png';var ASSET_PLAYER_STAND_BALL=GFX_FOLDER+'player_standing_with_ball.png';var ASSET_PLAYER_RUN_BALL=GFX_FOLDER+'player_run_with_ball.png';var ASSET_BLOB_SHADOW=GFX_FOLDER+'blob_shadow.png';var ASSET_BALL=GFX_FOLDER+'football.png';var ASSET_HOCKEY_PUCK=GFX_FOLDER+'puck.png';MainScene=ig.Class.extend({m_mzLive:null,m_hockeyPlayers:[2],m_gameWorld:null,m_screenDimension:null,m_match:null,m_renderHelp:false,m_activeEvents:null,m_gameSpeedNotificationTime:0,m_scrollX:0,m_scrollY:0,m_zoom:1,m_cameraMode:CAMERA_FIXED,m_camera:{x:0,y:0},m_oldBallDistSq:9999,m_stickImage:new ig.Image(mz.base_path+'media/stick.png'),init:function(match,d,gsnd,gameWorld,docbase,mzlive){this.m_match=match;this.m_screenDimension=d;this.m_gameSound=gsnd;this.m_gameWorld=gameWorld;this.m_docBase=docbase;this.m_mzLive=mzlive;if(ig.game.gameType=='hockey'){DesignedForScreenSize=DesignedForScreenSizeHockey;PITCH_WORLD_SIZE=PITCH_WORLD_SIZE_HOCKEY;PITCH_LOCAL_SIZE=PITCH_LOCAL_SIZE_HOCKEY;PITCH_LOCAL_OFFSET=PITCH_LOCAL_OFFSET_HOCKEY;ASSET_BALL=ASSET_HOCKEY_PUCK;CAMERA_DEFAULT_ZOOM=CAMERA_HOCKEY_DEFAULT_ZOOM;CAMERA_HEIGHT_MAX=CAMERA_HOCKEY_HEIGHT_MAX;CAMERA_ZOOM_DIVISOR=CAMERA_HOCKEY_ZOOM_DIVISOR;CAMERA_ZOOM_BIRDS_EYE=CAMERA_HOCKEY_ZOOM_BIRDS_EYE;CAMERA_ZOOM_CLOSE=CAMERA_HOCKEY_ZOOM_CLOSE;CAMERA_PITCH_WINDOW=CAMERA_HOCKEY_PITCH_WINDOW;CAMERA_SCROLL_WINDOW=CAMERA_HOCKEY_SCROLL_WINDOW;CAMERA_DEAD_BALL_VELOCITY=CAMERA_HOCKEY_DEAD_BALL_VELOCITY;CAMERA_DYNAMIC_BALL_VELOCITY=CAMERA_HOCKEY_DYNAMIC_BALL_VELOCITY;cameraLocalX=this.WorldToLocalX(PITCH_WORLD_SIZE.x-this.m_camera.x);cameraLocalY=this.WorldToLocalY(-this.m_camera.y);this.m_cameraMode=CAMERA_FIXED;this.m_zoom=CAMERA_ZOOM_BIRDS_EYE;this.m_camera.x=PITCH_WORLD_SIZE.x;this.m_camera.y=0;}
else{DesignedForScreenSize=DesignedForScreenSizeFootball;PITCH_WORLD_SIZE=PITCH_WORLD_SIZE_FOOTBALL;PITCH_LOCAL_SIZE=PITCH_LOCAL_SIZE_FOOTBALL;PITCH_LOCAL_OFFSET=PITCH_LOCAL_OFFSET_FOOTBALL;this.m_cameraMode=CAMERA_FIXED;this.m_zoom=CAMERA_ZOOM_BIRDS_EYE;this.m_camera.x=PITCH_WORLD_SIZE.x/2;this.m_camera.y=PITCH_WORLD_SIZE.y/2;}
this.ScaleToOriginalScreenSize=Math.min(d.width/DesignedForScreenSize.width,d.height/DesignedForScreenSize.height);ig.game.gameLoaded=true;ig.game.scaleCanvas();},clearEvents:function(){this.m_activeEvents.clear();},queueLoadResourcesTasks:function(loaderQueue){this.queueLoadStadiumTiles(loaderQueue);this.m_activeEvents=new SortedEventList();this.m_hud=new Hud(this.m_mzLive,this,this.m_match,this.m_activeEvents,this.m_screenDimension);this.queueLoadPlayerAnimations(loaderQueue);},queueLoadStadiumTiles:function(loaderQueue){stadiumRawImages={stadiumTile:loaderQueue.queueCreateAndWaitForImage(ASSET_STADIUM_TILE),stadiumCornerTile:loaderQueue.queueCreateAndWaitForImage(ASSET_STADIUM_CORNER),crowdSparseImage:loaderQueue.queueCreateAndWaitForImage(ASSET_CROWD_SPARSE),crowdMediumImage:loaderQueue.queueCreateAndWaitForImage(ASSET_CROWD_MEDIUM),crowdPackedImage:loaderQueue.queueCreateAndWaitForImage(ASSET_CROWD_PACKED),crowdCornerSparseImage:loaderQueue.queueCreateAndWaitForImage(ASSET_CROWD_CORNER_SPARSE),crowdCornerMediumImage:loaderQueue.queueCreateAndWaitForImage(ASSET_CROWD_CORNER_MEDIUM),crowdCornerPackedImage:loaderQueue.queueCreateAndWaitForImage(ASSET_CROWD_CORNER_PACKED),animBall:loaderQueue.queueCreateAndWaitForImage(ASSET_BALL),stick:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_STICK),};switch(ig.game.gameType){case"soccer":if(this.m_mzLive.m_match.m_stadiumCapacity<=7499){var pitchFileName=ASSET_PITCH_1;}
else if(this.m_mzLive.m_match.m_stadiumCapacity>=7500&&this.m_mzLive.m_match.m_stadiumCapacity<=7999){var pitchFileName=ASSET_PITCH_2;}
else if(this.m_mzLive.m_match.m_stadiumCapacity>=8000&&this.m_mzLive.m_match.m_stadiumCapacity<=8999){var pitchFileName=ASSET_PITCH_3;}
else{var pitchFileName=ASSET_PITCH_4;}
break;case"hockey":var pitchFileName=ASSET_HOCKEY_PITCH_NORMAL;break;}
stadiumRawImages.pitchImage=loaderQueue.queueCreateAndWaitForImage(pitchFileName)
this.m_goalposts=loaderQueue.queueCreateAndWaitForImage(ASSET_GOALPOSTS);this.m_blobShadowImage=loaderQueue.queueCreateAndWaitForImage(ASSET_BLOB_SHADOW);loaderQueue.queueNonCallbackTask(this.asyncCreateStadiumAssets.bind(this,stadiumRawImages),'Generating stadium');},asyncCreateStadiumAssets:function(stadiumRawImages,successCallback,failCallback){var pitchW=stadiumRawImages.pitchImage.width;var pitchH=stadiumRawImages.pitchImage.height;var stadiumTileW=stadiumRawImages.stadiumTile.width;var stadiumTileH=stadiumRawImages.stadiumTile.height;var stadiumCornerTileW=stadiumRawImages.stadiumCornerTile.width;var stadiumCornerTileH=stadiumRawImages.stadiumCornerTile.height;var StadiumW=pitchW+stadiumTileH*2;var StadiumH=pitchH+stadiumTileH*2;this.stadiumRenderList=new Array();this.stadiumRenderList.push(new Array());this.stadiumRenderList.push(new Array());this.stadiumRenderList.push(new Array());this.stadiumRenderList.push(new Array());this.stadiumRenderList.push(new Array());if(ig.game.gameType=='hockey'){this.stadiumRenderList[0].push({tile:stadiumRawImages.pitchImage,x:-850/2,y:-567/2});}
else{this.stadiumRenderList[0].push({tile:stadiumRawImages.pitchImage,x:stadiumTileH,y:stadiumTileH});var homeColour=this.m_match.getHomeTeam().m_shirtPriColor;var awayColour=this.m_match.getAwayTeam().m_shirtPriColor;var crowd;var crowdCorner;var crowdAway;var stadiumPercentFull=(this.m_match.getAttendance()*100)/this.m_match.getStadiumCapacity();if(stadiumPercentFull<50){crowd=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdSparseImage,homeColour);crowdCorner=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdCornerSparseImage,homeColour);crowdAway=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdSparseImage,awayColour);}
else if(stadiumPercentFull<70){crowd=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdMediumImage,homeColour);crowdCorner=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdCornerMediumImage,homeColour);crowdAway=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdMediumImage,awayColour);}
else{crowd=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdPackedImage,homeColour);crowdCorner=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdCornerPackedImage,homeColour);crowdAway=GraphicsLoader.fixCrowdColors(stadiumRawImages.crowdPackedImage,awayColour);}
var ix,iy,ct;for(ix=stadiumCornerTileW;ix<StadiumW-stadiumCornerTileW;ix+=stadiumTileW){this.stadiumRenderList[0].push({tile:stadiumRawImages.stadiumTile,x:ix,y:0});this.stadiumRenderList[2].push({tile:stadiumRawImages.stadiumTile,x:ix-StadiumW,y:-StadiumH});this.stadiumRenderList[0].push({tile:crowd,x:ix,y:0});this.stadiumRenderList[2].push({tile:crowd,x:ix-StadiumW,y:-StadiumH});}
for(iy=stadiumCornerTileH;iy<StadiumH-stadiumCornerTileH;iy+=stadiumTileW){ctl=(iy<stadiumCornerTileH+(stadiumTileW*1.5))?crowdAway:crowd;ctr=(iy>StadiumH-stadiumCornerTileH-(stadiumTileW*2.5))?crowdAway:crowd;this.stadiumRenderList[1].push({tile:stadiumRawImages.stadiumTile,x:iy,y:-StadiumW});this.stadiumRenderList[3].push({tile:stadiumRawImages.stadiumTile,x:iy-StadiumH,y:0});this.stadiumRenderList[1].push({tile:ctr,x:iy,y:-StadiumW});this.stadiumRenderList[3].push({tile:ctl,x:iy-StadiumH,y:0});}
this.stadiumRenderList[4].push({tile:stadiumRawImages.stadiumCornerTile,x:0,y:0});this.stadiumRenderList[1].push({tile:stadiumRawImages.stadiumCornerTile,x:0,y:-StadiumW});this.stadiumRenderList[2].push({tile:stadiumRawImages.stadiumCornerTile,x:-StadiumW,y:-StadiumH});this.stadiumRenderList[3].push({tile:stadiumRawImages.stadiumCornerTile,x:-StadiumH,y:0});this.stadiumRenderList[4].push({tile:crowdCorner,x:0,y:0});this.stadiumRenderList[1].push({tile:crowdCorner,x:0,y:-StadiumW});this.stadiumRenderList[2].push({tile:crowdCorner,x:-StadiumW,y:-StadiumH});this.stadiumRenderList[3].push({tile:crowdCorner,x:-StadiumH,y:0});}
this.m_ballAnim=GraphicsLoader.makeAnimation(stadiumRawImages.animBall,16,0,ArtworkScaling.BALL_SCALE);successCallback();},queueLoadPlayerAnimations:function(loaderQueue){if(ig.game.gameType=='hockey'){var animRawImages={hockeyPlayer:loaderQueue.queueCreateAndWaitForImage(ASSET_HOCKEY_PLAYER),};loaderQueue.queueNonCallbackTask(this.asyncCreatePlayerAnimations.bind(this,animRawImages,this.m_match.getHomeTeam()),'Generating home team player animations');loaderQueue.queueNonCallbackTask(this.asyncCreatePlayerAnimations.bind(this,animRawImages,this.m_match.getAwayTeam()),'Generating away team player animations');}
else{var animRawImages={animStand:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_STAND),animRun:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_RUN),animPassLeft:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_PASS_LEFT),animPassRight:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_PASS_RIGHT),animShootLeft:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_SHOOT_LEFT),animShootRight:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_SHOOT_RIGHT),animSlide:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_SLIDE),animTackle:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_TACKLE),animHeader:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_HEADER),animFall:loaderQueue.queueCreateAndWaitForImage(ASSET_PLAYER_FALL),};loaderQueue.queueNonCallbackTask(this.asyncCreatePlayerAnimations.bind(this,animRawImages,this.m_match.getHomeTeam()),'Generating home team player animations');loaderQueue.queueNonCallbackTask(this.asyncCreatePlayerAnimations.bind(this,animRawImages,this.m_match.getAwayTeam()),'Generating away team player animations');}},asyncCreatePlayerAnimations:function(animRawImages,team,successCallback,failCallback){var bi;var playerAnimSet={};var shirt=team.m_shirtPriColor;var shorts=team.m_shortsPriColor;var socks=team.m_socksPriColor;var numPlayers=team.getNumPlayers();if(ig.game.gameType=='hockey'){if(this.m_match.getHomeTeam()==team){this.m_hockeyPlayers[0]=GraphicsLoader.setHockeyPlayerColours(animRawImages.hockeyPlayer,shirt,shorts);}
else{this.m_hockeyPlayers[1]=GraphicsLoader.setHockeyPlayerColours(animRawImages.hockeyPlayer,shirt,shorts);}}
else{for(var i=0;i<numPlayers;++i){player=team.getPlayerByIndex(i);hair=player.getHairColor();skin=player.getSkinColor();if(!player.isKeeper()){var c=hair&0xe0e0e0;c|=(skin>>4)&0x0e0e0e;var similarPlayer=playerAnimSet[c];if(!similarPlayer){bi=GraphicsLoader.setPlayerColors(animRawImages.animStand,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.STAND,GraphicsLoader.makeAnimation(bi,1,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animRun,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.RUN,GraphicsLoader.makeAnimation(bi,16,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animPassLeft,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.PASS_LEFT,GraphicsLoader.makeAnimation(bi,5,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animPassRight,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.PASS_RIGHT,GraphicsLoader.makeAnimation(bi,5,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animShootLeft,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.SHOOT_LEFT,GraphicsLoader.makeAnimation(bi,6,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animShootRight,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.SHOOT_RIGHT,GraphicsLoader.makeAnimation(bi,6,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animSlide,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.SLIDE,GraphicsLoader.makeAnimation(bi,12,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animTackle,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.TACKLE,GraphicsLoader.makeAnimation(bi,6,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animHeader,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.HEADER,GraphicsLoader.makeAnimation(bi,7,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animFall,shirt,shorts,socks,hair,skin);player.setResource(PlayerRESOURCE.FALL,GraphicsLoader.makeAnimation(bi,11,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));playerAnimSet[c]=player;}
else{for(var j=PlayerRESOURCE.MAX-1;j>=0;--j){player.setResource(j,similarPlayer.getResource(j));}}}
else{bi=GraphicsLoader.setPlayerColors(animRawImages.animStand,team.m_shirtPriGoalieColor,team.m_shortsPriGoalieColor,team.m_socksPriGoalieColor,hair,skin);player.setResource(PlayerRESOURCE.STAND,GraphicsLoader.makeAnimation(bi,1,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animRun,team.m_shirtPriGoalieColor,team.m_shortsPriGoalieColor,team.m_socksPriGoalieColor,hair,skin);player.setResource(PlayerRESOURCE.RUN,GraphicsLoader.makeAnimation(bi,16,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animShootLeft,team.m_shirtPriGoalieColor,team.m_shortsPriGoalieColor,team.m_socksPriGoalieColor,hair,skin);player.setResource(PlayerRESOURCE.SHOOT_LEFT,GraphicsLoader.makeAnimation(bi,6,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));bi=GraphicsLoader.setPlayerColors(animRawImages.animShootRight,team.m_shirtPriGoalieColor,team.m_shortsPriGoalieColor,team.m_socksPriGoalieColor,hair,skin);player.setResource(PlayerRESOURCE.SHOOT_RIGHT,GraphicsLoader.makeAnimation(bi,6,PLAYER_BALL_OFFSET,ArtworkScaling.PLAYER_SCALE));}}}
successCallback();},WorldToLocalX:function(x){return x*PITCH_LOCAL_SIZE.x/PITCH_WORLD_SIZE.x;},WorldToLocalY:function(y){return y*PITCH_LOCAL_SIZE.y/PITCH_WORLD_SIZE.y;},getHelpStatus:function(){return this.m_renderHelp;},toggleHelp:function(){this.m_renderHelp=!this.m_renderHelp;},resetGameSpeedNotification:function(time){this.m_gameSpeedNotificationTime=time;},getGameSpeedNotificationTime:function(){return this.m_gameSpeedNotificationTime;},updateMatch:function(){this.m_match.nextFrame();this.updateTeam(this.m_match.getHomeTeam());this.updateTeam(this.m_match.getAwayTeam());this.updateBall();this.updateReferee();this.updateEvents();this.updateCamera();if(this.m_mzLive.isPlaying()){if(ig.game.gameType=='hockey'){if(this.m_match.getCurrentFrame()>=this.m_match.getFTFrame()){return true;}}
else{if(!this.m_match.getRewindState()){if(this.m_mzLive.isFirstHalf()){if(this.m_match.getCurrentFrame()>=this.m_match.getHTFrame()){return true;}}
else{if(this.m_match.getCurrentFrame()>=this.m_match.getFTFrame()){return true;}}}
else{if(this.m_mzLive.isFirstHalf()){if(this.m_match.getCurrentFrame()<=this.m_match.getKOFrame()){return true;}}
else{if(this.m_match.getCurrentFrame()<=this.m_match.getKO2Frame()){return true;}}}}}
return false;},renderFrame:function(){var cameraLocalX,cameraLocalY,g;g=ig.system.context;if(ig.game.gameType=='hockey'){cameraLocalX=this.WorldToLocalX(PITCH_WORLD_SIZE.x-this.m_camera.x);cameraLocalY=this.WorldToLocalY(-this.m_camera.y);}
else{cameraLocalX=this.WorldToLocalX(this.m_camera.x);cameraLocalY=this.WorldToLocalY(this.m_camera.y);}
g.save();var gameSize=mz.getGameSize();var d={width:gameSize.gameWidth,height:gameSize.gameHeight};if(d.width!=this.m_screenDimension.width){this.m_screenDimension.width=d.width;}
if(d.height!=this.m_screenDimension.height){this.m_screenDimension.height=d.height;}
if(ig.game.view=="landscape"){g.translate(this.m_screenDimension.width/2,this.m_screenDimension.height/2);}
else{g.translate(this.m_screenDimension.height/2,this.m_screenDimension.width/2);}
var width,height;switch(ig.game.view){case"landscape":width=DesignedForScreenSize.width;height=DesignedForScreenSize.height;break;case"portrait":width=DesignedForScreenSize.height;height=DesignedForScreenSize.width;break;}
this.ScaleToOriginalScreenSize=Math.min(((ig.game.view=="portrait"||ig.game.forcedView=="portrait")?d.height:d.width)/width,((ig.game.view=="portrait"||ig.game.forcedView=="portrait")?d.width:d.height)/height);g.scale(this.m_zoom*this.ScaleToOriginalScreenSize,this.m_zoom*this.ScaleToOriginalScreenSize);if(ig.game.view=="portrait"||ig.game.forcedView=="portrait"){var deg=90*Math.PI/180;g.rotate(deg);}
g.translate(-cameraLocalX,-cameraLocalY);this.drawPitch();if(ig.game.gameType=='hockey'){this.drawPuck();this.drawTeams();}
else{if(this.m_match.getBall().getCZ()>BALL_ABOVE_GOALPOST){this.drawTeams();this.drawGoalposts();this.drawBall();}
else if(this.m_match.getBall().getCZ()>BALL_ABOVE_PLAYER){this.drawTeams();this.drawBall();this.drawGoalposts();}
else{this.drawBall();this.drawTeams();this.drawGoalposts();}}
if(debugRenderCrosses){var scaledScreenWidth=this.m_screenDimension.width/this.m_zoom;var scaledScreenHeight=this.m_screenDimension.height/this.m_zoom;g.strokeStyle='#ff0000';g.beginPath();g.moveTo(cameraLocalX,cameraLocalY-10)
g.lineTo(cameraLocalX,cameraLocalY+10)
g.moveTo(cameraLocalX-10,cameraLocalY)
g.lineTo(cameraLocalX+10,cameraLocalY)
g.stroke();g.strokeRect((cameraLocalX-scaledScreenWidth/2)+10,(cameraLocalY-scaledScreenHeight/2)+10,scaledScreenWidth-20,scaledScreenHeight-20);}
ig.system.context.restore();if(!this.m_mzLive.isHalfTime()&&!this.m_mzLive.isFullTime()){this.m_hud.renderScoreBoard();this.m_hud.renderEvents();}
if(this.m_renderHelp){this.m_hud.renderHelp();}
else{if(this.m_mzLive.isHalfTime()){this.m_hud.renderStats("halfTime");}
if(this.m_mzLive.isFullTime()){this.m_hud.renderStats("fullTime");}}
this.m_hud.renderCurrentSpeed();this.m_mzLive.UpdateButtonImages();return true;},updateCamera:function(){var i;var ballMoving;var bx,by,bz,move,d,lx,ly;var b;if(this.m_match.getBall().getCX()==0&&this.m_match.getBall().getCY()==0){return;}
for(i=(this.m_mzLive.m_interpolationRate<2)?2:1;i>0;--i){if(this.m_cameraMode!==CAMERA_FIXED){ballMoving=false;if(this.m_mzLive.isPlaying()){b=this.m_match.getBall();bx=PITCH_WORLD_SIZE.x-b.getCY();by=b.getCX();bz=b.getCZ();if(bx<CAMERA_PITCH_WINDOW.x){bx=CAMERA_PITCH_WINDOW.x;}else if(bx>PITCH_WORLD_SIZE.x-CAMERA_PITCH_WINDOW.x){bx=PITCH_WORLD_SIZE.x-CAMERA_PITCH_WINDOW.x;}
if(by<CAMERA_PITCH_WINDOW.y){by=CAMERA_PITCH_WINDOW.y;}else if(by>PITCH_WORLD_SIZE.y-CAMERA_PITCH_WINDOW.y){by=PITCH_WORLD_SIZE.y-CAMERA_PITCH_WINDOW.y;}
if(this.m_match.getBall().getCX()!=this.m_match.getBall().getPX()||this.m_match.getBall().getCY()!=this.m_match.getBall().getPY()||this.m_match.getBall().getCZ()!=this.m_match.getBall().getPZ()){ballMoving=true;}}
else{bx=PITCH_WORLD_SIZE.x/2;by=PITCH_WORLD_SIZE.y/2;bz=0;}
if(ballMoving){move=0;d=bx-this.m_camera.x;if(d>CAMERA_SCROLL_WINDOW.x){move=(d-CAMERA_SCROLL_WINDOW.x);}
else if(d<-CAMERA_SCROLL_WINDOW.x){move=(d+CAMERA_SCROLL_WINDOW.x);}
if(move>CAMERA_DYNAMIC_BALL_VELOCITY){move=CAMERA_DYNAMIC_BALL_VELOCITY;}
else if(move<-CAMERA_DYNAMIC_BALL_VELOCITY){move=-CAMERA_DYNAMIC_BALL_VELOCITY;}
this.m_camera.x+=move;move=0;d=by-this.m_camera.y;if(d>CAMERA_SCROLL_WINDOW.y){move=(d-CAMERA_SCROLL_WINDOW.y);}
else if(d<-CAMERA_SCROLL_WINDOW.y){move=(d+CAMERA_SCROLL_WINDOW.y);}
if(move>CAMERA_DYNAMIC_BALL_VELOCITY){move=CAMERA_DYNAMIC_BALL_VELOCITY;}
else if(move<-CAMERA_DYNAMIC_BALL_VELOCITY){move=-CAMERA_DYNAMIC_BALL_VELOCITY;}
this.m_camera.y+=move;}
else{d=bx-this.m_camera.x;if(d>CAMERA_DEAD_BALL_VELOCITY){this.m_camera.x+=CAMERA_DEAD_BALL_VELOCITY;}else if(d<-CAMERA_DEAD_BALL_VELOCITY){this.m_camera.x-=CAMERA_DEAD_BALL_VELOCITY;}
else{this.m_camera.x+=d;}
d=by-this.m_camera.y;if(d>CAMERA_DEAD_BALL_VELOCITY){this.m_camera.y+=CAMERA_DEAD_BALL_VELOCITY;}
else if(d<-CAMERA_DEAD_BALL_VELOCITY){this.m_camera.y-=CAMERA_DEAD_BALL_VELOCITY;}
else{this.m_camera.y+=d;}}
if(!this.m_zoomFixed){if(bz>CAMERA_HEIGHT_MAX){bz=CAMERA_HEIGHT_MAX;}
this.m_zoom=CAMERA_DEFAULT_ZOOM-bz/CAMERA_ZOOM_DIVISOR;}}
lx=this.WorldToLocalX(this.m_camera.x)*this.m_zoom;ly=this.WorldToLocalY(this.m_camera.y)*this.m_zoom;this.m_scrollX=-(lx-(this.m_screenDimension.width/2));this.m_scrollY=-(ly-(this.m_screenDimension.height/2));}},cameraFocus:function(){if(this.m_cameraMode!=CAMERA_FIXED){var actor=this.m_match.getBall();var x=PITCH_WORLD_SIZE.x-actor.getCY();var y=actor.getCX();if(x<CAMERA_PITCH_WINDOW.x){x=CAMERA_PITCH_WINDOW.x;}
else if(x>PITCH_WORLD_SIZE.x-CAMERA_PITCH_WINDOW.x){x=PITCH_WORLD_SIZE.x-CAMERA_PITCH_WINDOW.x;}
if(y<CAMERA_PITCH_WINDOW.y){y=CAMERA_PITCH_WINDOW.y;}
else if(y>PITCH_WORLD_SIZE.y-CAMERA_PITCH_WINDOW.y){y=PITCH_WORLD_SIZE.y-CAMERA_PITCH_WINDOW.y;}
this.m_camera.x=x;this.m_camera.y=y;}},nextCameraMode:function(){switch(++this.m_cameraMode){case CAMERA_AUTO:this.m_zoomFixed=false;this.cameraFocus();break;case CAMERA_ZOOMED:this.m_zoomFixed=true;this.m_zoom=CAMERA_ZOOM_CLOSE;this.cameraFocus();break;default:if(ig.game.gameType=='hockey'){this.m_camera.x=PITCH_WORLD_SIZE.x;this.m_camera.y=0;this.m_zoom=CAMERA_ZOOM_BIRDS_EYE;}
else{this.m_camera.x=PITCH_WORLD_SIZE.x/2;this.m_camera.y=PITCH_WORLD_SIZE.y/2;this.m_zoom=CAMERA_ZOOM_BIRDS_EYE;}
this.m_cameraMode=CAMERA_FIXED;break;}
this.updateCamera();},getCameraMode:function(){return this.m_cameraMode;},drawPitch:function(){var iRotation,i,renderItem;ig.system.context.save();ig.system.context.translate(-PITCH_LOCAL_OFFSET.x,-PITCH_LOCAL_OFFSET.y);for(iRotation=0;iRotation<this.stadiumRenderList.length;++iRotation){for(i=0;i<this.stadiumRenderList[iRotation].length;++i){renderItem=this.stadiumRenderList[iRotation][i];ig.system.context.drawImage(renderItem.tile.data,renderItem.x,renderItem.y);}
ig.system.context.transform(0,1,-1,0,0,0);}
ig.system.context.restore();},drawGoalposts:function(){if(ig.game.gameType=='soccer'){var g=ig.system.context;var goalpostsW=(this.m_goalposts.width*ArtworkScaling.GOALPOSTS_SCALE);var goalpostsH=(this.m_goalposts.height*ArtworkScaling.GOALPOSTS_SCALE);var y=((PITCH_LOCAL_SIZE.y)/2)-(goalpostsH/2);g.save();g.translate(PITCH_GOALPOST_OFFSET,y);g.transform(-1,0,0,1,0,0);g.scale(ArtworkScaling.GOALPOSTS_SCALE,ArtworkScaling.GOALPOSTS_SCALE);this.m_goalposts.draw(0,0);g.restore();g.save();g.translate(PITCH_LOCAL_SIZE.x-PITCH_GOALPOST_OFFSET,y);g.scale(ArtworkScaling.GOALPOSTS_SCALE,ArtworkScaling.GOALPOSTS_SCALE);this.m_goalposts.draw(0,0);g.restore();}},updateBall:function(){var b;b=this.m_match.getBall();b.update();var diffX=b.getCX()-b.getPX();var diffY=b.getCY()-b.getPY();var distsq=diffX*diffX+diffY*diffY;if(distsq>BALL_KICK_DIST&&this.m_oldBallDistSq<(BALL_KICK_DIST/2)){this.m_gameSound.SOUND_KICK.play();}
this.m_oldBallDistSq=distsq;},drawBall:function(){var g=ig.system.context;g.fillStyle='#60FF60';var b=this.m_match.getBall();var nFramesInBallAnim=this.m_ballAnim.sequence.length;this.m_ballAnim.gotoFrame((b.getFrame()>>2)&(nFramesInBallAnim-1));this.drawActor(b,this.m_ballAnim);},drawPuck:function(){var g=ig.system.context;g.fillStyle='#60FF60';var b=this.m_match.getBall();this.m_ballAnim.gotoFrame(0);this.drawActor(b,this.m_ballAnim,.75);},updateTeam:function(team){var animationRate=this.m_match.getAnimationRate();var numPlayers=team.getNumPlayers();var i,e;for(i=0;i<numPlayers;i++){var p=team.getPlayerByIndex(i);p.update(animationRate);e=p.getActiveEvent(this.m_match.getCurrentFrame(),this.m_match.getRewindState());if(e!=null){this.handleEvent(e);}}},drawTeams:function(){var g=ig.system.context;var idxTeam,i;var debugColours=['#FF8080','#8080FF'];for(idxTeam=0;idxTeam<2;++idxTeam){var ndir=((idxTeam*2)-1)*15;var npos=-16+ndir;var ncount=0;g.fillStyle=debugColours[idxTeam];g.strokeStyle=debugColours[idxTeam];var team=this.m_match.m_teams[idxTeam];var numPlayers=team.getNumPlayers();for(i=0;i<numPlayers;++i){var p=team.getPlayerByIndex(i);if(ig.game.gameType=='hockey'){if(!p.isOnPitch()){if(ncount++<8){ig.system.context.save();ig.system.context.scale(1,-1);ig.system.context.drawImage(this.m_hockeyPlayers[idxTeam].data,0,0,49,49,npos,-190,34,34);ig.system.context.restore();npos+=ndir;}}
else{this.drawHockeyPlayer(p,idxTeam);}}
else{if(p.isOnPitch()){var frame=p.getFrame();if(frame!=AnimCommands.FRAME_INVISIBLE){this.drawActor(p,p.getCurrentResource());}}}}}
if(this.m_mzLive.displayNumbers()){for(idxTeam=0;idxTeam<2;++idxTeam){team=this.m_match.m_teams[idxTeam];g.fillStyle=debugColours[idxTeam];g.strokeStyle=debugColours[idxTeam];numPlayers=team.getNumPlayers();for(i=0;i<numPlayers;++i){p=team.getPlayerByIndex(i);if(p.isOnPitch()){this.drawActor(p,null);}}}}},drawActor:function(actor,animResource,scale){if(ig.game.gameType=='hockey'){var x=actor.getCY();var y=-actor.getCX();}
else{var x=PITCH_WORLD_SIZE.x-actor.getCY();var y=actor.getCX();}
var xR=x;var yR=y;var z=actor.getCZ();if(x==0&&y==0){return;}
x=this.WorldToLocalX(x);y=this.WorldToLocalY(y);if(false){x*=this.m_zoom;y*=this.m_zoom;x+=this.m_scrollX;y+=this.m_scrollY;}
if(animResource){var extraScaling=1.0+z/BALL_ZOOM_DIVISOR;animResource.angle=actor.getCD()*Math.PI/128.0;if(ig.game.gameType=='hockey'){if(scale==undefined){scale=1.0;}
animResource.draw(x,y,extraScaling*scale);}
else{this.drawBlobShadow(x,y,z,animResource);animResource.draw(x,y,extraScaling);}
if(debugRenderCrosses){ig.system.context.beginPath();ig.system.context.moveTo(x-2,y-2)
ig.system.context.lineTo(x+2,y+2)
ig.system.context.moveTo(x-2,y+2)
ig.system.context.lineTo(x+2,y-2)
ig.system.context.stroke();}}
else{if(actor.getShirtNo){var xPos=x;var yPos=y;if(ig.game.view=="portrait"||ig.game.forcedView=="portrait"){var g=ig.system.context;g.save();g.translate(x,y);g.rotate(-Math.PI/2);xPos=0;yPos=0;}
if(ig.game.gameType=='hockey'){var textForNum=actor.getShirtNo();if(actor.getSide()=='home'){ig.game.hockeyHomeFont.draw(textForNum,xPos,yPos+ArtworkScaling.PLAYER_NUMBER_OFFSET_Y_HOCKEY,ig.Font.ALIGN.CENTER);}
else{ig.game.hockeyAwayFont.draw(textForNum,xPos,yPos+ArtworkScaling.PLAYER_NUMBER_OFFSET_Y_HOCKEY,ig.Font.ALIGN.CENTER);}}
else{var textForNum=actor.getShirtNo();if(actor.getSide()=='home'){ig.game.soccerHomeFont.draw(textForNum,xPos,yPos+ArtworkScaling.PLAYER_NUMBER_OFFSET_Y,ig.Font.ALIGN.CENTER);}
else{ig.game.soccerAwayFont.draw(textForNum,xPos,yPos+ArtworkScaling.PLAYER_NUMBER_OFFSET_Y,ig.Font.ALIGN.CENTER);}}
if(ig.game.view=="portrait"||ig.game.forcedView=="portrait"){g.restore();}}
else{ig.system.context.fillRect(x-1,y-1,3,3);}}},drawHockeyPlayer:function(actor,idxTeam){var x=actor.getCY();var y=-actor.getCX();var z=actor.getCZ();if(x==0&&y==0){return;}
x=this.WorldToLocalX(x);y=this.WorldToLocalY(y);if(actor.isDown){var rot=actor.getCD()*Math.PI/128.0;ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(x),ig.system.getDrawPos(y));ig.system.context.rotate(rot);ig.system.context.globalAlpha=0.3;this.drawBlobShadow(0,0,z,{m_scale:.6,angle:rot});ig.system.context.globalAlpha=1;var frOffset=9*49;ig.system.context.drawImage(this.m_hockeyPlayers[idxTeam].data,0,frOffset,49,49,-17,-17,34,34);ig.system.context.restore();return;}
var rot=actor.getCStickD()*Math.PI/128.0;ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(x),ig.system.getDrawPos(y));ig.system.context.rotate(rot);ig.system.context.drawImage(stadiumRawImages.stick.data,-17,-17,34,34);ig.system.context.restore();var rot=actor.getCD()*Math.PI/128.0;ig.system.context.save();ig.system.context.translate(ig.system.getDrawPos(x),ig.system.getDrawPos(y));ig.system.context.rotate(-8*Math.PI/128.0);ig.system.context.globalAlpha=0.15;this.drawBlobShadow(0,20,z,{m_scale:.8,angle:rot});ig.system.context.globalAlpha=0.3;this.drawBlobShadow(0,0,z,{m_scale:.8,angle:rot});ig.system.context.globalAlpha=1;ig.system.context.rotate(rot);var frOffset=actor.getFrame()*49;ig.system.context.drawImage(this.m_hockeyPlayers[idxTeam].data,0,frOffset,49,49,-17,-17,34,34);ig.system.context.restore();},drawBlobShadow:function(x,y,z,animResource){var scale=animResource.m_scale;var hotspotY=animResource.hotspotY||0;var g;g=ig.system.context;g.save();ig.system.context.translate(x+z*VECTOR_SHADOW.x,y+z*VECTOR_SHADOW.y);g.scale(scale,scale);g.drawImage(this.m_blobShadowImage.data,(-this.m_blobShadowImage.width/2)+hotspotY*Math.sin(animResource.angle),(-this.m_blobShadowImage.height*5/8)-hotspotY*Math.cos(animResource.angle));g.restore();},handleEvent:function(e){var team;if(e.getOwner()instanceof Player||e.getOwner()instanceof HockeyPlayer){var ignore=false;var duration=e.getDuration();var soundToPlay=false;switch(e.getEventType()){case EventType.EVENT_GOAL:case EventType.EVENT_OWN_GOAL:team=(e.getOwner().getSide()=='home')?this.m_match.getHomeTeam():this.m_match.getAwayTeam();if(e.getEventType()==EventType.EVENT_OWN_GOAL){team=(team.getSide()=="home")?this.m_match.getAwayTeam():this.m_match.getHomeTeam();}
if(!this.m_match.getRewindState()){team.addGoal();}
else{team.subtractGoal();}
soundToPlay=this.m_gameSound.SOUND_AUDIENCE_GOAL;duration=EVENT_NOTIFICATION_DURATION;break;case EventType.EVENT_YELLOW_CARD:case EventType.EVENT_SEC_YELLOW:case EventType.EVENT_RED_CARD:case EventType.EVENT_INJURY:soundToPlay=this.m_gameSound.SOUND_WHISTLE;duration=EVENT_NOTIFICATION_DURATION;break;case EventType.EVENT_PENULTY:soundToPlay=this.m_gameSound.SOUND_WHISTLE;break;default:ignore=true;}
if(soundToPlay&&!this.m_match.getRewindState()){soundToPlay.play();}
if(!ignore&&!this.m_match.getRewindState()){e.resetDurationAndTime(duration,this.m_mzLive.getGameTime());this.m_activeEvents.addSorted(e);}}
else if(e.getOwner()instanceof Referee){switch(e.getEventType()){case EventType.EVENT_WHISTLE:this.m_gameSound.SOUND_WHISTLE.play();break;case EventType.EVENT_PENALTY_DECISION:this.m_gameSound.SOUND_WHISTLE.play();break;}}},updateReferee:function(){var e=this.m_match.getReferee().getActiveEvent(this.m_match.getCurrentFrame(),this.m_match.getRewindState());if(e){this.handleEvent(e);}},updateEvents:function(){var gameTime,idx,e,livedFor;gameTime=this.m_mzLive.getGameTime();idx=0;while(idx<this.m_activeEvents.getLength()){e=this.m_activeEvents.at(idx);livedFor=gameTime-e.getTime();if(livedFor>e.getDuration()){this.m_activeEvents.remove(e);}
else{++idx;}}},getIntroTime:function(){return this.m_introTime;},getIntroState:function(){return this.m_introState;},initIntro:function(){this.m_introState=IntroState.SCROLL_ON;this.m_introBaseTime=this.m_mzLive.getGameTime();},updateIntro:function(){this.updateCamera();this.m_introTime=this.m_mzLive.getGameTime()-this.m_introBaseTime;switch(this.m_introState){case IntroState.SCROLL_ON:if(this.m_introTime>HudTiming.SQUAD_SCROLL_ON_TIME){this.m_introState=IntroState.PAUSE;this.m_introBaseTime=this.m_mzLive.getGameTime();}
break;case IntroState.PAUSE:if(this.m_introTime>HudTiming.SQUAD_SCROLL_PAUSE_TIME)
this.m_introState=IntroState.PLAYERS_MOVE;break;case IntroState.PLAYERS_MOVE:this.updateMatch();if(this.m_match.getCurrentFrame()>=this.m_match.getKOFrame()-1){this.m_introState=IntroState.SCROLL_OFF;this.m_introBaseTime=this.m_mzLive.getGameTime();}
break;case IntroState.SCROLL_OFF:if(this.m_introTime>HudTiming.SQUAD_SCROLL_OFF_TIME+HudTiming.SQUAD_SCROLL_OFF_PAUSE)
return true;break;}
if(!this.m_mzLive.skipPressed()){return false;}
else{return true;}},renderIntro:function(){this.renderFrame();this.m_hud.renderSquadList();if(this.m_mzLive.controlsTimerIntro){this.m_mzLive.controlsTimerIntro=false;this.m_mzLive.setControlsVisible=true;}},updateHalfTime:function(){this.updateMatch();if(this.m_match.getCurrentFrame()>=this.m_match.getKO2Frame()){return true;}
else if(this.m_match.getRewindState()&&this.m_match.getCurrentFrame()<this.m_match.getHTFrame()){return true;}
return false;},updateFullTime:function(){return false;}});});

// lib/plugins/touch-button.js
ig.baked=true;ig.module('plugins.touch-button').requires('impact.system','impact.input','impact.image').defines(function(){"use strict";ig.TouchButton=ig.Class.extend({action:'undefined',image:null,tile:0,highlightTile:0,pos:{x:0,y:0},size:{x:0,y:0},area:{x1:0,y1:0,x2:0,y2:0},initialTouch:{x:0,y:0},finalTouch:{x:0,y:0},type:'undefined',startTs:0,swiped:false,pressed:false,highlighted:false,touchId:0,anchor:null,enabled:true,timeout:false,init:function(action,anchor,width,height,image,tile,highlightTile,type){this.action=action;this.anchor=anchor;this.size={x:width,y:height};this.image=image||null;this.tile=tile||0;this.highlightTile=highlightTile;this.swiped=false;this.type=type;},align:function(w,h){if(this.action=="ToggleFullscreen"){this.pos.x=(ig.system.realWidth/2)-((this.size.x*.8)/2);this.pos.y=(ig.system.realHeight/2)-((this.size.y*.8)/2);}
else{if('left'in this.anchor){this.pos.x=this.anchor.left;}
else if('right'in this.anchor){this.pos.x=w-this.anchor.right-this.size.x;}
if('top'in this.anchor){this.pos.y=this.anchor.top;}
else if('bottom'in this.anchor){this.pos.y=h-this.anchor.bottom-this.size.y;}}
var internalWidth=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;var s=ig.system.scale*(internalWidth/ig.system.realWidth);this.area={x1:this.pos.x*s,y1:this.pos.y*s,x2:(this.pos.x+this.size.x)*s,y2:(this.pos.y+this.size.y)*s};},touchStart:function(ev){if(this.pressed){return;}
var action=this.action;var pos={left:0,top:0};if(ig.system.canvas.getBoundingClientRect){pos=ig.system.canvas.getBoundingClientRect();}
for(var i=0;i<ev.touches.length;i++){var touch=ev.touches[i];if(this.checkStart(touch.identifier,touch.clientX-pos.left,touch.clientY-pos.top,ev.timeStamp)){ig.game.mzlive.buttonPressed=true;ig.game.mzlive.setControlsVisible=true;if(action=="ToggleFullscreen"){if(window.fullScreenApi.isFullScreen()){window.fullScreenApi.cancelFullScreen();this.anchor={right:ig.system.realWidth/2-24,bottom:ig.system.realHeight/2-24};}
else{window.fullScreenApi.requestFullScreen(document.getElementById("canvas"));this.anchor={right:88,top:24};}}
return;}}},touchEnd:function(ev){if(!this.pressed){return;}
for(var i=0;i<ev.changedTouches.length;i++){var touch=ev.changedTouches[i];if(this.checkEnd(ev.changedTouches[i].identifier,touch.clientX,touch.clientY,ev.timetamp)){return;}}},touchStartMS:function(ev){if(this.pressed){return;}
var action=this.action;var pos={left:0,top:0};if(ig.system.canvas.getBoundingClientRect){pos=ig.system.canvas.getBoundingClientRect();}
if(this.checkStart(ev.pointerId,ev.clientX-pos.left,ev.clientY-pos.top,ev.timeStamp)){ig.game.mzlive.buttonPressed=true;ig.game.mzlive.setControlsVisible=true;if(action=="ToggleFullscreen"){if(window.fullScreenApi.isFullScreen()){window.fullScreenApi.cancelFullScreen();this.anchor={right:ig.system.realWidth/2-24,bottom:ig.system.realHeight/2-24};}
else{window.fullScreenApi.requestFullScreen(document.getElementById("canvas"));this.anchor={right:24,top:24};}}}},touchEndMS:function(ev){if(!this.pressed){return;}
var pos={left:0,top:0};if(ig.system.canvas.getBoundingClientRect){pos=ig.system.canvas.getBoundingClientRect();}
this.checkEnd(ev.pointerId,ev.clientX-pos.left,ev.clientY-pos.top,ev.timeStamp);},checkStart:function(id,x,y,ts){if(x>this.area.x1&&x<this.area.x2&&y>this.area.y1&&y<this.area.y2){this.pressed=true;this.swiped=false;if('highlight'===this.type){this.highlighted=true;}
this.touchId=id;this.startTs=new Date().getTime();var internalWidth=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;var scale=ig.system.scale*(internalWidth/ig.system.realWidth);this.initialTouch.x=x/scale;this.initialTouch.y=y/scale;ig.input.actions[this.action]=true;if(!ig.input.locks[this.action]){ig.input.presses[this.action]=true;ig.input.locks[this.action]=true;}
return true;}
return false;},checkEnd:function(id,x,y,ts){if(id===this.touchId){this.pressed=false;if('highlight'===this.type){this.highlighted=false;}
this.touchId=0;ig.input.delayedKeyup[this.action]=true;ts=new Date().getTime();var internalWidth=parseInt(ig.system.canvas.offsetWidth)||ig.system.realWidth;var scale=ig.system.scale*(internalWidth/ig.system.realWidth);this.finalTouch.x=x/scale;this.finalTouch.y=y/scale;if(ts-this.startTs<400){if(this.type=='swipeLR'){if(this.finalTouch.x-this.initialTouch.x>100){this.swiped=true;}}
if(this.type=='swipeRL'){if(this.initialTouch.x-this.finalTouch.x>100){this.swiped=true;}}}
return true;}
return false;},draw:function(){if(this.image){var g=ig.system.context;g.save();g.translate(this.pos.x,this.pos.y);g.scale(0.7,0.7);if(this.highlighted){this.image.drawTile(0,0,this.highlightTile,this.size.x,this.size.y);}
else{this.image.drawTile(0,0,this.tile,this.size.x,this.size.y);}
g.restore();}}});ig.TouchButtonCollection=ig.Class.extend({buttons:[],init:function(buttons){this.buttons=buttons;document.addEventListener('touchstart',this.touchStart.bind(this),false);document.addEventListener('touchend',this.touchEnd.bind(this),false);document.addEventListener('mousedown',this.touchStartMS.bind(this),false);document.addEventListener('mouseup',this.touchEndMS.bind(this),false);document.addEventListener('MSPointerDown',this.touchStartMS.bind(this),false);document.addEventListener('MSPointerUp',this.touchEndMS.bind(this),false);document.body.style.msTouchAction='none';},touchStart:function(ev){if($("#canvas").length==0){return;}
ev.preventDefault();for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].enabled){this.buttons[i].touchStart(ev);}}},touchEnd:function(ev){if($("#canvas").length==0){return;}
ev.preventDefault();for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].enabled){this.buttons[i].touchEnd(ev);}}},touchStartMS:function(ev){if($("#canvas").length==0){return;}
ev.preventDefault();for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].enabled){this.buttons[i].touchStartMS(ev);}}},touchEndMS:function(ev){if($("#canvas").length==0){return;}
ev.preventDefault();for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].enabled){this.buttons[i].touchEndMS(ev);}}},align:function(){var w=ig.system.width||window.innerWidth;var h=ig.system.height||window.innerHeight;for(var i=0;i<this.buttons.length;i++){this.buttons[i].align(w,h);}},draw:function(){for(var i=0;i<this.buttons.length;i++){if(this.buttons[i].enabled){this.buttons[i].draw();}}},show:function(){clearTimeout(this.timeout);ig.game.mzlive.controlsVisible=true;for(var i=0;i<this.buttons.length;i++){this.buttons[i].enabled=true;}
var _this=this;this.timeout=setTimeout(function(){_this.hide();},5000);},hide:function(){clearTimeout(this.timeout);ig.game.mzlive.controlsVisible=false;for(var i=0;i<this.buttons.length;i++){this.buttons[i].enabled=false;}}});});

// lib/game/main.js
ig.baked=true;ig.module('game.main').requires('impact.game','impact.font','game.mzlive','game.common.loader-queue','game.reality.reality-match-stream','game.reality.match-loader','game.render.main-scene','plugins.touch-button').defines(function(){MyGame=ig.Game.extend({soccerHomeFont:new ig.Font(mz.base_path+'media/arial_10_ffffff.font.png'),soccerAwayFont:new ig.Font(mz.base_path+'media/arial_10_33ee00.font.png'),hockeyAwayFont:new ig.Font(mz.base_path+'media/arial_12_c01701.font.png'),hockeyHomeFont:new ig.Font(mz.base_path+'media/arial_12_007eff.font.png'),fadeIn:1,gameState:'init',gameType:'null',nvprogress:0,loaderQueue:null,view:"landscape",gameLoaded:false,mzlive:new Mzlive(),init:function(){var _this=this;window.addEventListener("resize",function(){if(!ig.system||$("#canvas").length==0){return;}
_this.scaleCanvas();},false);$(window).on("orientationchange",function(){$(window).one("resize",function(){});});},scaleCanvas:function(){if(!this.gameLoaded){return;}
ig.game.view=mz.getOrientation();if(ig.game.view=="landscape"&&typeof(ig.game.forcedView)==="undefined"){ig.game.forcedView=null;}
var gameSize=mz.getGameSize(true);var c=document.getElementById("canvas");var w=gameSize.gameWidth;var h=gameSize.gameHeight;if(ig.game.view=="portrait"){c.width=h;c.height=w;ig.system.resize(h,w);}
else{c.width=w;c.height=h;ig.system.resize(w,h);}
if(window.myTouchButtons){window.myTouchButtons.align();}},update:function(){this.parent();switch(this.gameState){case'init':var dataURL=mz.base_path+"getMatchFiles.php?type=data&mid="+indexMatchId+"&sport="+indexSport;var statsURL=mz.base_path+"getMatchFiles.php?type=stats&mid="+indexMatchId+"&sport="+indexSport;this.LoadRealityMatchStream(dataURL,statsURL);break;case'runviewer':this.mzlive.update();break;}},draw:function(){if(this.gameState=='runviewer'){this.parent();var g=ig.system.context;g.fillStyle='#FF0000';this.mzlive.draw();if(window.myTouchButtons){window.myTouchButtons.draw();}
if(this.fadeIn>0){var w=ig.system.realWidth;var h=ig.system.realHeight;ig.system.context.fillStyle='rgba(0,0,0, '+this.fadeIn+')';ig.system.context.fillRect(0,0,w,h);this.fadeIn=this.fadeIn-.016;}
$("#game-overlay-close").hide();return;}
this.parent();if(window.myTouchButtons){window.myTouchButtons.draw();}
var x=ig.system.width/2,y=ig.system.height/2;switch(this.gameState){case'init':break;case'loadingFiles':if(this.loaderQueue){this.nvprogress++;}
else{this.font.draw('Loading : this.loaderQueue is null',x,y,ig.Font.ALIGN.CENTER);}
break;break;case'error':this.font.draw('Error! '+this.debugMessage,x,y,ig.Font.ALIGN.CENTER);break;default:this.font.draw('gameState='+this.gameState,x,y,ig.Font.ALIGN.CENTER);}
var progress=.5+(this.nvprogress/106);drawLoadingScreen(.5+(this.nvprogress/106));if(progress>.5){var alpha=(progress-.5)*2;var w=ig.system.realWidth;var h=ig.system.realHeight;ig.system.context.fillStyle='rgba(0,0,0, '+alpha+')';ig.system.context.fillRect(0,0,w,h);}},MatchLoadingCompleted:function(loaderQueue){if(loaderQueue.isInError){this.gameState='error';this.debugMessage=loaderQueue.errorMessage;}
else{this.gameState='runviewer';this.mzlive.finalInitAfterLoading();}},LoadRealityMatchStream:function(binDataUrl,statsXmlUrl){this.gameState='loadingFiles';var that=this;this.debugMessage='Loading';var matchLoader=new MatchLoader(binDataUrl,statsXmlUrl);this.loaderQueue=new LoaderQueue(this.MatchLoadingCompleted.bind(this));matchLoader.queueTasks(this.loaderQueue);this.loaderQueue.queueNonCallbackTask(this.Load010SetupMainSceneInstance.bind(this,matchLoader),'Initialize MainScene')
this.loaderQueue.runAllTasks();},Load010SetupMainSceneInstance:function(matchLoader,completedCallback,errorCallback){this.mzlive.m_match=matchLoader.match;var dimension={width:ig.system.context.canvas.width,height:ig.system.context.canvas.height};this.mzlive.m_ms=new MainScene(matchLoader.match,dimension,this.mzlive.m_gameSound,this.m_gameWorld,this.m_docBase,this.mzlive);this.mzlive.m_ms.queueLoadResourcesTasks(this.loaderQueue);completedCallback();},});var loaderImageData='data:image/png;base64,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';var loaderImage=new Image;loaderImage.src=loaderImageData;function drawLoadingScreen(progress){w=Math.min(ig.system.realWidth,mz.getMobileWidth(false));h=Math.min(ig.system.realHeight,mz.getMobileHeight(false));ig.system.context.fillStyle='#000000';ig.system.context.fillRect(0,0,w,h);ig.system.context.drawImage(loaderImage,(w/2)-125,(h/2)-80);var percentage=(progress*100).round()+'%';ig.system.context.fillStyle='#ffffff';ig.system.context.fillText(percentage,w/2,h/2);}
NVLoader=ig.Loader.extend({draw:function(){drawLoadingScreen(this.status*.5);if(this.status<.5){var alpha=1-(this.status*2)
var w=ig.system.realWidth;var h=ig.system.realHeight;ig.system.context.fillStyle='rgba(0,0,0, '+alpha+')';ig.system.context.fillRect(0,0,w,h);}}});});